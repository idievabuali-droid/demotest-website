(()=>{(()=>{let vt=!1;const Zt=()=>{const E=window.SUPABASE_PUBLIC_CONFIG||{},M=E.url||"",X=E.anonKey||"";if(!M||!X||!window.supabase)return null;try{return window.supabase.createClient(M,X)}catch(J){return console.error("Failed to init Supabase client for auth",J),null}},wt=async E=>{try{const{data:M,error:X}=await E.rpc("is_owner");if(X)throw X;return!!M}catch(M){return console.error("Owner check failed",M),null}},Et=()=>{if(vt)return;vt=!0;const{useState:E,useEffect:M,useRef:X,useMemo:J,useLayoutEffect:Ue}=React,at="Odil Accessories",$e="Simple wholesale catalogue with WhatsApp ordering.",be="GBP",rt="\xA3",pe="992935563306",we="nova_wholesale_cart_v1",Ne="nova_owner_products_v1",Ce=document.body.dataset.layout==="owner",Be=Ce||document.body.dataset.ownerMode!=="disabled",ke=Be&&!Ce,st=Ce||document.body.dataset.defaultOwner==="true",Ge="/.netlify/functions/catalogue",Qe=be,ee="__base__",nt=(a,r)=>{const t=(a||r||"").trim();if(!t)return r||"";const o=t.toLowerCase();return o.includes("color")||o.includes("colour")?"Color":r==="models"||o.includes("model")?"Model":t.replace(/\s+/g," ").trim()},xe=(a={})=>{const r=Object.entries(a||{}).filter(([t,o])=>o!=null&&String(o).trim()!=="");return r.length?r.sort(([t],[o])=>t.localeCompare(o)).map(([t,o])=>`${t}:${o}`).join("|"):ee},He=a=>{if(!a||typeof a!="object")return{};const r={};return Object.entries(a).forEach(([t,o])=>{const s=Number(o);Number.isFinite(s)&&s>=0&&(r[t&&t.trim()||ee]=s)}),r},yr=a=>{const r=Object.entries(a||{}).filter(([s,d])=>Array.isArray(d)&&d.length);if(!r.length)return[{key:ee,selection:{}}];const t=[],o=(s,d)=>{if(s>=r.length){const b=xe(d);t.push({key:b,selection:{...d}});return}const[l,x]=r[s];x.forEach(b=>o(s+1,{...d,[l]:b}))};return o(0,{}),t},gr=(a,r)=>{const t=[...r.must||[],...r.also||[],...r.optional||[]],o={};return t.forEach(s=>{const d=a[s.key],l=nt(s.label,s.key);if(s.type==="checkbox"){d&&(o[l]=["Yes"]);return}if(d==null)return;if(Array.isArray(d)){const b=d.map(f=>String(f).trim()).filter(Boolean);b.length&&(o[l]=Array.from(new Set(b)));return}const x=String(d).trim();x&&(o[l]=[x])}),o},Rt=window.SUPABASE_PUBLIC_CONFIG||{},ot=Rt.url||"",Nt=Rt.anonKey||"",ea=!!(ot&&Nt);let fe=null;try{window.supabase&&ea?(fe=window.supabase.createClient(ot,Nt),console.log("\u2705 Supabase client initialized successfully"),console.log("\u{1F4CD} Supabase URL:",ot),setTimeout(async()=>{try{console.log("\u{1F504} Testing database connection...");const{data:r,error:t}=await fe.from("products").select("count").limit(1);t?(console.error("\u274C Database test failed:",t),t.message.includes("permission denied")&&console.error("\u{1F6AB} RLS Policy Issue: Run the SQL script to fix permissions"),t.message.includes('relation "products" does not exist')&&console.error("\u{1F3D7}\uFE0F Table Missing: Run the SQL script to create the products table")):console.log("\u2705 Database connection successful"),console.log("\u{1F504} Testing realtime connection...");const o=fe.channel("test-channel");o.subscribe(s=>{s==="SUBSCRIBED"?(console.log("\u2705 Realtime connection successful"),o.unsubscribe()):s==="CHANNEL_ERROR"&&console.error("\u274C Realtime connection failed")})}catch(r){console.error("\u274C Connection test failed:",r)}},1e3)):console.warn("\u26A0\uFE0F Supabase not initialized - supply SUPABASE_PUBLIC_CONFIG in supabase-config.js")}catch(a){console.error("\u274C Supabase initialization failed:",a)}const lt=async(a,r=3,t=1e3)=>{for(let o=1;o<=r;o++)try{return await a()}catch(s){if(console.warn(`\u26A0\uFE0F Attempt ${o}/${r} failed:`,s.message),o===r)throw s;await new Promise(d=>setTimeout(d,t*o))}},ta=async()=>{var a;try{if(!fe)return null;const{data:r}=await fe.auth.getSession(),t=(a=r==null?void 0:r.session)==null?void 0:a.access_token;return t?`Bearer ${t}`:null}catch(r){return null}},_e=async(a,r)=>{try{const t=await ta(),o=await fetch(Ge,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:t}:{}},body:JSON.stringify({action:a,data:r})});if(!o.ok){const d=await o.text().catch(()=>"");throw new Error(`Owner API ${a} failed: ${o.status} ${d}`)}const s=await o.json().catch(()=>({}));if(s!=null&&s.error){const d=new Error(s.error.message||s.error);throw d.details=s.error.details,d.hint=s.error.hint,d.code=s.error.code,d}return s}catch(t){throw console.error(`Owner API ${a} error`,t),t}},ie=a=>{var W;if(!a)return null;const{sourceid:r,sourceId:t,images:o,image:s,specs:d,variants:l,inventory:x,price:b,hidden:f,...i}=a,m=(W=t!=null?t:r)!=null?W:null,c=T=>Array.isArray(T)?T:T==null?[]:typeof T=="string"&&T.trim().length?[T]:[],u=c(o),_=c(d),P=typeof l=="object"&&l!==null&&!Array.isArray(l)?l:{},S=He(x),N=s||u[0]||void 0,U=u.length?u:N?[N]:[];return{...i,sourceId:m,images:U,specs:_,variants:P,inventory:S,price:typeof b=="number"?b:Number(b)||0,hidden:!!f,image:N}},kt=a=>{var s;const r={id:a.id,name:a.name,sku:a.sku,category:a.category,price:Number(a.price)||0,description:(s=a.description)!=null?s:""},t=Array.isArray(a.images)?a.images:a.image?[a.image]:[];t.length&&(r.images=t),Array.isArray(a.specs)&&a.specs.length&&(r.specs=a.specs),a.variants&&Object.keys(a.variants).length&&(r.variants=a.variants),a.sourceId&&(r.sourceid=a.sourceId),a.hidden&&(r.hidden=!0);const o=He(a.inventory);return Object.keys(o).length&&(r.inventory=o),r},Ct=async()=>{if(!fe)return console.warn("\u26A0\uFE0F Cannot load products: Supabase not initialized"),[];try{console.log("\u{1F504} Loading products from database...");const{data:a,error:r}=await fe.from("products").select("*").order("created_at",{ascending:!1});if(r)throw console.error("\u274C Database error:",r),r;return console.log(`\u2705 Loaded ${(a==null?void 0:a.length)||0} products from database`),(a||[]).map(ie).filter(Boolean)}catch(a){return console.error("Failed to load products:",a),[]}},aa=async a=>{try{const r=kt(a),{data:t}=await lt(()=>_e("insert",r)),o=ie(t);return console.log("\u2705 Product saved successfully:",o),o}catch(r){return console.error("\u274C Failed to save product after retries:",r),null}},it=async a=>{try{const r=kt(a),{data:t}=await lt(()=>_e("upsert",r));return ie(t)}catch(r){return console.error("Failed to upsert product:",r),null}},ra=async a=>{try{return await lt(()=>_e("delete",{id:a})),!0}catch(r){return console.error("Failed to delete product:",r),!1}},xr=a=>{if(!fe)return null;try{return fe.channel("products").on("postgres_changes",{event:"*",schema:"public",table:"products"},a).subscribe()}catch(r){return console.error("Failed to subscribe to product changes:",r),null}},ct=["All","Phone Screens","Back Glass","Power Banks","Screen Protectors","Batteries","Mobile Phones","Tablets","Phone Cases","Cables","Chargers","Earphones","Charging Ports","Face ID"],Me=["iPhone 11","iPhone 12","iPhone 12 Pro","iPhone 13","iPhone 13 Pro","iPhone 14","iPhone 14 Pro","iPhone 15","iPhone 15 Plus","iPhone 15 Pro","iPhone 15 Pro Max","iPhone 16","iPhone 16 Pro","iPhone 16 Pro Max"],St=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],hr=[...Me,...St],dt=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],mt=["Galaxy A14","Galaxy A24","Galaxy A34","Galaxy A54","Galaxy A55","Galaxy A15"],vr=["iPhone","Samsung S","Samsung A"],wr={iPhone:Me,"Samsung S":dt,"Samsung A":mt},Ve="__catalog_config__",sa="__",ut="__family:",Er=a=>(Array.isArray(a)?a:[]).filter(r=>{const t=String(r||"");return t&&!t.startsWith(sa)}),Rr=a=>{const t=(Array.isArray(a==null?void 0:a.specs)?a.specs:[]).find(o=>typeof o=="string"&&o.startsWith(ut));return t?String(t).slice(ut.length).trim():""},pt=(a,r)=>{var o,s;if(r==="models")return"Model";const t=String((o=a!=null?a:r)!=null?o:"").toLowerCase().trim();return t==="color"||t==="colors"||t==="colour"?"Color":t==="model"||t==="models"?"Model":String((s=a!=null?a:r)!=null?s:"").trim()},bt=()=>({version:1,categories:ct.filter(a=>a!=="All"),families:[{id:"iphone",name:"iPhone",models:[...Me]},{id:"samsung_s",name:"Samsung S",models:[...dt]},{id:"samsung_a",name:"Samsung A",models:[...mt]},{id:"accessories",name:"Accessories",models:[]}],groupsByCategory:{},groupOverridesByCategoryFamily:{},groupHiddenByCategoryFamily:{}}),Je=a=>{const r=bt();if(!a||typeof a!="object")return r;const t={...r,...a};return t.categories=Array.isArray(t.categories)?t.categories.filter(Boolean):r.categories,t.families=Array.isArray(t.families)?t.families.filter(Boolean):r.families,t.groupsByCategory=t.groupsByCategory&&typeof t.groupsByCategory=="object"?t.groupsByCategory:{},t.groupOverridesByCategoryFamily=t.groupOverridesByCategoryFamily&&typeof t.groupOverridesByCategoryFamily=="object"?t.groupOverridesByCategoryFamily:{},t.groupHiddenByCategoryFamily=t.groupHiddenByCategoryFamily&&typeof t.groupHiddenByCategoryFamily=="object"?t.groupHiddenByCategoryFamily:{},t},At=["Original","OEM","AAA","Aftermarket","Refurb"],na=["TPU","Silicone","PC","Leather"],Ke=["Black","White","Navy","Clear","Red","Lavender","Stone","Midnight","Starlight","Blue","Green","Gold"],Ze={Black:"#111827",White:"#ffffff",Navy:"#1e3a8a",Clear:"#ffffff",Red:"#ef4444",Lavender:"#b57edc",Stone:"#a8a29e",Midnight:"#0f172a",Starlight:"#f8fafc",Blue:"#3b82f6",Green:"#10b981",Gold:"#f59e0b"};function Se({name:a}){const r=Ze[a],t=r?{backgroundColor:r,border:"1px solid rgba(0,0,0,.15)"}:{backgroundImage:"linear-gradient(45deg,#e5e7eb 25%,transparent 25%),linear-gradient(-45deg,#e5e7eb 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#e5e7eb 75%),linear-gradient(-45deg,transparent 75%,#e5e7eb 75%)",backgroundSize:"8px 8px",border:"1px solid rgba(0,0,0,.15)"};return React.createElement("span",{"aria-hidden":"true",className:"inline-block h-3 w-3 rounded-full align-[-2px]",style:t})}const oa=["Tempered","Hydrogel"],la=["Clear","Matte","Privacy"],ia=["1-Pack","2-Pack"],ca=["Edge-to-edge","Full glue"],ft=["USB-C \u2194 USB-C","USB-C \u2194 Lightning","USB-A \u2194 Micro-USB"],Pt=["0.5m","1m","2m"],Ot=["27W","60W","100W"],da=["MFi","USB-IF"],ma=["Standard","Braided",">10k bends"],ua=["20W","30W","45W","65W"],Bt=["1\xD7USB-C","1\xD7USB-A","1\xD7USB-C + 1\xD7USB-A","2\xD7USB-C"],Ie=["PD 3.0","PPS","QC 3.0","QC 4+"],Nr=["CE","UKCA"],pa=["UK 3-pin","EU","US"],_t=["New","Refurb","Used A","Used B"],ba=["Unlocked","Locked","Dual-SIM Yes","Dual-SIM No"],fa=["5G","4G"],ya=["Wi-Fi","Wi-Fi + Cellular"],Mt=["32GB","64GB","128GB","256GB","512GB","1TB"],It=["3GB","4GB","6GB","8GB","12GB","16GB"],kr=ft,ga=Pt,Cr=Ot,xa=["10,000 mAh","20,000 mAh"],Tt=["open","confirmed","shipped"],ha=["open","confirmed","shipped","cancelled"],Xe={open:"Open",confirmed:"Confirmed",shipped:"Shipped",cancelled:"Cancelled"},va=[{id:"sp-iph-13-tmp-2pk",name:"Tempered Glass \u2013 iPhone 13 (2\u2011Pack)",sku:"SP-IP13-TG2",category:"Screen Protectors",price:3.2,specs:["2\u2011Pack","Tempered","9H","Oleophobic"],description:"Clear tempered glass for iPhone 13.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.07_b6d5696d.jpg",variants:{Model:["iPhone 13"],Material:["Tempered"],Pack:["2\u2011Pack"]}},{id:"sp-iph-14-hg-1pk",name:"Hydrogel Protector \u2013 iPhone 14",sku:"SP-IP14-HG1",category:"Screen Protectors",price:2.6,specs:["Hydrogel","Self\u2011healing","Case\u2011friendly"],description:"Flexible hydrogel film.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.08_46a12f36.jpg",variants:{Model:["iPhone 14"],Material:["Hydrogel"],Pack:["1\u2011Pack","2\u2011Pack"]}},{id:"case-slim-tpu-iph-11-16",name:"Slim TPU Case \u2013 iPhone Series",sku:"CA-IP-TPU",category:"Phone Cases",price:3.9,specs:["TPU","Slim","Matte"],description:"Slim matte TPU case.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.09_811264ed.jpg",variants:{Color:["Black","Navy","Clear","Red"],Material:["TPU"],Model:Me}},{id:"case-silicone-sg-s20-s25",name:"Soft Silicone Case \u2013 Galaxy Series",sku:"CA-SG-SIL",category:"Phone Cases",price:4.1,specs:["Silicone","Microfiber"],description:"Soft\u2011touch silicone for Galaxy.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.10_3d78676b.jpg",variants:{Color:["Midnight","Stone","Lavender"],Material:["Silicone"],Model:St}},{id:"chg-65w-gan-dual",name:"65W GaN Charger \u2013 Dual Port",sku:"CH-65W-GAN",category:"Chargers",price:12.5,specs:["65W","USB\u2011C + USB\u2011A","PD/QC"],description:"Compact GaN charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_89070b32.jpg",variants:{Wattage:["65W"],Ports:["USB\u2011C + USB\u2011A"],Standard:Ie}},{id:"chg-20w-usbc",name:"20W USB\u2011C Wall Charger",sku:"CH-20W-USBC",category:"Chargers",price:6,specs:["20W","USB\u2011C","PD"],description:"USB\u2011C PD charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_9ebc1ea2.jpg",variants:{Wattage:["20W"],Ports:["USB\u2011C"],Standard:["PD 3.0"]}},{id:"cbl-usbc-60w-1m-2m",name:"USB\u2011C Cable 60W",sku:"CB-UC-60",category:"Cables",price:2.2,specs:["USB\u2011C","60W","Nylon"],description:"Braided 60W cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.12_628fcab2.jpg",variants:{Connector:["USB\u2011C \u2194 USB\u2011C"],Length:ga,Rating:["60W"]}},{id:"cbl-lightning-mfi",name:"Lightning Cable (MFi)",sku:"CB-LT-MFI",category:"Cables",price:3.5,specs:["Lightning","MFi","1m"],description:"MFi Lightning cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.13_22d8e7c9.jpg",variants:{Connector:["USB\u2011C \u2194 Lightning"],Length:["1m"],Rating:["27W"]}},{id:"ear-wired-classic",name:"Wired Earphones \u2013 Classic",sku:"EA-WI-CLS",category:"Earphones",price:4.2,specs:["3.5mm","In\u2011line mic"],description:"Wired earphones.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.14_4f407f9a.jpg",variants:{Connector:["3.5mm"],Color:["Black","White"]}},{id:"ear-tws-basic",name:"TWS Earbuds \u2013 Basic",sku:"EA-TWS-BSC",category:"Earphones",price:12.9,specs:["BT 5.3","20h"],description:"TWS earbuds.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.15_e7b8adc0.jpg",variants:{Color:["White","Black"],Standard:["BT 5.3"]}},{id:"pb-10000-compact",name:"Power Bank 10,000 mAh",sku:"PB-10K-CMP",category:"Power Banks",price:11,specs:["10,000 mAh","USB\u2011C","PD"],description:"Slim 10k power bank.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.17_01d0dcae.jpg",variants:{Capacity:["10,000 mAh"],Ports:["USB\u2011C","USB\u2011A"],Standard:Ie}},{id:"pb-20000-dual",name:"Power Bank 20,000 mAh \u2013 Dual",sku:"PB-20K-DUAL",category:"Power Banks",price:16.5,specs:["20,000 mAh","Dual","PD/QC"],description:"20k dual output.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.19_3b58c17b.jpg",variants:{Capacity:["20,000 mAh"],Ports:["USB\u2011C + USB\u2011A"],Standard:Ie}},{id:"img-001",name:"Accessory Photo A",sku:"IM-001",category:"Phone Cases",price:2.5,specs:["Assorted"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.33_5dd08e33.jpg"},{id:"img-002",name:"Accessory Photo B",sku:"IM-002",category:"Chargers",price:7.2,specs:["Fast"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_09a1e9d9.jpg"},{id:"img-003",name:"Accessory Photo C",sku:"IM-003",category:"Cables",price:1.8,specs:["1m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_f1935767.jpg"},{id:"img-004",name:"Accessory Photo D",sku:"IM-004",category:"Screen Protectors",price:2.9,specs:["Tempered"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.35_92866963.jpg"},{id:"img-005",name:"Accessory Photo E",sku:"IM-005",category:"Phone Cases",price:3.6,specs:["TPU"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.36_d9ee268e.jpg"},{id:"img-006",name:"Accessory Photo F",sku:"IM-006",category:"Back Glass",price:5.5,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.37_ef5ed98e.jpg"},{id:"img-007",name:"Accessory Photo G",sku:"IM-007",category:"Earphones",price:6,specs:["Wireless"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_b444897c.jpg"},{id:"img-008",name:"Accessory Photo H",sku:"IM-008",category:"Power Banks",price:9.9,specs:["10k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_f170faf6.jpg"},{id:"img-009",name:"Accessory Photo I",sku:"IM-009",category:"Cables",price:2,specs:["2m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.39_c37cddc9.jpg"},{id:"img-010",name:"Accessory Photo J",sku:"IM-010",category:"Chargers",price:11.5,specs:["65W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.40_7a858ba3.jpg"},{id:"img-011",name:"Accessory Photo K",sku:"IM-011",category:"Phone Cases",price:4.4,specs:["Silicone"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_80d08b54.jpg"},{id:"img-012",name:"Accessory Photo L",sku:"IM-012",category:"Screen Protectors",price:1.9,specs:["Hydrogel"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_a2efd2e1.jpg"},{id:"img-013",name:"Accessory Photo M",sku:"IM-013",category:"Back Glass",price:6.5,specs:["Back glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.42_63c16e8a.jpg"},{id:"img-014",name:"Accessory Photo N",sku:"IM-014",category:"Batteries",price:8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.43_06e00e31.jpg"},{id:"img-015",name:"Accessory Photo O",sku:"IM-015",category:"Phone Cases",price:3.2,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_de3a612b.jpg"},{id:"img-016",name:"Accessory Photo P",sku:"IM-016",category:"Cables",price:2.4,specs:["Nylon"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_fddf905d.jpg"},{id:"img-017",name:"Accessory Photo Q",sku:"IM-017",category:"Earphones",price:5,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.45_b1dd7f8a.jpg"},{id:"img-018",name:"Accessory Photo R",sku:"IM-018",category:"Chargers",price:9.5,specs:["30W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_30024620.jpg"},{id:"img-019",name:"Accessory Photo S",sku:"IM-019",category:"Power Banks",price:14,specs:["20k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_cb602f30.jpg"},{id:"img-020",name:"Accessory Photo T",sku:"IM-020",category:"Phone Cases",price:3.8,specs:["Leather"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_d9e5908c.jpg"},{id:"img-021",name:"Accessory Photo U",sku:"IM-021",category:"Screen Protectors",price:2.7,specs:["Matte"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.47_ac758901.jpg"},{id:"img-022",name:"Accessory Photo V",sku:"IM-022",category:"Cables",price:1.6,specs:["0.5m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_bc4af4ef.jpg"},{id:"img-023",name:"Accessory Photo W",sku:"IM-023",category:"Chargers",price:4.9,specs:["USB\u2011A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_f4496fba.jpg"},{id:"img-024",name:"Accessory Photo X",sku:"IM-024",category:"Earphones",price:13.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.49_ad6d3003.jpg"},{id:"img-025",name:"Accessory Photo Y",sku:"IM-025",category:"Phone Cases",price:2.9,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.50_b3694795.jpg"},{id:"img-026",name:"Accessory Photo Z",sku:"IM-026",category:"Back Glass",price:7,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.51_5e67178c.jpg"},{id:"img-027",name:"Accessory Photo AA",sku:"IM-027",category:"Batteries",price:6.9,specs:["Refurb"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.52_df23fdba.jpg"},{id:"img-028",name:"Accessory Photo AB",sku:"IM-028",category:"Chargers",price:8.5,specs:["PD"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.53_13d347f3.jpg"},{id:"img-029",name:"Accessory Photo AC",sku:"IM-029",category:"Cables",price:2.1,specs:["Braided"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_5c3d1851.jpg"},{id:"img-030",name:"Accessory Photo AD",sku:"IM-030",category:"Power Banks",price:12.2,specs:["Dual output"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_8f092381.jpg"},{id:"img-031",name:"Accessory Photo AE",sku:"IM-031",category:"Earphones",price:3.9,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.56_cbdfea17.jpg"},{id:"img-032",name:"Accessory Photo AF",sku:"IM-032",category:"Phone Cases",price:4.5,specs:["Patterned"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_61b6ae02.jpg"},{id:"img-033",name:"Accessory Photo AG",sku:"IM-033",category:"Screen Protectors",price:2.3,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_efd60a9b.jpg"},{id:"img-034",name:"Accessory Photo AH",sku:"IM-034",category:"Chargers",price:10,specs:["GaN"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.58_082b158d.jpg"},{id:"img-035",name:"Accessory Photo AI",sku:"IM-035",category:"Power Banks",price:15,specs:["High capacity"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.00_7e6451d4.jpg"},{id:"img-036",name:"Accessory Photo AJ",sku:"IM-036",category:"Cables",price:1.5,specs:["USB-C"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.01_bf466384.jpg"},{id:"img-037",name:"Accessory Photo AK",sku:"IM-037",category:"Earphones",price:7.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2920cb02.jpg"},{id:"img-038",name:"Accessory Photo AL",sku:"IM-038",category:"Phone Cases",price:3.1,specs:["Transparent"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2ae9f56f.jpg"},{id:"img-039",name:"Accessory Photo AM",sku:"IM-039",category:"Back Glass",price:6.8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_725a57bf.jpg"},{id:"img-040",name:"Accessory Photo AN",sku:"IM-040",category:"Chargers",price:5.5,specs:["USB-A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.04_faa6a5d9.jpg"}],he=a=>new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format(a),z=(...a)=>a.filter(Boolean).join(" ");function wa(){const[a,r]=E(!1);return M(()=>{var s;const t=window.matchMedia("(prefers-reduced-motion: reduce)");r(t.matches);const o=()=>r(t.matches);return(s=t.addEventListener)==null||s.call(t,"change",o),()=>{var d;return(d=t.removeEventListener)==null?void 0:d.call(t,"change",o)}},[]),a}function Ae(a){const r=encodeURIComponent("#f3f4f6"),t=encodeURIComponent("#6b7280"),o=encodeURIComponent(a),s=`<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' width='800' height='600' role='img' aria-label='${o}'><rect width='100%' height='100%' fill='${r}'/><g fill='${t}' font-family='system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif'><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='24'>${o}</text></g></svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(s)}`}function ze(a,r){return a?a.startsWith("data:")||a.startsWith("http")?a:`/img/${a}`:Ae(r)}function Ea(a){const r=Array.isArray(a.images)&&a.images.length?a.images:a.image?[a.image]:[];return r.length?r:[Ae(a.name)]}function Lt(a){const r=Ea(a);return ze(r[0],a.name)}function et(a,r,t){const o=X(t);M(()=>{o.current=t},[t]),M(()=>{if(!a||!r.current)return;const s=r.current,d=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),l=document.activeElement;(()=>{const f=Array.from(s.querySelectorAll(d));if(!f.length){s.hasAttribute("tabindex")||s.setAttribute("tabindex","-1"),typeof s.focus=="function"&&s.focus({preventScroll:!0});return}const i=f[0];i&&typeof i.focus=="function"&&i.focus({preventScroll:!0})})();const b=f=>{var i;if(f.key==="Escape"){f.stopPropagation(),(i=o.current)==null||i.call(o);return}if(f.key==="Tab"){const m=Array.from(s.querySelectorAll(d));if(!m.length)return;const c=m[0],u=m[m.length-1];f.shiftKey&&document.activeElement===c?(f.preventDefault(),u.focus()):!f.shiftKey&&document.activeElement===u&&(f.preventDefault(),c.focus())}};return s.addEventListener("keydown",b),()=>{if(s.removeEventListener("keydown",b),l&&typeof l.focus=="function"&&document.contains(l))try{l.focus({preventScroll:!0})}catch(f){l.focus()}}},[a])}function Ra(a,r){const t=X(0),o=X(null);Ue(()=>{if(typeof window=="undefined"||!a)return;const s=document.body,d=document.documentElement;if(!s||!d)return;const l=window.scrollY||window.pageYOffset||0,x=r&&Number.isFinite(r.current)?r.current:l;return t.current=x,o.current={position:s.style.position,top:s.style.top,width:s.style.width,overflow:s.style.overflow,htmlOverflow:d.style.overflow,overscroll:d.style.overscrollBehavior},s.style.position="fixed",s.style.top=`-${x}px`,s.style.width="100%",s.style.overflow="hidden",d.style.overflow="hidden",d.style.overscrollBehavior="none",()=>{const b=o.current||{};s.style.position=b.position||"",s.style.top=b.top||"",s.style.width=b.width||"",s.style.overflow=b.overflow||"",d.style.overflow=b.htmlOverflow||"",d.style.overscrollBehavior=b.overscroll||"",window.scrollTo(0,t.current||0),o.current=null}},[a,r])}function yt({open:a,title:r,onClose:t,children:o,actions:s}){const d=X(null);return et(!!a,d,t),a?React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},React.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:t,"aria-hidden":"true"}),React.createElement("div",{ref:d,role:"dialog","aria-modal":"true",className:"relative w-full max-w-lg rounded-3xl border border-[var(--surface-border)] bg-white p-5 shadow-soft-xl"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},r),React.createElement("button",{type:"button",onClick:t,className:"rounded-full p-2 text-slate-500 hover:bg-slate-100","aria-label":"Close"},"\xD7")),React.createElement("div",{className:"mt-4 space-y-4"},o),s&&React.createElement("div",{className:"mt-5 flex justify-end gap-2"},s))):null}function Na({label:a,mode:r,fieldType:t,options:o,value:s,onChange:d,onEdit:l,onRemove:x}){const b=t==="checkbox",i=String(b?"single":r||"single").toLowerCase().trim().includes("multi")?"multi":"single",m=b?["Yes","No"]:Array.isArray(o)?o:[],[c,u]=E(!1),_=X(null);M(()=>{if(!c)return;const h=L=>{_.current&&!_.current.contains(L.target)&&u(!1)};return document.addEventListener("mousedown",h),document.addEventListener("touchstart",h),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("touchstart",h)}},[c]);const P=!!s,S=Array.isArray(s)?s:[],N=typeof s=="string"?s:s==null?"":String(s),U=b?P?"Yes":"No":i==="multi"?S.length?`${S.length} selected`:"Select...":N||"Select...",W=()=>{d(b?!1:i==="multi"?[]:"")},T=h=>{if(b){d(h==="Yes"),u(!1);return}if(i==="multi"){const L=S.includes(h)?S.filter(y=>y!==h):[...S,h];d(L);return}d(h),u(!1)};return React.createElement("div",{ref:_,className:z("relative rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur",c&&"z-30")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",{className:"flex-1"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},a),React.createElement("button",{type:"button",onClick:()=>u(h=>!h),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-left text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-expanded":c?"true":"false"},U)),React.createElement("div",{className:"mt-6 flex items-center gap-1"},React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:W,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white",title:"Clear"},"Clear"),React.createElement("button",{type:"button",onClick:x,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove ${a}`},"\xD7"))),c&&React.createElement("div",{className:"absolute left-4 right-4 top-[78px] z-40 overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-white shadow-soft-xl"},React.createElement("div",{className:"max-h-64 overflow-y-auto p-2"},m.map(h=>{const L=b?h==="Yes"?P:!P:i==="multi"?S.includes(h):N===h;return React.createElement("button",{key:h,type:"button",onClick:()=>T(h),className:z("flex w-full items-center gap-3 rounded-xl px-3 py-2 text-left text-sm transition",L?"bg-brand-soft text-slate-900":"hover:bg-slate-50")},React.createElement("span",{className:z("inline-flex h-4 w-4 items-center justify-center rounded border",L?"border-brand bg-brand text-white":"border-[var(--surface-border)] bg-white")},L?"\u2713":""),React.createElement("span",{className:"flex-1"},h))})),React.createElement("div",{className:"flex items-center justify-end border-t border-[var(--surface-border)] bg-white/80 px-3 py-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>u(!1),className:"rounded-full bg-brand px-3 py-1 font-semibold text-white hover:bg-brand-muted"},"Done"))))}function ka({label:a,mode:r,options:t,value:o,onChange:s,onEdit:d,onRemove:l}){const x=Array.isArray(t)?t:[],f=String(r||"multi").toLowerCase().trim().includes("multi")?"multi":"single",i=Array.isArray(o)?o:[],m=typeof o=="string"?o:o==null?"":String(o),c=u=>{if(f==="multi"){const _=i.includes(u)?i.filter(P=>P!==u):[...i,u];s(_);return}s(m===u?"":u)};return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-1 text-xs"},f==="multi"&&x.length>0&&React.createElement("button",{type:"button",onClick:()=>{s(x)},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),f==="multi"&&React.createElement("button",{type:"button",onClick:()=>{s([])},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Edit"),React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60","aria-label":`Remove ${a}`},"\xD7"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},x.map(u=>{const _=f==="multi"?i.includes(u):m===u,P=Ze[u]!==void 0||/color/i.test(a);return React.createElement("button",{type:"button",key:u,onClick:()=>c(u),className:z("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",_?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},P?React.createElement(React.Fragment,null,React.createElement(Se,{name:u}),u):u)})))}function Ca(){const[a,r]=E([]),[t,o]=E("");M(()=>{try{const f=localStorage.getItem(we);if(f){const i=JSON.parse(f);Array.isArray(i.items)&&r(i.items),typeof i.notes=="string"&&o(i.notes)}}catch(f){}},[]),M(()=>{try{localStorage.setItem(we,JSON.stringify({items:a,notes:t}))}catch(f){}},[a,t]);const s=f=>r(i=>{const m=i.findIndex(c=>c.id===f.id&&JSON.stringify(c.variants||{})===JSON.stringify(f.variants||{}));if(m>=0){const c=[...i];return c[m]={...c[m],qty:c[m].qty+f.qty},c}return[...i,f]}),d=(f,i)=>r(m=>m.map((c,u)=>u===f?{...c,qty:Math.max(0,Number(i)||0)}:c)),l=f=>r(i=>i.filter((m,c)=>c!==f)),x=()=>r([]),b=a.reduce((f,i)=>f+i.price*i.qty,0);return{items:a,add:s,updateQty:d,removeIndex:l,clear:x,subtotal:b,notes:t,setNotes:o}}function Sa(a,r){const[t,o]=E(()=>bt());return M(()=>{var x;const d=(a||[]).find(b=>b&&b.id===Ve),l=(x=d==null?void 0:d.variants)==null?void 0:x.__config;l&&typeof l=="object"&&o(Je(l))},[a]),{catalogConfig:t,saveCatalogConfig:async d=>{const l=Je(d);o(l);const x=ie({id:Ve,name:"__catalog_config__",sku:"__catalog_config__",category:"All",price:0,description:"Internal catalog config row",hidden:!0,images:[],specs:[],variants:{__config:l},inventory:{}}),b=await it(x);b&&r(f=>{const i=Array.isArray(f)?f:[],m=i.findIndex(c=>c&&c.id===Ve);if(m>=0){const c=[...i];return c[m]=b,c}return[b,...i]})}}}function Aa(){const[a,r]=E([]),[t,o]=E(!0),[s,d]=E("connecting");M(()=>{(async()=>{try{d("connecting");const i=await Ct();r(i);try{localStorage.setItem(Ne,JSON.stringify(i))}catch(m){}d("connected")}catch(i){console.error("Failed to load products from database:",i),d("error");try{const m=localStorage.getItem(Ne);if(m){const c=JSON.parse(m);Array.isArray(c)&&r(c.map(ie).filter(Boolean))}}catch(m){}}finally{o(!1)}})()},[]),M(()=>{if(!fe){console.warn("\u26A0\uFE0F Cannot setup realtime: Supabase not initialized");return}console.log("\u{1F504} Setting up realtime subscription...");const f=fe.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"products"},i=>{console.log("\u{1F534} Realtime event received:",i.eventType,i),r(m=>{if(i.eventType==="INSERT"){console.log("\u2795 Adding product via realtime:",i.new.name);const c=ie(i.new),u=m.findIndex(_=>_.id===c.id);if(u>=0){console.log("\u{1F504} Updating existing product instead of duplicating");const _=[...m];return _[u]=c,_}return[c,...m]}if(i.eventType==="UPDATE"){console.log("\u270F\uFE0F Updating product via realtime:",i.new.name);const c=ie(i.new);return m.map(u=>u.id===i.new.id?c:u)}return i.eventType==="DELETE"?(console.log("\u{1F5D1}\uFE0F Deleting product via realtime:",i.old.id),m.filter(c=>c.id!==i.old.id)):m})}).subscribe(i=>{console.log("\u{1F534} Realtime status:",i),i==="SUBSCRIBED"?(console.log("\u2705 Realtime subscription active!"),d("connected"),Ct().then(m=>{console.log("\u{1F504} Reloaded products after reconnection");const c=m.map(ie).filter(Boolean);r(c);try{localStorage.setItem(Ne,JSON.stringify(c))}catch(u){}}).catch(m=>{console.error("\u274C Failed to reload products after reconnection:",m)})):i==="CHANNEL_ERROR"||i==="CLOSED"?(console.error("\u274C Realtime subscription failed!"),d("error")):(console.log("\u{1F504} Realtime connecting..."),d("connecting"))});return()=>{console.log("\u{1F50C} Cleaning up realtime subscription"),f.unsubscribe()}},[]);const l=f=>{if(typeof f=="function")r(i=>{const m=f(i),c=(Array.isArray(m)?m:[]).map(ie).filter(Boolean);try{localStorage.setItem(Ne,JSON.stringify(c))}catch(u){}return c});else{const i=(Array.isArray(f)?f:[]).map(ie).filter(Boolean);r(i);try{localStorage.setItem(Ne,JSON.stringify(i))}catch(m){}}};return{ownerProducts:a,setOwnerProducts:l,addProduct:async f=>{const i=await aa(f);if(i)return l(c=>[i,...c]),{product:i,persisted:!0};const m=ie(f);return l(c=>[m,...c]),{product:m,persisted:!1}},deleteProduct:async f=>{const i=await ra(f);return i&&l(m=>m.filter(c=>c.id!==f)),i},loading:t,connectionStatus:s}}const jt=a=>{var c;if(!a)return null;const{total_cents:r,totalCents:t,currency:o,status:s,order_items:d,orderItems:l,metadata:x,...b}=a,f=Number((c=r!=null?r:t)!=null?c:0),m=(Array.isArray(d)?d:Array.isArray(l)?l:[]).map(u=>{var P,S,N,U,W,T,h,L;if(!u)return null;const _=Number((W=(P=u.subtotal_cents)!=null?P:u.subtotalCents)!=null?W:(Number((S=u.quantity)!=null?S:0)||0)*(Number((U=(N=u.unit_price_cents)!=null?N:u.unitPriceCents)!=null?U:0)||0));return{...u,quantity:Number((T=u.quantity)!=null?T:0),unit_price_cents:Number((L=(h=u.unit_price_cents)!=null?h:u.unitPriceCents)!=null?L:0),subtotal_cents:_}}).filter(Boolean);return{...b,status:(s||"open").toLowerCase(),total_cents:f,currency:o||Qe,metadata:x||{},order_items:m}},Ft=a=>{if(!a)return 0;const r=a.created_at||a.createdAt||a.inserted_at||a.insertedAt,t=r?new Date(r).getTime():0;return Number.isFinite(t)?t:0},Wt=a=>[...Array.isArray(a)?a:[]].sort((t,o)=>Ft(o)-Ft(t));function Pa(){const[a,r]=E([]),[t,o]=E(!0),[s,d]=E(null),[l,x]=E(null),b=React.useCallback(async()=>{try{o(!0),d(null);const i=await _e("listOrders"),c=(Array.isArray(i==null?void 0:i.data)?i.data:[]).map(jt).filter(Boolean);r(Wt(c)),x((i==null?void 0:i.meta)||null)}catch(i){console.error("Failed to load orders",i),d(i),r([]),x(null)}finally{o(!1)}},[]);M(()=>{b()},[b]);const f=React.useCallback(async(i,m)=>{if(!i||!m)return null;try{const c=await _e("updateOrderStatus",{id:i,status:m}),u=jt(c==null?void 0:c.data);return u&&r(_=>{const P=_.map(S=>S.id===u.id?u:S);return Wt(P)}),u}catch(c){throw console.error("Failed to update order status",c),c!=null&&c.message&&/404/.test(c.message)?new Error("Order no longer exists. Refresh the list and try again."):new Error((c==null?void 0:c.message)||"Unable to update order status. Please try again.")}},[]);return{orders:a,loadingOrders:t,ordersError:s,ordersMeta:l,refreshOrders:b,updateOrderStatus:f}}function Oa({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))}function gt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}function Ba({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}function Dt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}function _a({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}function Ma({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.164a1.5 1.5 0 0 0-1.5 1.5v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}function Ia({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 13.5v2.25m2.598-9.05a6.75 6.75 0 1 1-5.196 0m7.346 9.591 1.263 1.263m-9.856-1.263L6.892 17.05m.944-4.117L5.4 8.5m13.2 0-2.436 4.433"}))}function Ta({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}function La({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9A2.25 2.25 0 0 0 7.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9A2.25 2.25 0 0 0 16.5 5.25H15m-6 0A1.5 1.5 0 0 1 10.5 3.75h3A1.5 1.5 0 0 1 15 5.25m-6 0v.75A1.5 1.5 0 0 0 10.5 7.5h3A1.5 1.5 0 0 0 15 6V5.25"}))}function ja({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.5h13.5v9h-13.5V7.5Zm13.5 0H18a2.25 2.25 0 0 1 1.8.9l1.95 2.6a2.25 2.25 0 0 1 .45 1.35v4.65h-2.25m-1.5 0a1.5 1.5 0 1 0-3 0m3 0H15.75m-9 0a1.5 1.5 0 1 0-3 0m3 0H3.75"}))}function Ut({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0 0 20.885 3.488"}))}function xt({status:a}){const r=(a||"").toLowerCase(),t=r==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":r==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":r==="cancelled"?"border-rose-200 bg-rose-50 text-rose-700":"border-amber-200 bg-amber-50 text-amber-800";return React.createElement("span",{className:z("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium capitalize",t)},Xe[r]||r||"Open")}function tt({title:a,value:r,subtext:t,trend:o}){return React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm ring-1 ring-black/5 sm:p-5"},React.createElement("p",{className:"text-sm font-medium text-slate-500"},a),React.createElement("p",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900"},r),t&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},t),o&&React.createElement("div",{className:"mt-3 inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700"},o))}function Fa({allProducts:a,ownerProducts:r,orders:t,loadingOrders:o,ordersMeta:s,ordersError:d,onNavigate:l,refreshOrders:x}){const b=a.filter(h=>!h.hidden).length,f=r.filter(h=>h.sourceId&&!h.hidden).length,i=r.filter(h=>!h.sourceId&&!h.hidden).length,m=r.filter(h=>h.hidden).length,c=t.reduce((h,L)=>{const y=((L==null?void 0:L.status)||"open").toLowerCase();return h[y]=(h[y]||0)+1,h},{}),u=[...Tt,"cancelled"],_=c.open||0,P=c.confirmed||0,S=c.shipped||0,N=t.filter(h=>["confirmed","shipped"].includes(((h==null?void 0:h.status)||"").toLowerCase())).reduce((h,L)=>h+(Number(L==null?void 0:L.total_cents)||0),0),U=new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format(N/100),W=t.slice(0,5),T=h=>{l==null||l(h)};return React.createElement("div",{className:"flex flex-col gap-10"},React.createElement("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900"},"Owner dashboard"),React.createElement("p",{className:"mt-1 text-sm text-slate-600"},"Monitor catalogue health and stay on top of incoming orders."))),React.createElement("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},React.createElement(tt,{title:"Active SKUs",value:b,subtext:f?`${f} overrides`:void 0}),React.createElement(tt,{title:"Owner additions",value:i,subtext:m?`${m} hidden`:"Live to customers"}),React.createElement(tt,{title:"Open orders",value:o?"\u2014":_,subtext:P?`${P} confirmed`:"Awaiting confirmation"}),React.createElement(tt,{title:"Fulfilled value",value:U,subtext:S?`${S} shipped`:"No shipments yet"})),React.createElement("section",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,1fr)]"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order pipeline"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},"Track each stage to keep fulfilment moving.")),React.createElement("button",{type:"button",onClick:x,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",disabled:o},o?"Refreshing\u2026":"Refresh")),d?/schema cache|relation "orders"/i.test(d.message||"")?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900"},React.createElement("p",{className:"font-medium"},"Orders could not be loaded"),React.createElement("p",{className:"mt-1"},d.message||"Check your connection or Supabase policies and try again.")):s!=null&&s.missingOrdersTable?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("dl",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-4"},u.map(h=>React.createElement("div",{key:h,className:z("rounded-xl border px-4 py-3 text-center flex flex-col items-center justify-center gap-1",h==="open"?"border-amber-200 bg-amber-50 text-amber-800":h==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":h==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":"border-rose-200 bg-rose-50 text-rose-700")},React.createElement("dt",{className:"text-[11px] font-medium uppercase tracking-wide"},Xe[h]||h),React.createElement("dd",{className:"text-2xl font-semibold leading-none"},o?"\u2014":c[h]||0))))),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Recent orders"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},W.length?"Latest activity from verified customers.":"No orders yet \u2014 your list will appear here.")),React.createElement("button",{type:"button",onClick:()=>T("orders"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Open orders")),W.length>0&&React.createElement("ul",{className:"mt-5 space-y-3"},W.map(h=>React.createElement("li",{key:h.id,className:"rounded-xl border border-slate-200 bg-white px-4 py-3 shadow-sm"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium text-slate-900"},h.customer_name||h.customer_email||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},h.customer_email||"Email pending")),React.createElement(xt,{status:h.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(h.created_at||h.createdAt||Date.now()))),React.createElement("span",{className:"font-medium text-slate-700"},new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format((Number(h.total_cents)||0)/100)))))))))}function Wa({orders:a,loading:r,error:t,meta:o,onRefresh:s,onStatusChange:d,onNotify:l}){var h,L;const[x,b]=E("open"),[f,i]=E(null),[m,c]=E(!1),u=J(()=>a.reduce((y,H)=>{const k=((H==null?void 0:H.status)||"open").toLowerCase();return y[k]=(y[k]||0)+1,y.all=(y.all||0)+1,y},{all:0}),[a]),_=J(()=>Array.from(new Set([...Tt,"cancelled","all"])),[]),P=J(()=>x==="all"?a:a.filter(y=>((y==null?void 0:y.status)||"open").toLowerCase()===x),[a,x]);M(()=>{var y;if(!P.length){i(null);return}(!f||!P.some(H=>H.id===f))&&i(((y=P[0])==null?void 0:y.id)||null)},[P,f]);const S=P.find(y=>y.id===f)||null,N=J(()=>new Intl.NumberFormat("en-GB",{style:"currency",currency:be}),[]),U=y=>N.format((Number(y)||0)/100),W=y=>{try{return new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(y))}catch(H){return"\u2014"}},T=async(y,H)=>{const k=String(H||"").toLowerCase();if(!(!y||!k)){if(!ha.includes(k)){l==null||l("error",`Unsupported status transition: ${H}`);return}try{if(c(!0),await(d==null?void 0:d(y,k))){const C=Xe[k]||k;l==null||l("success",`Order status updated to ${C}.`)}}catch(p){console.error("Failed to update order status",p),l==null||l("error",(p==null?void 0:p.message)||"Unable to update order status right now.")}finally{c(!1)}}};if(o!=null&&o.missingOrdersTable)return React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh"));if(t){const y=(t==null?void 0:t.message)||"";return/schema cache|relation "orders"/i.test(y)?React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh")):React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-6 text-sm text-rose-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-rose-900"},"Unable to load orders"),React.createElement("p",{className:"mt-2"},t.message||"Check your connection or Supabase permissions and try again."),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-rose-300 bg-white px-4 py-2 text-xs font-medium text-rose-700 hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-500"},"Retry"))}return React.createElement("div",{className:"flex flex-col gap-6"},React.createElement("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Orders pipeline"),React.createElement("p",{className:"text-sm text-slate-600"},"Move orders from open to shipped, while keeping a full audit trail.")),React.createElement("div",{className:"flex flex-wrap gap-2 text-xs text-slate-500"},React.createElement("span",{className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-amber-700"},`Open: ${u.open||0}`),React.createElement("span",{className:"rounded-full border border-emerald-200 bg-emerald-50 px-3 py-1 text-emerald-700"},`Confirmed: ${u.confirmed||0}`),React.createElement("span",{className:"rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-sky-700"},`Shipped: ${u.shipped||0}`),React.createElement("button",{type:"button",onClick:s,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1 text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},r?"Refreshing\u2026":"Refresh"))),React.createElement("div",{className:"flex flex-wrap gap-2"},_.map(y=>React.createElement("button",{key:y,type:"button",onClick:()=>b(y),className:z("rounded-full border px-3 py-1.5 text-xs font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",x===y?"border-brand bg-[var(--brand-soft-strong)] text-brand shadow-sm":"border-slate-300 bg-white text-slate-600 hover:bg-slate-50")},y==="all"?"All":Xe[y]||y))),r&&!a.length?React.createElement("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white/80 p-10 text-slate-500"},"Loading orders\u2026"):P.length?React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,360px)]"},React.createElement("div",{className:"space-y-3"},P.map(y=>React.createElement("button",{key:y.id,type:"button",onClick:()=>i(y.id),className:z("w-full rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",y.id===f?"border-brand bg-[var(--brand-soft-strong)]/70 text-slate-900 shadow-md":"border-slate-200 bg-white hover:border-slate-300")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-semibold text-slate-900"},y.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},y.customer_email||"Email pending")),React.createElement(xt,{status:y.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,W(y.created_at||y.createdAt)),React.createElement("span",{className:"font-medium text-slate-700"},U(y.total_cents)))))),React.createElement("aside",{className:"rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm"},S?React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},S.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},S.customer_email||"Email pending")),React.createElement(xt,{status:S.status})),React.createElement("dl",{className:"grid grid-cols-2 gap-3 text-xs text-slate-500"},React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Placed"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(S.created_at||S.createdAt))),React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Total"),React.createElement("dd",{className:"mt-1 text-slate-700 font-semibold"},U(S.total_cents))),S.updated_at&&React.createElement("div",{className:"col-span-2"},React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Updated"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(S.updated_at)))),S.order_items&&S.order_items.length>0&&React.createElement("div",null,React.createElement("h4",{className:"text-sm font-semibold text-slate-800"},"Items"),React.createElement("ul",{className:"mt-3 space-y-3"},S.order_items.map(y=>React.createElement("li",{key:y.id||`${y.product_id}-${y.sku}`},React.createElement("div",{className:"flex items-start justify-between gap-3 text-sm text-slate-700"},React.createElement("div",null,React.createElement("p",{className:"font-medium text-slate-900"},y.name||"Item"),y.sku&&React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",y.sku)),React.createElement("span",{className:"text-xs text-slate-500"},`\xD7${y.quantity||0}`)),y.variants&&Object.keys(y.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1 text-xs text-slate-600"},Object.entries(y.variants).map(([H,k])=>{const p=Array.isArray(k)?k.join(", "):k,C=/color/i.test(H);return React.createElement("span",{key:H,className:z("inline-flex items-center gap-1 rounded-full border px-2 py-0.5",C?"border-slate-300 bg-slate-50":"border-slate-200 bg-white")},C?React.createElement(Se,{name:p}):null,`${H}: ${p}`)})),React.createElement("div",{className:"mt-1 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,U(y.unit_price_cents)),React.createElement("span",{className:"font-medium text-slate-700"},U(y.subtotal_cents))))))),(S.note||((h=S.metadata)==null?void 0:h.notes))&&React.createElement("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},S.note||((L=S.metadata)==null?void 0:L.notes)),React.createElement("div",{className:"flex flex-wrap gap-2"},(()=>{const y=(S.status||"open").toLowerCase(),H=[];return y==="open"&&(H.push({label:"Mark as confirmed",next:"confirmed"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),y==="confirmed"&&(H.push({label:"Mark as shipped",next:"shipped"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),H.map(k=>React.createElement("button",{key:k.next,type:"button",onClick:()=>T(S.id,k.next),disabled:m,className:z("inline-flex items-center gap-2 rounded-full border px-4 py-2 text-xs font-medium shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",k.variant==="danger"?"border-rose-300 bg-rose-50 text-rose-700 hover:bg-rose-100":k.next==="shipped"?"border-sky-300 bg-sky-50 text-sky-700 hover:bg-sky-100":"border-emerald-300 bg-emerald-50 text-emerald-700 hover:bg-emerald-100",m?"opacity-60":"")},m?"Updating\u2026":k.label))})())):React.createElement("p",{className:"text-sm text-slate-500"},P.length?"Select an order to see its breakdown.":"No orders in this stage yet."))):React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-8 text-sm text-slate-500"},"No orders in this stage yet."))}function Da({views:a,section:r,onSectionChange:t}){const o=a.find(s=>s.id===r)||a[0];return React.createElement("main",{id:"main",className:"mx-auto w-full max-w-7xl px-4 pb-16 pt-6 sm:px-6 lg:px-8"},React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(200px,240px),minmax(0,1fr)]"},React.createElement("nav",{className:"flex snap-x snap-mandatory gap-3 overflow-x-auto pb-1 lg:flex-col lg:overflow-visible lg:pb-0"},a.map(s=>React.createElement("button",{key:s.id,type:"button",onClick:()=>t(s.id),className:z("snap-start rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",s.id===o.id?"border-brand bg-brand-soft text-brand":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50")},s.icon?React.createElement(s.icon,{className:"mb-2 h-5 w-5 text-current"}):null,React.createElement("span",{className:"block text-sm font-semibold"},s.label),s.description&&React.createElement("span",{className:"mt-1 block text-xs text-slate-500"},s.description)))),React.createElement("section",{className:"min-h-[480px]"},(o==null?void 0:o.element)||React.createElement("p",{className:"text-sm text-slate-500"},"Select a section to begin."))))}function Ua(){return React.createElement("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 rounded-full border border-[var(--surface-border)] bg-white/90 px-3 py-2 text-sm font-semibold text-brand shadow-sm backdrop-blur"},"Skip to content")}function $a({onOpenCart:a,search:r,setSearch:t,ownerMode:o,setOwnerMode:s,cartQty:d,connectionStatus:l,allowOwnerToggle:x}){const[b,f]=E(!1),i=X(null);M(()=>{const c=()=>f(window.scrollY>4);return c(),window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[]),M(()=>{const c=()=>{var _;const u=((_=i.current)==null?void 0:_.offsetHeight)||64;document.documentElement.style.setProperty("--header-offset",u+"px")};return c(),window.addEventListener("resize",c,{passive:!0}),()=>window.removeEventListener("resize",c)},[o,r]);const m=l==="connected"?{wrapper:"border border-emerald-200 bg-emerald-50/80 text-emerald-600",dot:"bg-emerald-500",label:"Online"}:l==="error"?{wrapper:"border border-rose-200 bg-rose-50/80 text-rose-600",dot:"bg-rose-500",label:"Offline"}:{wrapper:"border border-amber-200 bg-amber-50/80 text-amber-600",dot:"bg-amber-400 animate-pulse",label:"Connecting"};return React.createElement("header",{ref:i,className:z("sticky top-0 z-40 w-full border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-xl transition-shadow duration-300",b?"shadow-sm":"")},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"flex h-16 items-center justify-between gap-3"},React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement(Oa,{className:"h-7 w-7 text-brand flex-shrink-0"}),React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement("span",{className:"font-semibold text-slate-900 text-sm sm:text-base tracking-tight truncate"},at),React.createElement("div",{className:`hidden md:flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-medium ${m.wrapper}`,title:`Database ${l}`},React.createElement("span",{className:`inline-block h-2 w-2 rounded-full ${m.dot}`}),React.createElement("span",null,m.label)))),React.createElement("nav",{className:"flex items-center gap-1.5 sm:gap-2"},!o&&React.createElement("label",{className:"relative hidden sm:block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-48 md:w-64 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-2 text-sm font-medium text-slate-600 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(gt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),x&&React.createElement("button",{onClick:()=>s(!o),className:z("rounded-full border px-3 py-2 text-xs sm:text-sm font-medium transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",o?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/60 text-slate-700 hover:bg-white/80")},o?"Back":"Owner"),React.createElement("button",{onClick:a,className:"relative inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/60 px-2.5 sm:px-3.5 py-2 text-xs sm:text-sm font-medium text-slate-700 transition-colors hover:bg-white/80 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Ba,{className:"h-4 w-4 text-brand"}),React.createElement("span",{className:"hidden sm:inline"},"Cart"),d>0&&React.createElement("span",{"aria-live":"polite",className:"absolute -top-1.5 -right-1.5 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-1 text-[10px] font-semibold text-brand"},String(d))))),!o&&React.createElement("div",{className:"sm:hidden pb-0"},React.createElement("label",{className:"relative block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm font-medium text-slate-700 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(gt,{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})))))}function Ga(){const a=[{title:"1. Browse products",detail:"Search or tap a category to find what you need."},{title:"2. Open an item",detail:"Choose the variants and quantities, then add to cart."},{title:"3. Review the cart",detail:"Adjust quantities or notes before sending."},{title:"4. Send via WhatsApp",detail:"Use the cart button to submit the full list for confirmation."}];return React.createElement("section",{"aria-labelledby":"hero-title",className:"border-b border-[var(--surface-border)] bg-hero-gradient"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16"},React.createElement("div",{className:"grid gap-12 lg:grid-cols-[minmax(0,1fr)_420px] items-start"},React.createElement("div",{className:"space-y-6"},React.createElement("span",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-1 text-[11px] font-medium uppercase tracking-[0.14em] text-slate-600"},"Odil Accessories"),React.createElement("h1",{id:"hero-title",className:"text-[clamp(30px,6vw,48px)] font-semibold leading-tight tracking-tight text-slate-900"},"Wholesale catalogue for partner shops"),React.createElement("p",{className:"max-w-2xl text-base sm:text-lg text-slate-600"},$e),React.createElement("div",{className:"flex flex-wrap gap-3"},React.createElement("a",{href:"#catalogue",className:"inline-flex items-center gap-2 rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Browse catalogue",React.createElement(_a,{className:"h-4 w-4"})),React.createElement("a",{href:`https://wa.me/${pe}`,target:"_blank",rel:"noreferrer noopener",className:"inline-flex items-center gap-2 rounded-full border border-[rgba(37,99,235,0.35)] bg-white/70 px-5 py-2.5 text-sm font-semibold text-slate-800 shadow-sm backdrop-blur transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Ut,{className:"h-4 w-4 text-emerald-500"}),"Chat on WhatsApp")),React.createElement("p",{className:"text-sm text-slate-500"},"Follow the steps on the right when you place an order.")),React.createElement("div",{className:"glass-card rounded-3xl p-8 soft-shadow"},React.createElement("div",{className:"space-y-5 text-sm text-slate-600"},React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order steps"),React.createElement("ol",{className:"space-y-3 text-sm"},a.map(r=>React.createElement("li",{key:r.title,className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 px-4 py-3 backdrop-blur"},React.createElement("p",{className:"text-sm font-semibold text-slate-900"},r.title),React.createElement("p",{className:"text-xs text-slate-500 mt-1"},r.detail))))),React.createElement("div",{className:"mt-6 flex items-center justify-between rounded-2xl border border-[var(--surface-border)] bg-white/80 px-4 py-3 text-xs uppercase tracking-[0.18em] text-slate-500"},React.createElement("span",null,"Owner metrics snapshot"),React.createElement("span",{className:"font-semibold text-slate-800"},"Realtime"))))))}function Ha({active:a,setActive:r}){const t=X(null),[o,s]=E({left:!1,right:!1});M(()=>{const l=()=>{const b=t.current;if(!b)return;const{scrollLeft:f,scrollWidth:i,clientWidth:m}=b,c=f>0,u=f+m<i-1;s(_=>_.left===c&&_.right===u?_:{left:c,right:u})};l();const x=t.current;if(x)return x.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",l),()=>{x.removeEventListener("scroll",l),window.removeEventListener("resize",l)}},[]);const d=z("relative -mx-4 overflow-x-auto px-4 chip-scroll-fade",o.left&&"show-left",o.right&&"show-right");return React.createElement(React.Fragment,null,React.createElement("div",{className:"sticky top-[var(--header-offset,64px)] z-30 border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-lg"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Categories"},React.createElement("div",{ref:t,className:d},React.createElement("div",{className:"flex gap-2 py-2 text-[11px]"},ct.map(l=>React.createElement("button",{key:l,onClick:()=>r(l),"aria-pressed":a===l,className:z("inline-flex items-center whitespace-nowrap rounded-full border px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",a===l?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/70 text-slate-600 hover:text-slate-900 hover:bg-white/90")},l)))))))}function Ka({products:a,onOpen:r}){return React.createElement("section",{id:"catalogue","aria-labelledby":"catalogue-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("h2",{id:"catalogue-title",className:"sr-only"},"Catalogue"),React.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},a.map(t=>React.createElement(za,{key:t.id,product:t,onOpen:r}))))}function za({product:a,onOpen:r}){const[t,o]=E(Lt(a));return M(()=>{o(Lt(a))},[a.image,a.images,a.name]),React.createElement("article",{className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white/80 backdrop-blur transition duration-200 hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full overflow-hidden bg-slate-100"},React.createElement("img",{src:t,onError:()=>o(Ae(a.name)),alt:a.name,className:"h-full w-full object-cover",loading:"lazy"})),React.createElement("div",{className:"flex flex-1 flex-col gap-4 p-5"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},a.name),React.createElement("p",{className:"mt-1 text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400"},"SKU ",a.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-[11px]"},(a.specs||[]).slice(0,4).map(s=>React.createElement("span",{key:s,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 font-medium text-slate-600"},s))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},he(a.price))),React.createElement("div",null,React.createElement("button",{type:"button",onClick:()=>r(a),className:"w-full rounded-full border border-[rgba(37,99,235,0.28)] bg-white/70 px-4 py-2 text-sm font-semibold text-brand transition hover:bg-brand hover:text-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"View details"))))}function qa({product:a,onClose:r,onAdd:t,cartItems:o}){const s=a&&a.__edit&&a.product?a.product:a;if(!s)return null;const d=Array.isArray(o)?o:[],l=J(()=>He(s.inventory),[s.inventory]),x=J(()=>{const p={};return d.forEach(C=>{if(!C||C.id!==s.id)return;const w=C.inventoryKey||xe(C.variants||{});p[w]=(p[w]||0)+Number(C.qty||0)}),p},[d,s.id]),b=X(null);et(!!s,b,r);const f=(()=>{const p=Array.isArray(s.images)&&s.images.length?s.images:s.image?[s.image]:[];return(p.length?p:[Ae(s.name)]).map(C=>ze(C,s.name))})(),i=s.variants||{},m=Object.entries(i).filter(([,p])=>Array.isArray(p)&&p.length>0).map(([p])=>p),[c,u]=E({}),[_,P]=E({}),[S,N]=E({});M(()=>{if(!s)return;const p={};m.forEach(O=>{const I=i[O]||[];p[O]=I.length?[I[0]]:[]}),u(p);const C=(()=>{if(m.length===0)return[ee];const O=[],I=($,te)=>{if($===m.length){O.push(xe(te));return}const R=m[$];(p[R]||[]).forEach(F=>I($+1,{...te,[R]:F}))};return I(0,{}),O})(),w={};C.forEach(O=>{w[O]=0}),P(w)},[s]);const U=(p,C)=>u(w=>{const O=w[p]||[],I=O.includes(C)?O.filter($=>$!==C):[...O,C];return{...w,[p]:I}}),W=p=>u(C=>({...C,[p]:[...i[p]||[]]})),T=p=>u(C=>({...C,[p]:[]})),h=(p,C)=>{const w=Math.max(0,Number(C)||0);N(O=>{const I=O[p];if(I===void 0)return O;if(w<I){const $={...O};return delete $[p],$}return O}),P(O=>({...O,[p]:w}))},L=J(()=>{if(m.length===0)return[{key:ee,sel:{}}];if(m.some(w=>(c[w]||[]).length===0))return[];const p=[],C=(w,O)=>{if(w===m.length){p.push({key:xe(O),sel:O});return}const I=m[w];(c[I]||[]).forEach($=>C(w+1,{...O,[I]:$}))};return C(0,{}),p},[m,c]),y=()=>{let p=!1,C=!1;L.forEach(({key:w,sel:O})=>{const I=Number(_[w]||0);if(!(I>0))return;const $=l[w]!==void 0?l[w]:w===ee?l[ee]:void 0,te=x[w]||0,R=typeof $=="number"?Math.max($-te,0):void 0,F=typeof R=="number"?Math.min(I,R):I;F>0?(t({id:s.id,name:s.name,sku:s.sku,price:s.price,qty:F,variants:O,inventoryKey:w}),p=!0,F<I&&(C=!0)):C=!0}),C&&alert("Some items were adjusted to match available stock."),p&&r()},H=J(()=>L.reduce((p,{key:C})=>{const w=Number(_[C]||0);if(!Number.isFinite(w)||w<=0)return p;const O=l[C]!==void 0?l[C]:C===ee?l[ee]:void 0,I=x[C]||0,$=typeof O=="number"?Math.max(O-I,0):void 0,te=typeof $=="number"?Math.min(w,$):w;return te>0?p+te*s.price:p},0),[L,_,s.price,l,x]),k=L.every(({key:p})=>{const C=Number(_[p]||0);if(!(C>0))return!0;const w=l[p]!==void 0?l[p]:p===ee?l[ee]:void 0,O=x[p]||0,I=typeof w=="number"?Math.max(w-O,0):void 0;return!((typeof I=="number"?Math.min(C,I):C)>0)});return M(()=>{N(p=>{const C=new Set(L.map(({key:I})=>I));let w=!1;const O={};return Object.entries(p).forEach(([I,$])=>{C.has(I)?O[I]=$:w=!0}),w?O:p})},[L]),M(()=>{N({})},[s.id]),React.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":`product-title-${s.id}`,className:"fixed inset-0 z-50 flex items-stretch sm:items-center justify-center bg-black/40 p-0 sm:p-6",onClick:r,onTouchMove:p=>{p.target===p.currentTarget&&p.preventDefault()},onWheel:p=>{p.target===p.currentTarget&&p.preventDefault()}},React.createElement("div",{ref:b,tabIndex:-1,className:"w-full h-full sm:h-auto sm:max-w-3xl rounded-none sm:rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain overflow-y-auto max-h-none sm:max-h-[90vh]",style:{touchAction:"pan-y"},onClick:p=>p.stopPropagation()},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:`product-title-${s.id}`,className:"text-lg font-semibold text-slate-900"},s.name),React.createElement("button",{onClick:r,className:"rounded-full border border-transparent p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close"},React.createElement(Dt,{className:"h-5 w-5"}))),React.createElement("div",{className:"grid gap-6 p-5 lg:grid-cols-[minmax(0,1fr)_260px]"},React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-slate-100"},React.createElement("img",{src:f[0],onError:p=>{p.currentTarget.src=Ae(s.name)},alt:`${s.name} \u2013 photo`,className:"h-full w-full object-cover"})),s.description&&React.createElement("p",{className:"text-sm text-slate-600"},s.description),m.map(p=>{const C=i[p]||[],w=c[p]||[],O=p.toLowerCase().includes("color")||p==="Color";return React.createElement("div",{key:p,className:"rounded-2xl border border-[var(--surface-border)] bg-white/80 p-4 text-sm shadow-sm backdrop-blur"},React.createElement("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},p),C.length?React.createElement("div",{className:"flex items-center gap-2 text-xs text-slate-500"},React.createElement("button",{type:"button",onClick:()=>W(p),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:()=>T(p),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"Clear")):null),React.createElement("div",{className:"max-h-32 overflow-auto rounded-xl border border-[var(--surface-border)] bg-white/70 p-2"},React.createElement("div",{className:"flex flex-wrap gap-2 text-xs"},C.length===0?React.createElement("p",{className:"text-slate-500"},"No options"):C.map(I=>{const $=w.includes(I);return React.createElement("button",{type:"button",key:I,onClick:()=>U(p,I),className:z("inline-flex items-center gap-1 rounded-full border px-3 py-1 font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",$?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},O?React.createElement(Se,{name:I}):null,I)}))))}),React.createElement("div",{className:"space-y-3","aria-label":"Quantities"},L.length===0?React.createElement("p",{className:"text-xs text-slate-500"},"Select at least one option."):L.map(({key:p,sel:C})=>{const w=l[p]!==void 0?l[p]:p===ee?l[ee]:void 0,O=x[p]||0,I=typeof w=="number"?Math.max(w-O,0):void 0,$=typeof I=="number"&&I<=0,te=S[p];return React.createElement("div",{key:p,className:z("rounded-2xl border px-3 py-3 text-sm shadow-sm backdrop-blur sm:flex sm:items-center sm:justify-between",$?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/85 text-slate-700")},React.createElement("div",{className:"space-y-1 text-sm"},Object.entries(C).map(([R,F],V)=>React.createElement("span",{key:`${R}-${F}`},V>0?" \xB7 ":"",R==="Color"?React.createElement("span",{className:"inline-flex items-center gap-1"},React.createElement(Se,{name:F}),F):React.createElement("span",{className:"font-medium text-slate-900"},F))),Object.keys(C).length===0&&React.createElement("span",{className:"font-medium text-slate-900"},"Quantity"),typeof w=="number"?React.createElement("p",{className:"text-xs text-slate-500"},`Remaining: ${Math.max(w-O,0)}${O>0?` (of ${w})`:""}`):React.createElement("p",{className:"text-xs text-slate-500"},"No stock limit")),React.createElement("div",{className:"mt-2 sm:mt-0"},React.createElement($t,{value:Number(_[p]||0),onChange:R=>h(p,R),min:0,max:typeof I=="number"?I:void 0,onLimit:R=>{typeof R=="number"&&Number.isFinite(R)&&N(F=>({...F,[p]:R}))}})),te!==void 0?React.createElement("p",{className:"mt-2 text-xs font-medium text-rose-600 sm:ml-3 sm:mt-0 sm:text-right"},`Only ${te} available for this selection.`):null)}))),React.createElement("aside",{className:"glass-card rounded-3xl space-y-5 p-5"},React.createElement("div",{className:"space-y-2 text-sm"},React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Unit price"),React.createElement("span",{className:"font-semibold text-slate-900"},he(s.price))),React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Selections"),React.createElement("span",{className:"font-medium text-slate-800"},L.length))),React.createElement("div",{className:"flex items-center justify-between rounded-2xl border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-4 py-3 text-sm font-medium text-brand"},React.createElement("span",{className:"uppercase tracking-[0.18em]"},"Line total"),React.createElement("span",{className:"text-base font-semibold text-brand"},he(H))),React.createElement("p",{className:"text-xs text-slate-500"},"Add items to the cart and send the final list to WhatsApp when you are ready."),React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("button",{disabled:k,onClick:y,className:z("w-full rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",k?"pointer-events-none opacity-50":"hover:bg-brand-muted")},"Add to cart"),React.createElement("button",{onClick:r,className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Cancel"))))))}function $t({id:a,value:r,onChange:t,min:o=0,max:s,onLimit:d}){const l=i=>{typeof s=="number"&&Number.isFinite(s)&&typeof d=="function"&&i>s&&d(s)},x=(i,m)=>{l(typeof m=="number"?m:i);let c=Math.max(o,i);return typeof s=="number"&&Number.isFinite(s)&&(c=Math.min(s,c)),c},b=Number(r)||0,f=typeof s=="number"&&Number.isFinite(s)&&b>=s;return React.createElement("div",{className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/70 shadow-sm backdrop-blur",role:"group","aria-label":"Quantity"},React.createElement("button",{onClick:()=>t(x((Number(r)||0)-1,(Number(r)||0)-1)),className:"rounded-l-full px-3 py-1.5 text-slate-700 transition hover:bg-brand-soft focus:outline-none focus-visible:outline-2 focus-visible:outline-brand touch-manipulation select-none","aria-label":"Decrease quantity"},"\u2212"),React.createElement("input",{id:a,inputMode:"numeric",pattern:"[0-9]*",value:String(r),onChange:i=>{const m=Number(i.target.value.replace(/[^0-9]/g,"")),c=Number.isFinite(m)?m:o;t(Number.isFinite(m)?x(c,c):o)},className:"w-14 appearance-none border-x border-[var(--surface-border)] bg-transparent px-2 py-1.5 text-center text-base sm:text-sm text-slate-900 focus:outline-none"}),React.createElement("button",{onClick:()=>t(x((Number(r)||0)+1,(Number(r)||0)+1)),className:z("rounded-r-full px-3 py-1.5 touch-manipulation select-none transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",f?"cursor-not-allowed text-slate-300":"text-slate-700 hover:bg-brand-soft"),"aria-label":"Increase quantity",disabled:f},"+"))}async function Ya(a){var r;try{if((r=navigator.clipboard)!=null&&r.writeText)return await navigator.clipboard.writeText(a),!0}catch(t){}try{const t=document.createElement("textarea");return t.value=a,t.setAttribute("readonly",""),t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(t){return!1}}function Qa({open:a,onClose:r,cart:t,productLookup:o}){const s=X(null);et(a,s,r);const d=wa(),l=J(()=>Va(t.items,t.subtotal,t.notes),[t.items,t.subtotal,t.notes]),x=t.items.some(u=>Number(u.qty)>0),b=`https://wa.me/${pe}?text=${encodeURIComponent(l)}`,f=`whatsapp://send?phone=${pe}&text=${encodeURIComponent(l)}`,i=/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent),[m,c]=E({});return M(()=>{c(u=>{const _=new Set((t.items||[]).map(N=>{if(!N)return null;const U=N.inventoryKey||xe(N.variants||{});return`${N.id||""}::${U}`}).filter(Boolean));let P=!1;const S={};return Object.entries(u).forEach(([N,U])=>{_.has(N)?S[N]=U:P=!0}),P?S:u})},[t.items]),React.createElement("div",{"aria-live":"polite"},React.createElement("div",{className:z("fixed inset-0 z-40 bg-black/40 transition-opacity",a?"opacity-100":"pointer-events-none opacity-0"),onClick:r,onTouchMove:u=>{u.preventDefault()},onTouchStart:u=>{u.preventDefault()},onWheel:u=>{u.preventDefault()},"aria-hidden":"true"}),React.createElement("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",className:z("fixed right-0 top-0 z-50 h-full w-full max-w-md transform border-l border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain",d?"transition-none":"transition-transform duration-200 ease-out",a?"translate-x-0":"translate-x-full")},React.createElement("div",{ref:s,className:"flex h-full flex-col"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:"cart-title",className:"text-lg font-semibold text-slate-900"},"Your cart"),React.createElement("button",{onClick:r,className:"rounded-full p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close cart"},React.createElement(Dt,{className:"h-5 w-5"}))),React.createElement("div",{className:"flex-1 overflow-y-auto p-4",style:{touchAction:"pan-y"}},t.items.length===0?React.createElement("p",{className:"text-sm text-slate-500"},"Your cart is empty."):React.createElement("ul",{className:"space-y-3"},t.items.map((u,_)=>{const P=o&&typeof o.get=="function"?o.get(u.id):void 0,S=P?He(P.inventory):{},N=u.inventoryKey||xe(u.variants||{}),U=S[N]!==void 0?S[N]:N===ee?S[ee]:void 0;let W=0;t.items.forEach((k,p)=>{if(p===_||!k||k.id!==u.id)return;(k.inventoryKey||xe(k.variants||{}))===N&&(W+=Number(k.qty||0))});const T=typeof U=="number"?Math.max(U-W,0):void 0,h=typeof T=="number"&&u.qty>T,L=typeof T=="number"?`Available: ${T}`:null,y=`${u.id||""}::${N}`,H=m[y];return React.createElement("li",{key:_,className:z("rounded-2xl border p-3 shadow-sm backdrop-blur transition",h?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/80 text-slate-700")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"font-semibold text-slate-900"},u.name),React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",u.sku),u.variants&&Object.keys(u.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1.5"},Object.entries(u.variants).map(([k,p])=>React.createElement("span",{key:k,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2 py-0.5 text-xs font-medium text-slate-600"},k==="Color"?React.createElement(React.Fragment,null,React.createElement(Se,{name:p}),`${k}: ${p}`):`${k}: ${p}`))),L&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},L),H!==void 0?React.createElement("p",{className:"mt-1 text-xs font-medium text-rose-600"},`Only ${H} available for this selection.`):null),React.createElement("button",{onClick:()=>t.removeIndex(_),className:"rounded-full p-1.5 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":`Remove ${u.name}`},React.createElement(Ma,{className:"h-4 w-4 text-slate-500"}))),React.createElement("div",{className:"mt-2 flex items-center justify-between"},React.createElement($t,{value:u.qty,onChange:k=>{const p=typeof T=="number"?Math.min(k,T):k;t.updateQty(_,p),c(C=>{const w=C[y];if(w===void 0)return C;if(p<w){const O={...C};return delete O[y],O}return C})},min:0,max:typeof T=="number"?T:void 0,onLimit:k=>{typeof k=="number"&&Number.isFinite(k)&&c(p=>({...p,[y]:k}))}}),React.createElement("div",{className:"text-sm text-slate-600"},he(u.price)," \xD7 ",u.qty," = ",React.createElement("span",{className:"font-semibold text-slate-900"},he(u.price*u.qty)))))}))),React.createElement("div",{className:"border-t border-[var(--surface-border)] bg-white/60 p-4 backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-sm text-slate-600"},React.createElement("span",null,"Subtotal"),React.createElement("span",{className:"font-semibold text-slate-900"},he(t.subtotal))),React.createElement("label",{className:"mt-3 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Notes"),React.createElement("textarea",{value:t.notes,onChange:u=>t.setNotes(u.target.value),rows:2,className:"w-full resize-none rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Delivery preferences, color mix, etc."})),React.createElement("div",{className:"mt-3 flex gap-3"},React.createElement("button",{onClick:t.clear,className:"flex-1 rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear cart"),React.createElement("button",{type:"button",onClick:async()=>{if(!x){alert("Add at least one product before sending an order.");return}if(t.items.filter((N,U)=>{const W=o&&typeof o.get=="function"?o.get(N.id):void 0,T=W?He(W.inventory):{},h=N.inventoryKey||xe(N.variants||{}),L=T[h]!==void 0?T[h]:h===ee?T[ee]:void 0;if(typeof L!="number")return!1;let y=0;t.items.forEach((k,p)=>{if(p===U||!k||k.id!==N.id)return;(k.inventoryKey||xe(k.variants||{}))===h&&(y+=Number(k.qty||0))});const H=Math.max(L-y,0);return N.qty>H}).length>0){alert("One or more items exceed available stock. Please adjust the quantities before sending the order.");return}try{await _e("createOrder",{currency:be,subtotal_cents:Math.round(t.subtotal*100),notes:t.notes||"",items:t.items.map((N,U)=>({product_id:N.id,sku:N.sku,name:N.name,quantity:Number(N.qty)||0,unit_price_cents:Math.round(Number(N.price||0)*100),subtotal_cents:Math.round(Number(N.price||0)*Number(N.qty||0)*100),variants:N.variants||{},inventory_key:N.inventoryKey||xe(N.variants||{})}))})}catch(N){console.error("Failed to record order",N)}try{await Ya(l),alert("\u2705 Your list is copied! If WhatsApp doesn't open, you can paste it manually.")}catch(N){alert("\u{1F4CB} Please copy your order manually if WhatsApp doesn't open automatically.")}let _=!1;const P=()=>{_||(_=!0,t.clear(),t.setNotes(""))},S=()=>P();if(window.addEventListener("pagehide",S,{once:!0}),document.addEventListener("visibilitychange",function N(){document.hidden&&(P(),document.removeEventListener("visibilitychange",N))},{once:!0}),i)P(),window.location.href=f,setTimeout(()=>{try{window.open(b,"_blank","noopener,noreferrer")}catch(N){}},800);else{const N=window.open(b,"_blank","noopener,noreferrer");setTimeout(P,500)}},className:z("flex-1 inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",x?"bg-brand hover:bg-brand-muted":"pointer-events-none bg-[rgba(37,99,235,0.28)] text-white/70")},"Send via WhatsApp",React.createElement(Ut,{className:"h-4 w-4 text-white"})))))))}function Va(a,r,t){const o=(a||[]).filter(d=>Number(d.qty)>0);let s=`\u{1F6D2} *Order Request*

`;return o.forEach(d=>{s+=`\u2022 ${d.name} (SKU: ${d.sku})
`,d.variants&&Object.keys(d.variants).length>0&&(s+=`  Variants: ${Object.entries(d.variants).map(([l,x])=>`${l}: ${x}`).join(", ")}
`),s+=`  Qty: ${d.qty} \xD7 ${he(d.price)} = ${he(d.price*d.qty)}

`}),s+=`*Subtotal: ${he(r)}*

`,(t||"").trim()&&(s+=`*Notes:* ${t.trim()}

`),s+="Please confirm availability and pricing. Thank you!",s}function Ja({addProduct:a,onNotify:r,catalogConfig:t,saveCatalogConfig:o}){var Jt;const s=Array.isArray(t==null?void 0:t.categories)&&t.categories.length?t.categories:ct.filter(e=>e!=="All"),d=Array.isArray(t==null?void 0:t.families)&&t.families.length?t.families:bt().families,[l,x]=E(s[0]||"Phone Screens"),[b,f]=E(((Jt=d[0])==null?void 0:Jt.id)||"iphone"),i=d.find(e=>e&&e.id===b)||d[0]||{name:"iPhone",models:Me},m=Array.isArray(i==null?void 0:i.models)?i.models:[];M(()=>{s.includes(l)||x(s[0]||"Phone Screens")},[s]),M(()=>{var e;d.some(n=>n&&n.id===b)||f(((e=d[0])==null?void 0:e.id)||"iphone")},[d]);const[c,u]=E("");M(()=>{u(e=>{const n=new Set(s),g=(e||"").trim(),v=n.has(g.replace(" \u2014",""))||g.endsWith(" \u2014");return!g||v?`${l} \u2014 `:e})},[l,s]);const[_,P]=E(""),[S,N]=E(""),[U,W]=E(""),[T,h]=E([]),[L,y]=E([]),[H,k]=E(null),[p,C]=E(!1),[w,O]=E({}),I=e=>String(e||"").toLowerCase().includes("multi"),$=e=>I(e==null?void 0:e.mode),te=e=>I(e)?"multi":"single",R=e=>e==="familyModels"?"familyModels":"static",F=(e,n)=>{if(!e||typeof e!="object")return e;const g={...e};return g.mode=te(e.mode),g.optionsSource=R(e.optionsSource),g.options=Array.isArray(e.options)?e.options:[],n==="customer"?g.fieldType="select":g.fieldType=e.fieldType==="checkbox"?"checkbox":"select",g},V=e=>({info:((e==null?void 0:e.info)||[]).map(n=>F(n,"info")).filter(Boolean),customer:((e==null?void 0:e.customer)||[]).map(n=>F(n,"customer")).filter(Boolean)}),Z=()=>{var g;const e=(g=t==null?void 0:t.groupOverridesByCategoryFamily)==null?void 0:g[l],n=e==null?void 0:e[b];return!n||typeof n!="object"?null:{info:n.info&&typeof n.info=="object"?n.info:{},customer:n.customer&&typeof n.customer=="object"?n.customer:{}}},se=()=>{var g;const e=(g=t==null?void 0:t.groupHiddenByCategoryFamily)==null?void 0:g[l],n=e==null?void 0:e[b];return!n||typeof n!="object"?{info:[],customer:[]}:{info:Array.isArray(n.info)?n.info:[],customer:Array.isArray(n.customer)?n.customer:[]}},ce=e=>{const n=Z(),g=se(),v=(A,B)=>{const q=new Set(((g==null?void 0:g[B])||[]).map(Y=>String(Y))),D=(n==null?void 0:n[B])||{},me=(Array.isArray(A)?A:[]).filter(Y=>Y&&!q.has(String(Y.id))).map(Y=>{const ue=D[String(Y.id)];return F(ue&&typeof ue=="object"?{...Y,...ue}:Y,B)});return Object.keys(D||{}).forEach(Y=>{if(q.has(String(Y))||me.some(re=>String(re.id)===String(Y)))return;const ue=D[Y];ue&&typeof ue=="object"&&me.push(F({id:Y,...ue},B))}),me.filter(Boolean)};return{info:v(e==null?void 0:e.info,"info"),customer:v(e==null?void 0:e.customer,"customer")}},de=(e,n)=>{y([]),k(null),O(g=>({...g,[e]:n}))},Te=(e,n)=>O(g=>{y([]),k(null);const v=Array.isArray(g[e])?g[e]:[];return{...g,[e]:v.includes(n)?v.filter(A=>A!==n):[...v,n]}});function Le(e){y([]),k(null);const n=Array.from(e.target.files||[]);if(!n.length)return;const g=n.map(v=>new Promise(A=>{const B=new FileReader;B.onload=()=>A(String(B.result||"")),B.readAsDataURL(v)}));Promise.all(g).then(v=>h(A=>[...A,...v]))}const ye=e=>Array.isArray(e)&&e.length?e[0]:e!=null?e:"",qe={"Phone Screens":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"display",label:"Display type/quality",type:"select",options:["OLED \u2013 OEM","OLED \u2013 AAA","LCD \u2013 OEM","LCD \u2013 AAA"]},{key:"frame",label:"Frame",type:"select",options:["With frame","Without frame"]}],also:[{key:"frontColor",label:"Front color",type:"select",options:["Black","White"]},{key:"retention",label:"True Tone/Face ID retention",type:"checkbox"}],optional:[{key:"adhesive",label:"Pre-installed adhesive / waterproof gasket",type:"checkbox"}],name:e=>`Screen \u2014 ${ye(e.models)} ${e.display?`${String(e.display).split(" ")[0]}`:""}`.trim(),specs:e=>[e.display,e.frame,e.frontColor].filter(Boolean)},"Back Glass":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"colors",label:"Colors / finish",type:"multiselect",options:Ke}],also:[{key:"adhesive",label:"Adhesive pre-installed",type:"checkbox"},{key:"rings",label:"With camera rings",type:"checkbox"}],optional:[{key:"grade",label:"Quality grade",type:"select",options:At}],name:e=>`Back Glass \u2014 ${ye(e.models)}`.trim(),specs:e=>[ye(e.colors)||null,e.grade,e.adhesive?"Adhesive":null,e.rings?"Camera rings":null].filter(Boolean)},"Power Banks":{must:[{key:"capacity",label:"Capacity",type:"select",options:xa},{key:"ports",label:"Output ports",type:"select",options:Bt}],also:[{key:"standard",label:"Standard",type:"select",options:Ie}],optional:[{key:"colour",label:"Colour",type:"select",options:Ke}],name:e=>`Power bank \u2014 ${e.capacity||""}`.trim(),specs:e=>[e.capacity,e.ports,e.standard].filter(Boolean)},"Screen Protectors":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:oa},{key:"pack",label:"Pack",type:"select",options:ia}],also:[{key:"finish",label:"Finish",type:"select",options:la},{key:"coverage",label:"Coverage",type:"select",options:ca}],optional:[],name:e=>`Protector \u2014 ${ye(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,e.finish,e.coverage].filter(Boolean)},Batteries:{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"grade",label:"Grade",type:"select",options:At}],also:[],optional:[{key:"capacity",label:"Capacity (mAh)",type:"text",placeholder:"e.g. 3000"}],name:e=>`Battery \u2014 ${ye(e.models)}`.trim(),specs:e=>[e.grade,e.capacity].filter(Boolean)},"Mobile Phones":{must:[{key:"model",label:"Model",type:"text",placeholder:"e.g., iPhone 13"},{key:"cond",label:"Condition/grade",type:"select",options:_t},{key:"sim",label:"SIM",type:"select",options:ba}],also:[{key:"connect",label:"Connectivity",type:"select",options:fa},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Mt},{key:"ram",label:"RAM",type:"multiselect",options:It},{key:"color",label:"Color",type:"text"},{key:"inbox",label:"Accessories in box",type:"text",placeholder:"Cable, charger"}],name:e=>`${e.model||""} ${e.cond||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.cond,e.sim,e.connect].filter(Boolean)},Tablets:{must:[{key:"model",label:"Model",type:"text",placeholder:"iPad 10th Gen"},{key:"conn",label:"Connectivity",type:"select",options:ya}],also:[{key:"screen",label:"Screen size",type:"text",placeholder:'10.9"'},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Mt},{key:"ram",label:"RAM",type:"multiselect",options:It},{key:"cond",label:"Condition/grade",type:"select",options:_t},{key:"color",label:"Color",type:"text"},{key:"compat",label:"Pencil/keyboard compatibility",type:"text"}],name:e=>`${e.model||""} ${e.conn||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.conn,e.screen,e.cond].filter(Boolean)},"Phone Cases":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:na}],also:[{key:"color",label:"Color",type:"multiselect",options:Ke}],optional:[{key:"pattern",label:"Pattern / style",type:"text"}],name:e=>`Case \u2014 ${ye(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,ye(e.color)||null].filter(Boolean)},Cables:{must:[{key:"connector",label:"Connector",type:"select",options:ft},{key:"length",label:"Length",type:"select",options:Pt}],also:[{key:"rating",label:"Power rating",type:"select",options:Ot},{key:"durability",label:"Durability",type:"select",options:ma}],optional:[{key:"cert",label:"Certs",type:"select",options:da}],name:e=>`Cable \u2014 ${e.connector||""} ${e.length?`(${e.length})`:""}`.trim(),specs:e=>[e.connector,e.length,e.rating].filter(Boolean)},Chargers:{must:[{key:"wattage",label:"Wattage",type:"select",options:ua||["20W","30W","45W","65W"]},{key:"ports",label:"Ports",type:"select",options:Bt}],also:[{key:"standard",label:"Standard",type:"select",options:Ie},{key:"plug",label:"Plug type",type:"select",options:pa}],optional:[],name:e=>`Charger \u2014 ${e.wattage||""}`.trim(),specs:e=>[e.wattage,e.ports].filter(Boolean)},Earphones:{must:[{key:"type",label:"Type",type:"select",options:["Wired","TWS"]}],also:[{key:"connector",label:"Connector / Standard",type:"select",options:[...ft,...Ie]}],optional:[{key:"color",label:"Color",type:"select",options:Ke}],name:e=>`Earphones \u2014 ${e.type||""}`.trim(),specs:e=>[e.type,e.connector].filter(Boolean)},"Charging Ports":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"type",label:"Port type",type:"select",options:["USB-C","Lightning","Micro-USB"]}],also:[],optional:[{key:"solderRequired",label:"Solder required",type:"checkbox"}],name:e=>`Charging port \u2014 ${ye(e.models)}`.trim(),specs:e=>[e.type,e.solderRequired?"Solder":null].filter(Boolean)},"Face ID":{must:[{key:"models",label:"Phone models",type:"phoneModels",allowedBrands:["iPhone"]},{key:"service",label:"Service",type:"select",options:["Repair","Replace","Calibration"]}],also:[],optional:[],name:e=>`Face ID \u2014 ${ye(e.models)}`.trim(),specs:e=>[e.service].filter(Boolean)}},j=e=>{const n=qe[e]||{must:[],also:[],optional:[]},g=[...n.must||[],...n.also||[],...n.optional||[]],v={info:[],customer:[]};return g.forEach(A=>{if(!A||!A.key)return;const B={id:A.key,label:A.label,schemaKey:A.key,fieldType:A.type,options:Array.isArray(A.options)?A.options:[]};if(A.type==="phoneModels"){v.customer.push({...B,key:"Model",mode:"multi",optionsSource:"familyModels"});return}if(A.type==="multiselect"){v.customer.push({...B,key:pt(A.label,A.key),mode:"multi",optionsSource:"static"});return}v.info.push({...B,mode:A.type==="multiselect"?"multi":"single",optionsSource:"static"})}),v},Q=()=>{var n;const e=(n=t==null?void 0:t.groupsByCategory)==null?void 0:n[l];return e&&e.info&&e.customer?e:null},K=J(()=>{const e=Q(),n=V(e||j(l)),g=ce(n),v=(g.customer||[]).map(A=>A&&A.key==="Model"?{...A,label:`${(i==null?void 0:i.name)||"Phone"} models`}:A);return{...g,customer:v}},[t,l,b]),ge=async e=>{const n=Je(t);n.groupsByCategory=n.groupsByCategory||{},n.groupsByCategory[l]=e,await o(n)},Pe=async()=>{const e=Q();if(e)return e;const n=j(l);return await ge(n),n};M(()=>{const e={};(K.info||[]).forEach(n=>{!n||!n.schemaKey||(n.fieldType==="select"||n.fieldType==="number"||n.fieldType==="text"?e[n.schemaKey]="":n.fieldType==="checkbox"?e[n.schemaKey]=!1:$(n)?e[n.schemaKey]=[]:e[n.schemaKey]="")}),(K.customer||[]).forEach(n=>{!n||!n.schemaKey||($(n)?e[n.schemaKey]=[]:e[n.schemaKey]="")}),O(e)},[l,K]);const[ve,ae]=E(null),[oe,Oe]=E({scope:"info",id:null,label:"",key:"",mode:"single",fieldType:"select",optionsSource:"static",optionsText:""}),[Ht,je]=E(""),[Ar,Kt]=E(""),[zt,ht]=E(""),[Ee,Fe]=E({id:null,name:"",modelsText:""}),tr=e=>{try{return JSON.parse(JSON.stringify(e))}catch(n){return e}},ar=e=>String(e||"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),We=async e=>{const n=Je(t),g=tr(n),v=(typeof e=="function"?e(g):g)||g;await o(v)},rr=()=>{Fe({id:null,name:"",modelsText:""}),ae({type:"family"})},sr=()=>{ht(""),ae({type:"category"})},nr=async()=>{const e=String(zt||"").trim();e&&(await We(n=>{const g=Array.isArray(n.categories)?[...n.categories]:[];return g.includes(e)||g.push(e),n.categories=g,n}),x(e),ht(""),ae(null))},or=async e=>{const n=String(e||"").trim();n&&confirm(`Remove category "${n}"? Existing products will still keep their category text.`)&&await We(g=>(g.categories=(Array.isArray(g.categories)?g.categories:[]).filter(v=>v!==n),g))},lr=e=>{const n=Array.isArray(e==null?void 0:e.models)?e.models:[];Fe({id:(e==null?void 0:e.id)||null,name:(e==null?void 0:e.name)||"",modelsText:n.join(`
`)})},ir=async()=>{const e=String(Ee.name||"").trim();if(!e)return;const n=String(Ee.modelsText||"").split(`
`).map(B=>B.trim()).filter(Boolean),g=Array.from(new Set(n)),v=Ee.id?String(Ee.id):null;let A=v||ar(e)||`family_${Date.now()}`;await We(B=>{const q=Array.isArray(B.families)?[...B.families]:[];if(v)return B.families=q.map(D=>D&&D.id===v?{...D,name:e,models:g}:D),B;{const D=A;let me=2;for(;q.some(Y=>Y&&Y.id===A);)A=`${D}_${me++}`;q.push({id:A,name:e,models:g})}return B.families=q,B}),f(A),Fe({id:null,name:"",modelsText:""}),ae(null)},cr=async e=>{const n=String((e==null?void 0:e.id)||"").trim(),g=String((e==null?void 0:e.name)||"").trim();n&&confirm(`Remove family "${g||n}"? Existing products will still keep their family meta.`)&&await We(v=>(v.families=(Array.isArray(v.families)?v.families:[]).filter(A=>A&&A.id!==n),v))},qt=async e=>{await Pe(),je(""),Kt(""),Oe({scope:e,id:null,label:"",key:"",mode:e==="customer"?"multi":"single",fieldType:"select",optionsSource:"static",optionsText:""}),ae({type:"group"})},Yt=async(e,n)=>{await Pe(),je(""),Kt("");const g=e==="info"&&n.fieldType==="checkbox",v=g?`Yes
No`:(Array.isArray(n.options)?n.options:[]).join(`
`);Oe({scope:e,id:n.id,label:n.label||"",key:n.key||"",mode:g?"single":I(n.mode)?"multi":"single",fieldType:"select",optionsSource:n.optionsSource||"static",optionsText:v}),ae({type:"group"})},dr=e=>Array.from(new Set(String(e||"").split(/[,;\n]/g).map(n=>n.trim()).filter(Boolean))),Pr=e=>{const n=Array.from(new Set((Array.isArray(e)?e:[]).map(g=>String(g).trim()).filter(Boolean)));Oe(g=>({...g,optionsText:n.join(`
`)}))},Or=()=>{},Br=()=>{},Qt=async(e,n)=>{await Pe();const g=String((n==null?void 0:n.id)||"").trim();g&&(await We(v=>{v.groupHiddenByCategoryFamily=v.groupHiddenByCategoryFamily&&typeof v.groupHiddenByCategoryFamily=="object"?v.groupHiddenByCategoryFamily:{},v.groupOverridesByCategoryFamily=v.groupOverridesByCategoryFamily&&typeof v.groupOverridesByCategoryFamily=="object"?v.groupOverridesByCategoryFamily:{},v.groupHiddenByCategoryFamily[l]=v.groupHiddenByCategoryFamily[l]||{},v.groupHiddenByCategoryFamily[l][b]=v.groupHiddenByCategoryFamily[l][b]||{info:[],customer:[]};const A=e==="customer"?"customer":"info",B=Array.isArray(v.groupHiddenByCategoryFamily[l][b][A])?v.groupHiddenByCategoryFamily[l][b][A]:[];B.includes(g)||B.push(g),v.groupHiddenByCategoryFamily[l][b][A]=B,v.groupOverridesByCategoryFamily[l]=v.groupOverridesByCategoryFamily[l]||{},v.groupOverridesByCategoryFamily[l][b]=v.groupOverridesByCategoryFamily[l][b]||{info:{},customer:{}};const q=v.groupOverridesByCategoryFamily[l][b][A];return q&&typeof q=="object"&&delete q[g],v}),O(v=>{const A={...v},B=n.schemaKey||n.id;return delete A[B],A}))},mr=async()=>{var ue,re;const e=await Pe(),n=oe.scope,g=String(oe.label||"").trim();if(!g){je("Group name is required.");return}const v=oe.mode==="multi"?"multi":"single",A=oe.optionsSource==="familyModels"?"familyModels":"static",B=A==="familyModels"?[]:dr(oe.optionsText);if(n==="info"&&A!=="familyModels"&&B.length===0){je("Add at least one option (comma or new line).");return}const q=!oe.id,D=oe.id||`og_${Date.now()}`,me=q?D:(ue=(e[n]||[]).find(G=>String(G.id)===String(D)))==null?void 0:ue.schemaKey,Y={id:D,label:g,schemaKey:me||D,fieldType:"select",options:B,optionsSource:A,mode:v};if(n==="customer"){const G=q?"":(re=(e.customer||[]).find(ne=>ne&&String(ne.id)===String(D)))==null?void 0:re.key;Y.key=String(G||"").trim()||pt(g,D)}if(q){const ne=[...n==="customer"?e.customer||[]:e.info||[],Y];if(n==="customer"&&v==="multi"&&ne.filter(De=>I(De==null?void 0:De.mode)).length>2){je("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}const Re=n==="customer"?{...e,customer:ne}:{...e,info:ne};await ge(Re)}else{if(n==="customer"&&v==="multi"&&(Array.isArray(K.customer)?K.customer:[]).map(le=>String(le.id)===String(D)?{...le,...Y}:le).filter(le=>I(le==null?void 0:le.mode)).length>2){je("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}await We(G=>{G.groupOverridesByCategoryFamily=G.groupOverridesByCategoryFamily&&typeof G.groupOverridesByCategoryFamily=="object"?G.groupOverridesByCategoryFamily:{},G.groupHiddenByCategoryFamily=G.groupHiddenByCategoryFamily&&typeof G.groupHiddenByCategoryFamily=="object"?G.groupHiddenByCategoryFamily:{},G.groupOverridesByCategoryFamily[l]=G.groupOverridesByCategoryFamily[l]||{},G.groupOverridesByCategoryFamily[l][b]=G.groupOverridesByCategoryFamily[l][b]||{info:{},customer:{}};const ne=n==="customer"?"customer":"info";G.groupOverridesByCategoryFamily[l][b][ne]=G.groupOverridesByCategoryFamily[l][b][ne]||{},G.groupOverridesByCategoryFamily[l][b][ne][String(D)]=Y,G.groupHiddenByCategoryFamily[l]=G.groupHiddenByCategoryFamily[l]||{},G.groupHiddenByCategoryFamily[l][b]=G.groupHiddenByCategoryFamily[l][b]||{info:[],customer:[]};const Re=Array.isArray(G.groupHiddenByCategoryFamily[l][b][ne])?G.groupHiddenByCategoryFamily[l][b][ne]:[];return G.groupHiddenByCategoryFamily[l][b][ne]=Re.filter(le=>String(le)!==String(D)),G})}ae(null)},_r=({f:e})=>{var v,A;if(!e)return null;const n="mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500",g="w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand";if(e.type==="select")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:n},e.label),React.createElement("select",{value:(v=w[e.key])!=null?v:"",onChange:B=>de(e.key,B.target.value),className:g},(e.options||[]).map(B=>React.createElement("option",{key:B,value:B},B))));if(e.type==="text"||e.type==="number")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:n},e.label),React.createElement("input",{type:e.type,value:(A=w[e.key])!=null?A:"",onChange:B=>de(e.key,e.type==="number"?B.target.value.replace(/[^0-9.]/g,""):B.target.value),placeholder:e.placeholder||"",className:g}));if(e.type==="checkbox")return React.createElement("label",{className:"inline-flex items-center gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:!!w[e.key],onChange:B=>de(e.key,B.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),React.createElement("span",null,e.label));if(e.type==="multiselect"){const B=e.options||[],q=Array.isArray(w[e.key])?w[e.key]:[];return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},e.label),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>de(e.key,B),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>de(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},B.map(D=>{const me=q.includes(D),Y=Ze[D]!==void 0||/color/i.test(e.label);return React.createElement("button",{type:"button",key:D,onClick:()=>Te(e.key,D),className:z("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",me?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y?React.createElement(React.Fragment,null,React.createElement(Se,{name:D}),D):D)})))}if(e.type==="phoneModels"){const B=m,q=Array.isArray(w[e.key])?w[e.key]:[];return React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-xs text-slate-500"},React.createElement("span",{className:"font-semibold text-slate-800"},`${(i==null?void 0:i.name)||"Phone"} models`),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{type:"button",onClick:()=>de(e.key,B),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>de(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},B.map(D=>{const me=q.includes(D),Y=String(D).startsWith("iPhone ")?String(D).replace("iPhone ",""):D;return React.createElement("button",{type:"button",key:D,onClick:()=>{const ue=Array.isArray(w[e.key])?w[e.key]:[];de(e.key,me?ue.filter(re=>re!==D):[...ue,D])},className:z("rounded-full border px-2.5 py-1 font-medium transition",me?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y)})))}return null},Ye=e=>e.schemaKey||e.id,Vt=e=>e?e.optionsSource==="familyModels"?m:Array.isArray(e.options)?e.options:[]:[],ur=()=>{const e=qe[l]||{must:[],also:[],optional:[],name:null,specs:null},n=e.name&&e.name(w)||`${l} item`,g=c.trim()||n,v={};(K.customer||[]).forEach(re=>{if(!re)return;const G=re.key||pt(re.label,re.schemaKey||re.id),ne=Ye(re),Re=w[ne];if($(re)){const De=Array.isArray(Re)?Re.map(fr=>String(fr).trim()).filter(Boolean):[];De.length&&(v[G]=Array.from(new Set(De)));return}const le=String(Re||"").trim();le&&(v[G]=[le])});const A=(e.specs&&e.specs(w)||[]).filter(Boolean),B=[];(K.info||[]).forEach(re=>{if(!re)return;const G=Ye(re);if(re.fieldType==="checkbox"){w[G]&&B.push(re.label);return}if($(re)){(Array.isArray(w[G])?w[G].map(le=>String(le).trim()).filter(Boolean):[]).forEach(le=>B.push(le));return}const ne=String(w[G]||"").trim();ne&&B.push(ne)});const q=String((i==null?void 0:i.name)||"").trim(),me=[...q?[`${ut}${q}`]:[],...Array.from(new Set([...A,...B])).slice(0,6)],Y=Array.from(new Set((T||[]).filter(Boolean))),ue={id:`owner-${Date.now()}`,name:g,sku:_.trim()||`SKU-${(Math.random()*1e6|0).toString(36)}`,category:l,price:Number(S)||0,description:U.trim(),image:Y[0]||void 0,images:Y.length?Y:void 0,specs:me,variants:v};return ie(ue)},pr=()=>{var B;const e=[],n=qe[l]||{must:[]},g=Number(S);(!Number.isFinite(g)||g<=0)&&e.push("Price must be greater than 0");const v=(K.customer||[]).find(q=>q&&(q.key==="Model"||q.schemaKey==="models"));if(v){const q=Ye(v),D=w[q];$(v)?(Array.isArray(D)?D:[]).length===0&&e.push("Please select at least one model"):String(D||"").trim()||e.push("Please select a model")}const A=(n.must||[]).find(q=>q.key==="model");return A&&(String((B=w[A.key])!=null?B:"").trim()||e.push("Model is required")),e},br=async()=>{const e=pr();if(e.length){y(e),k(null);return}const n=ur();if(n){C(!0);try{const g=await a(n),v=!!(g&&g.persisted);y([]),v?k({type:"success",message:"Product added to catalogue."}):(k({type:"warning",message:"Product saved locally. Supabase sync pending."}),r==null||r("warning","Supabase connection unavailable. Product stored locally until sync succeeds.")),u(`${l} \u2014 `),P(""),N(""),W(""),h([]),O({})}catch(g){console.error("Failed to add product:",g),k({type:"error",message:"Could not save product. Check your connection and try again."}),r==null||r("error","Could not add product. Check your connection and try again.")}finally{C(!1)}}};return React.createElement("section",{"aria-labelledby":"owner-title",className:"mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-8"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 sm:p-8 shadow-soft-xl"},React.createElement("div",{className:"space-y-2"},React.createElement("h2",{id:"owner-title",className:"text-2xl font-semibold text-slate-900"},"Owner \u2014 Add products"),React.createElement("p",{className:"text-sm text-slate-600"},"Only essentials. Fields shift by category. Keep data clean; the catalogue updates instantly.")),H&&React.createElement("div",{className:z("rounded-2xl border px-4 py-3 text-sm shadow-sm",H.type==="error"?"border-rose-200 bg-rose-50/80 text-rose-700":H.type==="warning"?"border-amber-200 bg-amber-50/80 text-amber-700":"border-emerald-200 bg-emerald-50/80 text-emerald-700")},H.message),L.length>0&&React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700 shadow-sm"},React.createElement("p",{className:"font-semibold"},"Please fix the following:"),React.createElement("ul",{className:"mt-1 list-disc space-y-0.5 pl-4"},L.map((e,n)=>React.createElement("li",{key:n},e)))),React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Essentials"),React.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family"),React.createElement("button",{type:"button",onClick:rr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:b,onChange:e=>{y([]),k(null),f(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},(d||[]).map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Category"),React.createElement("button",{type:"button",onClick:sr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:l,onChange:e=>{y([]),k(null),x(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},s.map(e=>React.createElement("option",{key:e,value:e},e)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:S,onChange:e=>{y([]),k(null),N(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Name"),React.createElement("input",{value:c,onChange:e=>{y([]),k(null),u(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"SKU"),React.createElement("input",{value:_,onChange:e=>{y([]),k(null),P(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"md:col-span-2 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Short description"),React.createElement("textarea",{rows:3,value:U,onChange:e=>{y([]),k(null),W(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:Le}),T.length>0&&React.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},T.map((e,n)=>React.createElement("div",{key:n,className:"relative"},React.createElement("img",{src:e,alt:`preview ${n+1}`,className:"h-20 w-20 overflow-hidden rounded-xl border border-[var(--surface-border)] object-cover"}),React.createElement("button",{type:"button",onClick:()=>{y([]),k(null),h(g=>g.filter((v,A)=>A!==n))},className:"absolute -right-1 -top-1 rounded-full border border-[var(--surface-border)] bg-white px-1 text-xs shadow","aria-label":`Remove photo ${n+1}`},"\xD7"))))))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Product information"),React.createElement("button",{type:"button",onClick:()=>qt("info"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(K.info||[]).map(e=>{const n=Ye(e);return React.createElement(Na,{key:e.id,label:e.label,mode:e.mode,fieldType:e.fieldType,options:Vt(e),value:w[n],onChange:g=>de(n,g),onEdit:()=>Yt("info",e),onRemove:()=>Qt("info",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Customer options"),React.createElement("button",{type:"button",onClick:()=>qt("customer"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(K.customer||[]).map(e=>{const n=Ye(e);return React.createElement(ka,{key:e.id,label:e.label,mode:e.mode,options:Vt(e),value:w[n],onChange:g=>de(n,g),onEdit:()=>Yt("customer",e),onRemove:()=>Qt("customer",e)})}))),React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end"},React.createElement("button",{type:"button",onClick:br,disabled:p,className:z("inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",p?"bg-brand/50 cursor-not-allowed opacity-70":"bg-brand hover:bg-brand-muted")},p?"Saving...":"Add Product"),React.createElement("button",{type:"button",onClick:()=>{var e;return(e=window.__setOwnerManage)==null?void 0:e.call(window,!0)},className:"inline-flex items-center justify-center rounded-full border border-[var(--surface-border)] bg-white/70 px-6 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage catalogue")),React.createElement(yt,{open:(ve==null?void 0:ve.type)==="group",title:oe.id?"Edit option group":"Add option group",onClose:()=>ae(null),actions:React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:()=>ae(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Cancel"),React.createElement("button",{type:"button",onClick:mr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Save"))},Ht&&React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},Ht),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Group name"),React.createElement("input",{value:oe.label,onChange:e=>Oe(n=>({...n,label:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Selection"),React.createElement("select",{value:oe.mode,onChange:e=>Oe(n=>({...n,mode:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"single"},"Single"),React.createElement("option",{value:"multi"},"Multi"))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options source"),React.createElement("select",{value:oe.optionsSource,onChange:e=>Oe(n=>({...n,optionsSource:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"static"},"Custom list"),oe.scope==="customer"&&React.createElement("option",{value:"familyModels"},"Use family models")))),oe.optionsSource!=="familyModels"&&React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options (comma or new line)"),React.createElement("textarea",{rows:6,value:oe.optionsText,onChange:e=>Oe(n=>({...n,optionsText:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Option 1, Option 2, Option 3\\nOption 4"}))),React.createElement(yt,{open:(ve==null?void 0:ve.type)==="category",title:"Manage categories",onClose:()=>ae(null),actions:React.createElement("button",{type:"button",onClick:()=>ae(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-end gap-2"},React.createElement("label",{className:"flex-1 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"New category"),React.createElement("input",{value:zt,onChange:e=>ht(e.target.value),placeholder:"e.g. Camera parts",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("button",{type:"button",onClick:nr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Add")),React.createElement("div",{className:"space-y-2"},(s||[]).map(e=>React.createElement("div",{key:e,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{x(e),ae(null)},className:z("flex-1 text-left font-medium",e===l?"text-slate-900":"text-slate-700")},e),React.createElement("button",{type:"button",onClick:()=>or(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove category ${e}`},"\xD7")))))),React.createElement(yt,{open:(ve==null?void 0:ve.type)==="family",title:"Manage families",onClose:()=>ae(null),actions:React.createElement("button",{type:"button",onClick:()=>ae(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"space-y-2"},React.createElement("p",{className:"text-sm text-slate-600"},"Families control which model list appears in the phone model picker."),React.createElement("div",{className:"space-y-2"},(d||[]).map(e=>React.createElement("div",{key:e.id,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{f(e.id),ae(null)},className:z("flex-1 text-left font-medium",e.id===b?"text-slate-900":"text-slate-700")},e.name),React.createElement("button",{type:"button",onClick:()=>lr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:()=>cr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove family ${e.name}`},"\xD7"))))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h4",{className:"text-sm font-semibold text-slate-900"},Ee.id?"Edit family":"Add family"),Ee.id&&React.createElement("button",{type:"button",onClick:()=>Fe({id:null,name:"",modelsText:""}),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"New")),React.createElement("div",{className:"mt-3 space-y-3"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family name"),React.createElement("input",{value:Ee.name,onChange:e=>Fe(n=>({...n,name:e.target.value})),placeholder:"e.g. Samsung S",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Models (one per line)"),React.createElement("textarea",{rows:6,value:Ee.modelsText,onChange:e=>Fe(n=>({...n,modelsText:e.target.value})),placeholder:"iPhone 11\\niPhone 12\\n...",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex justify-end"},React.createElement("button",{type:"button",onClick:ir,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},Ee.id?"Save changes":"Add family"))))))))}function Gt({label:a,options:r,value:t,onChange:o}){const s=()=>o(r),d=()=>o([]),l=x=>o(t.includes(x)?t.filter(b=>b!==x):[...t,x]);return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:s,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},r.map(x=>{const b=t.includes(x),f=/color/i.test(a)||Ze[x]!==void 0;return React.createElement("button",{type:"button",key:x,onClick:()=>l(x),className:z("rounded-full border px-2 py-1 text-xs",b?"border-transparent bg-brand text-white":"border-[var(--surface-border)] bg-white text-slate-700")},f?React.createElement(React.Fragment,null,React.createElement(Se,{name:x})," ",x):x)})))}function Za({open:a,onClose:r,product:t,onSave:o,onHide:s,onDelete:d}){var w,O,I,$,te;const l=X(null);et(!!a,l,r);const[x,b]=E((t==null?void 0:t.name)||""),[f,i]=E((t==null?void 0:t.sku)||""),[m,c]=E(String((w=t==null?void 0:t.price)!=null?w:0)),[u,_]=E((t==null?void 0:t.description)||""),[P,S]=E(()=>[...Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[]]),[N,U]=E(0),[W,T]=E(()=>{const R={...(t==null?void 0:t.variants)||{}};return R.Color&&!Array.isArray(R.Color)&&(R.Color=[R.Color]),R.Model&&!Array.isArray(R.Model)&&(R.Model=[R.Model]),R});M(()=>{var F;if(!a)return;b((t==null?void 0:t.name)||""),i((t==null?void 0:t.sku)||""),c(String((F=t==null?void 0:t.price)!=null?F:0)),_((t==null?void 0:t.description)||"");const R=Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[];S([...R]),U(0),T({...(t==null?void 0:t.variants)||{}})},[a,t]);const h=R=>{const F=Array.from(R.target.files||[]);if(!F.length)return;const V=F.map(Z=>new Promise(se=>{const ce=new FileReader;ce.onload=()=>se(String(ce.result||"")),ce.readAsDataURL(Z)}));Promise.all(V).then(Z=>S(se=>[...se,...Z]))},L=()=>U(R=>(R-1+P.length)%P.length),y=()=>U(R=>(R+1)%P.length),H=()=>{const R=Object.fromEntries(Object.entries(W||{}).map(([ce,de])=>{const Te=Array.isArray(de)?de.map(Le=>String(Le).trim()).filter(Boolean):[];return[ce,Array.from(new Set(Te))]}).filter(([,ce])=>Array.isArray(ce)&&ce.length)),F=x.trim()||t.name,V=f.trim()||t.sku,Z=Number(m),se=ie({...t||{},name:F,sku:V,price:Number.isFinite(Z)&&Z>0?Z:Number(t.price)||0,description:u,images:P.length?P:void 0,image:P[0]||void 0,variants:R});o(se,t==null?void 0:t.id),r()},k=!!((I=(O=t==null?void 0:t.id)==null?void 0:O.startsWith)!=null&&I.call(O,"owner-")),p=Array.from(new Set([...W.Model||[]])),C=Array.from(new Set([...W.Color||[]]));return!a||!t?null:React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-0 sm:p-6",role:"dialog","aria-modal":"true"},React.createElement("div",{ref:l,className:"w-full sm:max-w-3xl rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none max-h-[90vh] overflow-y-auto"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},"Edit product"),React.createElement("div",{className:"flex items-center gap-2"},!k&&React.createElement("button",{onClick:()=>{s(t.id),r()},className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Hide base"),k&&React.createElement("button",{onClick:()=>{d(t.id),r()},className:"rounded-full border border-rose-300 bg-rose-50/80 px-3.5 py-1.5 text-sm font-semibold text-rose-700 transition hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-400"},"Delete"),React.createElement("button",{onClick:r,className:"rounded-full px-3.5 py-1.5 text-sm font-semibold text-slate-500 transition hover:bg-white/70 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Close"))),React.createElement("div",{className:"grid gap-4 p-4 sm:grid-cols-2"},React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-xl bg-slate-100"},React.createElement("img",{src:ze(P[N]||"",t.name),onError:R=>{R.currentTarget.src=Ae(t.name)},alt:`${t.name} \u2013 photo ${N+1} of ${P.length}`,className:"h-full w-full object-cover"}),P.length>1&&React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:L,className:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Previous photo"},"\u2039"),React.createElement("button",{type:"button",onClick:y,className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Next photo"},"\u203A"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"text-xs text-slate-700 inline-flex items-center gap-2"},React.createElement("span",{className:"rounded-full border border-[var(--surface-border)] bg-white px-2 py-1"},"Add photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:h,className:"sr-only"}))),P.length>0&&React.createElement("div",{className:"flex gap-2 overflow-x-auto"},P.map((R,F)=>React.createElement("div",{key:F,className:z("relative h-14 w-20 flex-shrink-0 overflow-hidden rounded-md border",F===N?"border-brand":"border-[var(--surface-border)]")},React.createElement("button",{type:"button",onClick:()=>U(F),className:"absolute inset-0"},React.createElement("img",{src:ze(R,t.name),alt:"",className:"h-full w-full object-cover"})),React.createElement("button",{type:"button",onClick:()=>S(V=>V.filter((Z,se)=>se!==F)),className:"absolute -right-1 -top-1 rounded-full bg-white border p-0.5 shadow","aria-label":`Remove photo ${F+1}`},"\xD7"))))),React.createElement("div",{className:"flex min-w-0 flex-col gap-3"},React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Name"),React.createElement("input",{value:x,onChange:R=>b(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"SKU"),React.createElement("input",{value:f,onChange:R=>i(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:m,onChange:R=>c(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Description"),React.createElement("textarea",{rows:3,value:u,onChange:R=>_(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid gap-3"},!!(($=t==null?void 0:t.variants)!=null&&$.Model)&&React.createElement(Gt,{label:"Models",options:[...Me,...dt,...mt],value:p,onChange:R=>T(F=>({...F,Model:R}))}),!!((te=t==null?void 0:t.variants)!=null&&te.Color)&&React.createElement(Gt,{label:"Colors",options:Ke,value:C,onChange:R=>T(F=>({...F,Color:R}))}),Object.entries((t==null?void 0:t.variants)||{}).filter(([R])=>R!=="Model"&&R!=="Color").map(([R,F])=>React.createElement("div",{key:R,className:"text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},R),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(W[R]||F).map(V=>React.createElement("span",{key:V,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-1 text-xs font-medium text-slate-600"},V,React.createElement("button",{type:"button",onClick:()=>T(Z=>({...Z,[R]:(Z[R]||F).filter(se=>se!==V)})),"aria-label":`Remove ${V}`},"\xD7")))),React.createElement("div",{className:"mt-1 flex gap-2"},React.createElement("input",{type:"text",placeholder:`Add ${R} option`,className:"w-44 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-medium text-slate-700 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onKeyDown:V=>{if(V.key==="Enter"){const Z=V.currentTarget.value.trim();Z&&T(se=>({...se,[R]:Array.from(new Set([...se[R]||F,Z]))})),V.currentTarget.value=""}}}),React.createElement("button",{type:"button",className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onClick:V=>{const Z=V.currentTarget.previousSibling;if(Z&&Z.value){const se=Z.value.trim();T(ce=>({...ce,[R]:Array.from(new Set([...ce[R]||F,se]))})),Z.value=""}}},"Add"))))),React.createElement("div",{className:"mt-2 flex justify-end gap-3"},React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm text-slate-900 hover:bg-white/70"},"Cancel"),React.createElement("button",{onClick:H,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition hover:bg-brand-muted"},"Save changes"))))))}function Xa({products:a,onClose:r,onEdit:t,onHide:o,onDelete:s,onSave:d}){const[l,x]=E(""),[b,f]=E(null),i=J(()=>{let m=a;if(l){const c=l.toLowerCase();m=m.filter(u=>u.name.toLowerCase().includes(c)||u.sku.toLowerCase().includes(c)||(u.description||"").toLowerCase().includes(c))}return m},[a,l]);return React.createElement("section",{"aria-labelledby":"mgr-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 shadow-soft-xl sm:p-8"},React.createElement("div",{className:"sticky top-[calc(var(--header-offset,64px)+12px)] z-10 rounded-2xl border border-[var(--surface-border)] bg-white/90 px-4 py-3 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},React.createElement("h2",{id:"mgr-title",className:"text-base sm:text-lg font-semibold text-slate-900"},"Owner \u2014 Manage catalogue"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"relative flex-1 sm:w-auto"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:l,onChange:m=>x(m.target.value),placeholder:"Search\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-medium text-slate-600 shadow-inner placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"}),React.createElement(gt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Back")))),React.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},(i||[]).map(m=>React.createElement("article",{key:m.id,className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white transition hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full bg-slate-100"},React.createElement("img",{src:ze(Array.isArray(m.images)&&m.images[0]||m.image||"",m.name),onError:c=>{c.currentTarget.src=Ae(m.name)},alt:m.name,className:"h-full w-full object-cover"})),React.createElement("div",{className:"flex flex-1 flex-col gap-3 p-4"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},m.name),React.createElement("p",{className:"mt-0.5 text-xs text-slate-500"},"SKU: ",m.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(m.specs||[]).slice(0,4).map(c=>React.createElement("span",{key:c,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 text-xs font-medium text-slate-600"},c))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"font-semibold text-slate-900"},he(m.price)),m.minOrder&&React.createElement("span",{className:"text-xs text-slate-500"},"MOQ ",m.minOrder)),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>f(m),className:"flex-1 rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted"},"Edit"),m.id.startsWith("owner-")?React.createElement("button",{onClick:()=>s(m.id),className:"rounded-full border border-red-300 bg-white px-3 py-2 text-sm text-red-700 hover:bg-red-50"},"Delete"):React.createElement("button",{onClick:()=>o(m.id),className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white/90"},"Hide"))))))),React.createElement(Za,{open:!!b,onClose:()=>f(null),product:b,onSave:d,onHide:o,onDelete:s}))}function er(){const a=React.useRef(0),[r,t]=E(""),[o,s]=E("All"),[d,l]=E(null),[x,b]=E(!1),[f,i]=E("dashboard"),[m,c]=E(st&&Be),u=Ce?!0:Be?m:!1,_=Ca(),P=ke?c:()=>{};M(()=>{u||i("dashboard")},[u]);const[S,N]=E(null),U=X(null),W=(j,Q)=>{Q&&(N({type:j,message:Q}),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>N(null),4e3))};M(()=>()=>{U.current&&clearTimeout(U.current)},[]);const{ownerProducts:T,setOwnerProducts:h,addProduct:L,deleteProduct:y,loading:H,connectionStatus:k}=Aa(),{catalogConfig:p,saveCatalogConfig:C}=Sa(T,h),{orders:w,loadingOrders:O,ordersError:I,ordersMeta:$,refreshOrders:te,updateOrderStatus:R}=Pa();Ra(!!(d||x),a);const V=J(()=>{const j=new Map(va.map(K=>[K.id,K])),Q=[];return T.forEach(K=>{if(!(K&&K.id===Ve)){if(K.sourceId&&j.has(K.sourceId)){if(K.hidden){j.delete(K.sourceId);return}j.delete(K.sourceId)}K.hidden||(K.sourceId?j.set(K.id,K):Q.push(K))}}),[...Q,...Array.from(j.values())]},[T]),Z=J(()=>{let j=V;return o!=="All"&&(j=j.filter(Q=>Q.category===o)),r&&(j=j.filter(Q=>Q.name.toLowerCase().includes(r.toLowerCase())||Q.sku.toLowerCase().includes(r.toLowerCase())||(Q.description||"").toLowerCase().includes(r.toLowerCase()))),j},[V,o,r]);M(()=>(window.__setOwnerManage=j=>{i(j?"manage":"dashboard")},()=>{window.__setOwnerManage=void 0}),[]);const se=j=>h(Q=>{const K=Q.findIndex(ge=>ge.id===j.id);if(K>=0){const ge=[...Q];return ge[K]=j,ge}return[...Q,j]}),ce=async(j,Q)=>{var ae,oe;const K=(oe=(ae=j.id)==null?void 0:ae.startsWith)==null?void 0:oe.call(ae,"owner-"),ge=ie(K?j:{...j,id:`owner-${Date.now()}`,sourceId:Q}),Pe=await it(ge);se(Pe||ge),Pe?W("success","Product updated."):W("warning","Product updated locally. Supabase sync pending.")},de=async j=>{const Q=ie({id:`owner-hide-${Date.now()}`,sourceId:j,hidden:!0,name:"",sku:"",category:"All",price:0,description:"",specs:[]}),K=await it(Q);se(K||Q),K?W("success","Base product hidden."):W("warning","Base product hidden locally. Supabase sync pending.")},Te=async j=>{const Q=await y(j);return Q?W("success","Product deleted."):W("error","Could not delete product. Check your connection and try again."),Q},Le=J(()=>React.createElement(Fa,{allProducts:V,ownerProducts:T,orders:w,loadingOrders:O,ordersMeta:$,ordersError:I,onNavigate:i,refreshOrders:te}),[V,T,w,O,$,I,te]),ye=J(()=>[{id:"dashboard",label:"Dashboard",description:"Key metrics & recents",icon:Ia,element:Le},{id:"add",label:"Add product",description:"Create new catalogue items",icon:Ta,element:React.createElement(Ja,{addProduct:L,onNotify:W,onNavigate:i,catalogConfig:p,saveCatalogConfig:C})},{id:"manage",label:"Manage catalogue",description:"Edit overrides & hide base items",icon:La,element:React.createElement(Xa,{products:V,onClose:()=>i("add"),onEdit:j=>l({__edit:!0,product:j}),onHide:j=>de(j),onDelete:j=>Te(j),onSave:ce})},{id:"orders",label:"Orders",description:"Track open, confirmed & shipped",icon:ja,element:React.createElement(Wa,{orders:w,loading:O,error:I,meta:$,onRefresh:te,onStatusChange:R,onNotify:W})}],[Le,V,T,w,O,I,$,te,R,Te,de,ce,i,W,L,p,C]),qe=_.items.reduce((j,Q)=>j+(Number(Q.qty)||0),0);return H?React.createElement("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center"},React.createElement("div",{className:"text-center"},React.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),React.createElement("p",{className:"text-slate-600"},"Loading products..."))):React.createElement("div",{className:"min-h-screen bg-slate-50"},React.createElement(Ua),S&&React.createElement("div",{className:z("fixed bottom-4 right-4 z-40 max-w-sm rounded-lg border px-4 py-3 text-sm shadow-lg backdrop-blur",S.type==="error"?"border-red-200 bg-red-50/90 text-red-700":S.type==="warning"?"border-amber-200 bg-amber-50/90 text-amber-800":"border-emerald-200 bg-emerald-50/90 text-emerald-700")},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("span",{className:"flex-1 leading-snug"},S.message),React.createElement("button",{type:"button",onClick:()=>N(null),className:"text-xs font-medium uppercase tracking-wide text-slate-500 hover:text-slate-700"},"Dismiss"))),React.createElement($a,{onOpenCart:()=>{a.current=window.scrollY||0,b(!0)},search:r,setSearch:t,ownerMode:u,setOwnerMode:P,cartQty:qe,connectionStatus:k,allowOwnerToggle:ke}),u?React.createElement(Da,{views:ye,section:f,onSectionChange:i}):React.createElement(React.Fragment,null,React.createElement(Ga),React.createElement(Ha,{active:o,setActive:s}),React.createElement(Ka,{products:Z,onOpen:j=>{a.current=window.scrollY||0,l(j&&j.__edit&&j.product?j.product:j)}})),React.createElement(qa,{product:d,onClose:()=>{l(null)},onAdd:_.add}),React.createElement(Qa,{open:x,onClose:()=>b(!1),cart:_}))}ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(er))},Xt=E=>{const M=document.createElement("div");M.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",M.innerHTML=`
          <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
            <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
            <p style="margin:0 0 16px;font-size:14px;color:#4B5563;">Sign in to manage the catalogue.</p>
            <form style="display:flex;flex-direction:column;gap:12px;">
              <input name="email" type="email" autocomplete="email" placeholder="Email" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <input name="password" type="password" autocomplete="current-password" placeholder="Password" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <div data-status style="min-height:18px;font-size:13px;color:#DC2626;"></div>
              <button type="submit" style="border:none;border-radius:8px;background:#4F46E5;color:white;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign in</button>
              <button type="button" data-signout style="display:none;border:1px solid #D1D5DB;border-radius:8px;background:white;color:#111827;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign out</button>
            </form>
            <p style="margin:16px 0 0;font-size:12px;color:#6B7280;line-height:1.4;">
              This page requires Supabase Auth + owner-only RLS. If you haven't yet, run <code>supabase-owner-rls.sql</code> in Supabase, then add your Auth user UUID to <code>public.owner_users</code>.
            </p>
          </div>
        `,document.body.appendChild(M);const X=M.querySelector("form"),J=M.querySelector("input[name=email]"),Ue=M.querySelector("input[name=password]"),at=M.querySelector("[data-status]"),$e=M.querySelector("[data-signout]");J.focus();const be=pe=>{at.textContent=pe||""},rt=pe=>{const we=X.querySelector("button[type=submit]");we.disabled=pe,we.style.opacity=pe?"0.7":"1",we.textContent=pe?"Signing in...":"Sign in"};$e.addEventListener("click",async()=>{try{await E.auth.signOut()}catch(pe){}$e.style.display="none",be("Signed out.")}),X.addEventListener("submit",async pe=>{var we,Ne,Ce,Be;pe.preventDefault(),be(""),rt(!0);try{const ke=String(J.value||"").trim(),st=String(Ue.value||""),{data:Ge,error:Qe}=await E.auth.signInWithPassword({email:ke,password:st});if(Qe)throw Qe;const ee=await wt(E);if(ee===!0){M.remove(),Et();return}const nt=((we=Ge==null?void 0:Ge.user)==null?void 0:we.id)||((Be=(Ce=(Ne=await E.auth.getUser())==null?void 0:Ne.data)==null?void 0:Ce.user)==null?void 0:Be.id);$e.style.display="block",be(ee===!1?`Signed in, but not an owner. User ID: ${nt||"(unknown)"}`:"Signed in, but owner check failed. Ensure public.is_owner() exists and you are listed in public.owner_users.")}catch(ke){be((ke==null?void 0:ke.message)||"Sign-in failed.")}finally{rt(!1),Ue.value=""}})};(async()=>{const E=Zt();if(!E){const M=document.createElement("div");M.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",M.innerHTML=`
            <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
              <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
              <p style="margin:0;font-size:14px;color:#4B5563;">Supabase is not configured. Ensure <code>supabase-config.js</code> is present and loads before this page script.</p>
            </div>
          `,document.body.appendChild(M);return}try{const{data:M}=await E.auth.getSession();if(M==null?void 0:M.session){const J=await wt(E);if(J===!0){Et();return}if(J===!1)try{await E.auth.signOut()}catch(Ue){}}}catch(M){}Xt(E)})()})();})();

(()=>{(()=>{let Bt=!1;const pa=()=>{const w=window.SUPABASE_PUBLIC_CONFIG||{},_=w.url||"",ae=w.anonKey||"";if(!_||!ae||!window.supabase)return null;try{return window.supabase.createClient(_,ae)}catch(X){return console.error("Failed to init Supabase client for auth",X),null}},_t=async w=>{try{const{data:_,error:ae}=await w.rpc("is_owner");if(ae)throw ae;return!!_}catch(_){return console.error("Owner check failed",_),null}},Mt=()=>{if(Bt)return;Bt=!0;const{useState:w,useEffect:_,useRef:ae,useMemo:X,useLayoutEffect:Ke}=React,ct="Odil Accessories",He="Simple wholesale catalogue with WhatsApp ordering.",be="GBP",dt="\xA3",pe="992935563306",ke="nova_wholesale_cart_v1",Pe="nova_owner_products_v1",_e=document.body.dataset.layout==="owner",Te=_e||document.body.dataset.ownerMode!=="disabled",Oe=Te&&!_e,mt=_e||document.body.dataset.defaultOwner==="true",ze="/.netlify/functions/catalogue",Je=be,ee="__base__",ut="__prices",fa=(a,r)=>{const t=(a||r||"").trim();if(!t)return r||"";const o=t.toLowerCase();return o.includes("color")||o.includes("colour")?"Color":r==="models"||o.includes("model")?"Model":t.replace(/\s+/g," ").trim()},ve=(a={})=>{const r=Object.entries(a||{}).filter(([t,o])=>o!=null&&String(o).trim()!=="");return r.length?r.sort(([t],[o])=>t.localeCompare(o)).map(([t,o])=>`${t}:${o}`).join("|"):ee},qe=a=>{if(!a||typeof a!="object")return{};const r={};return Object.entries(a).forEach(([t,o])=>{const n=Number(o);Number.isFinite(n)&&n>=0&&(r[t&&t.trim()||ee]=n)}),r},ya=a=>{const r=Object.entries(a||{}).filter(([n,d])=>Array.isArray(d)&&d.length);if(!r.length)return[{key:ee,selection:{}}];const t=[],o=(n,d)=>{if(n>=r.length){const y=ve(d);t.push({key:y,selection:{...d}});return}const[l,h]=r[n];h.forEach(y=>o(n+1,{...d,[l]:y}))};return o(0,{}),t},Tr=(a,r)=>{const t=[...r.must||[],...r.also||[],...r.optional||[]],o={};return t.forEach(n=>{const d=a[n.key],l=fa(n.label,n.key);if(n.type==="checkbox"){d&&(o[l]=["Yes"]);return}if(d==null)return;if(Array.isArray(d)){const y=d.map(g=>String(g).trim()).filter(Boolean);y.length&&(o[l]=Array.from(new Set(y)));return}const h=String(d).trim();h&&(o[l]=[h])}),o},It=window.SUPABASE_PUBLIC_CONFIG||{},pt=It.url||"",jt=It.anonKey||"",ga=!!(pt&&jt);let fe=null;try{window.supabase&&ga?(fe=window.supabase.createClient(pt,jt),console.log("\u2705 Supabase client initialized successfully"),console.log("\u{1F4CD} Supabase URL:",pt),setTimeout(async()=>{try{console.log("\u{1F504} Testing database connection...");const{data:r,error:t}=await fe.from("products").select("count").limit(1);t?(console.error("\u274C Database test failed:",t),t.message.includes("permission denied")&&console.error("\u{1F6AB} RLS Policy Issue: Run the SQL script to fix permissions"),t.message.includes('relation "products" does not exist')&&console.error("\u{1F3D7}\uFE0F Table Missing: Run the SQL script to create the products table")):console.log("\u2705 Database connection successful"),console.log("\u{1F504} Testing realtime connection...");const o=fe.channel("test-channel");o.subscribe(n=>{n==="SUBSCRIBED"?(console.log("\u2705 Realtime connection successful"),o.unsubscribe()):n==="CHANNEL_ERROR"&&console.error("\u274C Realtime connection failed")})}catch(r){console.error("\u274C Connection test failed:",r)}},1e3)):console.warn("\u26A0\uFE0F Supabase not initialized - supply SUPABASE_PUBLIC_CONFIG in supabase-config.js")}catch(a){console.error("\u274C Supabase initialization failed:",a)}const bt=async(a,r=3,t=1e3)=>{for(let o=1;o<=r;o++)try{return await a()}catch(n){if(console.warn(`\u26A0\uFE0F Attempt ${o}/${r} failed:`,n.message),o===r)throw n;await new Promise(d=>setTimeout(d,t*o))}},xa=async()=>{var a;try{if(!fe)return null;const{data:r}=await fe.auth.getSession(),t=(a=r==null?void 0:r.session)==null?void 0:a.access_token;return t?`Bearer ${t}`:null}catch(r){return null}},Le=async(a,r)=>{try{const t=await xa(),o=await fetch(ze,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:t}:{}},body:JSON.stringify({action:a,data:r})});if(!o.ok){const d=await o.text().catch(()=>"");throw new Error(`Owner API ${a} failed: ${o.status} ${d}`)}const n=await o.json().catch(()=>({}));if(n!=null&&n.error){const d=new Error(n.error.message||n.error);throw d.details=n.error.details,d.hint=n.error.hint,d.code=n.error.code,d}return n}catch(t){throw console.error(`Owner API ${a} error`,t),t}},ce=a=>{var W;if(!a)return null;const{sourceid:r,sourceId:t,images:o,image:n,specs:d,variants:l,inventory:h,price:y,hidden:g,...i}=a,m=(W=t!=null?t:r)!=null?W:null,c=j=>Array.isArray(j)?j:j==null?[]:typeof j=="string"&&j.trim().length?[j]:[],u=c(o),M=c(d),O=typeof l=="object"&&l!==null&&!Array.isArray(l)?l:{},A=qe(h),k=n||u[0]||void 0,$=u.length?u:k?[k]:[];return{...i,sourceId:m,images:$,specs:M,variants:O,inventory:A,price:typeof y=="number"?y:Number(y)||0,hidden:!!g,image:k}},Tt=a=>{var n;const r={id:a.id,name:a.name,sku:a.sku,category:a.category,price:Number(a.price)||0,description:(n=a.description)!=null?n:""},t=Array.isArray(a.images)?a.images:a.image?[a.image]:[];t.length&&(r.images=t),Array.isArray(a.specs)&&a.specs.length&&(r.specs=a.specs),a.variants&&Object.keys(a.variants).length&&(r.variants=a.variants),a.sourceId&&(r.sourceid=a.sourceId),a.hidden&&(r.hidden=!0);const o=qe(a.inventory);return Object.keys(o).length&&(r.inventory=o),r},Lt=async()=>{if(!fe)return console.warn("\u26A0\uFE0F Cannot load products: Supabase not initialized"),[];try{console.log("\u{1F504} Loading products from database...");const{data:a,error:r}=await fe.from("products").select("*").order("created_at",{ascending:!1});if(r)throw console.error("\u274C Database error:",r),r;return console.log(`\u2705 Loaded ${(a==null?void 0:a.length)||0} products from database`),(a||[]).map(ce).filter(Boolean)}catch(a){return console.error("Failed to load products:",a),[]}},ha=async a=>{try{const r=Tt(a),{data:t}=await bt(()=>Le("insert",r)),o=ce(t);return console.log("\u2705 Product saved successfully:",o),o}catch(r){return console.error("\u274C Failed to save product after retries:",r),null}},ft=async a=>{try{const r=Tt(a),{data:t}=await bt(()=>Le("upsert",r));return ce(t)}catch(r){return console.error("Failed to upsert product:",r),null}},va=async a=>{try{return await bt(()=>Le("delete",{id:a})),!0}catch(r){return console.error("Failed to delete product:",r),!1}},Lr=a=>{if(!fe)return null;try{return fe.channel("products").on("postgres_changes",{event:"*",schema:"public",table:"products"},a).subscribe()}catch(r){return console.error("Failed to subscribe to product changes:",r),null}},yt=["All","Phone Screens","Back Glass","Power Banks","Screen Protectors","Batteries","Mobile Phones","Tablets","Phone Cases","Cables","Chargers","Earphones","Charging Ports","Face ID"],Fe=["iPhone 11","iPhone 12","iPhone 12 Pro","iPhone 13","iPhone 13 Pro","iPhone 14","iPhone 14 Pro","iPhone 15","iPhone 15 Plus","iPhone 15 Pro","iPhone 15 Pro Max","iPhone 16","iPhone 16 Pro","iPhone 16 Pro Max"],Ft=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],Fr=[...Fe,...Ft],gt=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],xt=["Galaxy A14","Galaxy A24","Galaxy A34","Galaxy A54","Galaxy A55","Galaxy A15"],Wr=["iPhone","Samsung S","Samsung A"],Dr={iPhone:Fe,"Samsung S":gt,"Samsung A":xt},Ze="__catalog_config__",wa="__",ht="__family:",Ur=a=>(Array.isArray(a)?a:[]).filter(r=>{const t=String(r||"");return t&&!t.startsWith(wa)}),$r=a=>{const t=(Array.isArray(a==null?void 0:a.specs)?a.specs:[]).find(o=>typeof o=="string"&&o.startsWith(ht));return t?String(t).slice(ht.length).trim():""},vt=(a,r)=>{var o,n;if(r==="models")return"Model";const t=String((o=a!=null?a:r)!=null?o:"").toLowerCase().trim();return t==="color"||t==="colors"||t==="colour"?"Color":t==="model"||t==="models"?"Model":String((n=a!=null?a:r)!=null?n:"").trim()},wt=()=>({version:1,categories:yt.filter(a=>a!=="All"),families:[{id:"iphone",name:"iPhone",models:[...Fe]},{id:"samsung_s",name:"Samsung S",models:[...gt]},{id:"samsung_a",name:"Samsung A",models:[...xt]},{id:"accessories",name:"Accessories",models:[]}],groupsByCategory:{},groupOverridesByCategoryFamily:{},groupHiddenByCategoryFamily:{}}),Xe=a=>{const r=wt();if(!a||typeof a!="object")return r;const t={...r,...a};return t.categories=Array.isArray(t.categories)?t.categories.filter(Boolean):r.categories,t.families=Array.isArray(t.families)?t.families.filter(Boolean):r.families,t.groupsByCategory=t.groupsByCategory&&typeof t.groupsByCategory=="object"?t.groupsByCategory:{},t.groupOverridesByCategoryFamily=t.groupOverridesByCategoryFamily&&typeof t.groupOverridesByCategoryFamily=="object"?t.groupOverridesByCategoryFamily:{},t.groupHiddenByCategoryFamily=t.groupHiddenByCategoryFamily&&typeof t.groupHiddenByCategoryFamily=="object"?t.groupHiddenByCategoryFamily:{},t},Wt=["Original","OEM","AAA","Aftermarket","Refurb"],Ea=["TPU","Silicone","PC","Leather"],Ye=["Black","White","Navy","Clear","Red","Lavender","Stone","Midnight","Starlight","Blue","Green","Gold"],et={Black:"#111827",White:"#ffffff",Navy:"#1e3a8a",Clear:"#ffffff",Red:"#ef4444",Lavender:"#b57edc",Stone:"#a8a29e",Midnight:"#0f172a",Starlight:"#f8fafc",Blue:"#3b82f6",Green:"#10b981",Gold:"#f59e0b"};function Me({name:a}){const r=et[a],t=r?{backgroundColor:r,border:"1px solid rgba(0,0,0,.15)"}:{backgroundImage:"linear-gradient(45deg,#e5e7eb 25%,transparent 25%),linear-gradient(-45deg,#e5e7eb 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#e5e7eb 75%),linear-gradient(-45deg,transparent 75%,#e5e7eb 75%)",backgroundSize:"8px 8px",border:"1px solid rgba(0,0,0,.15)"};return React.createElement("span",{"aria-hidden":"true",className:"inline-block h-3 w-3 rounded-full align-[-2px]",style:t})}const Ra=["Tempered","Hydrogel"],Na=["Clear","Matte","Privacy"],ka=["1-Pack","2-Pack"],Ca=["Edge-to-edge","Full glue"],Et=["USB-C \u2194 USB-C","USB-C \u2194 Lightning","USB-A \u2194 Micro-USB"],Dt=["0.5m","1m","2m"],Ut=["27W","60W","100W"],Sa=["MFi","USB-IF"],Aa=["Standard","Braided",">10k bends"],Pa=["20W","30W","45W","65W"],$t=["1\xD7USB-C","1\xD7USB-A","1\xD7USB-C + 1\xD7USB-A","2\xD7USB-C"],We=["PD 3.0","PPS","QC 3.0","QC 4+"],Gr=["CE","UKCA"],Oa=["UK 3-pin","EU","US"],Gt=["New","Refurb","Used A","Used B"],Ba=["Unlocked","Locked","Dual-SIM Yes","Dual-SIM No"],_a=["5G","4G"],Ma=["Wi-Fi","Wi-Fi + Cellular"],Kt=["32GB","64GB","128GB","256GB","512GB","1TB"],Ht=["3GB","4GB","6GB","8GB","12GB","16GB"],Kr=Et,Ia=Dt,Hr=Ut,ja=["10,000 mAh","20,000 mAh"],zt=["open","confirmed","shipped"],Ta=["open","confirmed","shipped","cancelled"],tt={open:"Open",confirmed:"Confirmed",shipped:"Shipped",cancelled:"Cancelled"},La=[{id:"sp-iph-13-tmp-2pk",name:"Tempered Glass \u2013 iPhone 13 (2\u2011Pack)",sku:"SP-IP13-TG2",category:"Screen Protectors",price:3.2,specs:["2\u2011Pack","Tempered","9H","Oleophobic"],description:"Clear tempered glass for iPhone 13.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.07_b6d5696d.jpg",variants:{Model:["iPhone 13"],Material:["Tempered"],Pack:["2\u2011Pack"]}},{id:"sp-iph-14-hg-1pk",name:"Hydrogel Protector \u2013 iPhone 14",sku:"SP-IP14-HG1",category:"Screen Protectors",price:2.6,specs:["Hydrogel","Self\u2011healing","Case\u2011friendly"],description:"Flexible hydrogel film.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.08_46a12f36.jpg",variants:{Model:["iPhone 14"],Material:["Hydrogel"],Pack:["1\u2011Pack","2\u2011Pack"]}},{id:"case-slim-tpu-iph-11-16",name:"Slim TPU Case \u2013 iPhone Series",sku:"CA-IP-TPU",category:"Phone Cases",price:3.9,specs:["TPU","Slim","Matte"],description:"Slim matte TPU case.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.09_811264ed.jpg",variants:{Color:["Black","Navy","Clear","Red"],Material:["TPU"],Model:Fe}},{id:"case-silicone-sg-s20-s25",name:"Soft Silicone Case \u2013 Galaxy Series",sku:"CA-SG-SIL",category:"Phone Cases",price:4.1,specs:["Silicone","Microfiber"],description:"Soft\u2011touch silicone for Galaxy.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.10_3d78676b.jpg",variants:{Color:["Midnight","Stone","Lavender"],Material:["Silicone"],Model:Ft}},{id:"chg-65w-gan-dual",name:"65W GaN Charger \u2013 Dual Port",sku:"CH-65W-GAN",category:"Chargers",price:12.5,specs:["65W","USB\u2011C + USB\u2011A","PD/QC"],description:"Compact GaN charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_89070b32.jpg",variants:{Wattage:["65W"],Ports:["USB\u2011C + USB\u2011A"],Standard:We}},{id:"chg-20w-usbc",name:"20W USB\u2011C Wall Charger",sku:"CH-20W-USBC",category:"Chargers",price:6,specs:["20W","USB\u2011C","PD"],description:"USB\u2011C PD charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_9ebc1ea2.jpg",variants:{Wattage:["20W"],Ports:["USB\u2011C"],Standard:["PD 3.0"]}},{id:"cbl-usbc-60w-1m-2m",name:"USB\u2011C Cable 60W",sku:"CB-UC-60",category:"Cables",price:2.2,specs:["USB\u2011C","60W","Nylon"],description:"Braided 60W cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.12_628fcab2.jpg",variants:{Connector:["USB\u2011C \u2194 USB\u2011C"],Length:Ia,Rating:["60W"]}},{id:"cbl-lightning-mfi",name:"Lightning Cable (MFi)",sku:"CB-LT-MFI",category:"Cables",price:3.5,specs:["Lightning","MFi","1m"],description:"MFi Lightning cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.13_22d8e7c9.jpg",variants:{Connector:["USB\u2011C \u2194 Lightning"],Length:["1m"],Rating:["27W"]}},{id:"ear-wired-classic",name:"Wired Earphones \u2013 Classic",sku:"EA-WI-CLS",category:"Earphones",price:4.2,specs:["3.5mm","In\u2011line mic"],description:"Wired earphones.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.14_4f407f9a.jpg",variants:{Connector:["3.5mm"],Color:["Black","White"]}},{id:"ear-tws-basic",name:"TWS Earbuds \u2013 Basic",sku:"EA-TWS-BSC",category:"Earphones",price:12.9,specs:["BT 5.3","20h"],description:"TWS earbuds.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.15_e7b8adc0.jpg",variants:{Color:["White","Black"],Standard:["BT 5.3"]}},{id:"pb-10000-compact",name:"Power Bank 10,000 mAh",sku:"PB-10K-CMP",category:"Power Banks",price:11,specs:["10,000 mAh","USB\u2011C","PD"],description:"Slim 10k power bank.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.17_01d0dcae.jpg",variants:{Capacity:["10,000 mAh"],Ports:["USB\u2011C","USB\u2011A"],Standard:We}},{id:"pb-20000-dual",name:"Power Bank 20,000 mAh \u2013 Dual",sku:"PB-20K-DUAL",category:"Power Banks",price:16.5,specs:["20,000 mAh","Dual","PD/QC"],description:"20k dual output.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.19_3b58c17b.jpg",variants:{Capacity:["20,000 mAh"],Ports:["USB\u2011C + USB\u2011A"],Standard:We}},{id:"img-001",name:"Accessory Photo A",sku:"IM-001",category:"Phone Cases",price:2.5,specs:["Assorted"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.33_5dd08e33.jpg"},{id:"img-002",name:"Accessory Photo B",sku:"IM-002",category:"Chargers",price:7.2,specs:["Fast"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_09a1e9d9.jpg"},{id:"img-003",name:"Accessory Photo C",sku:"IM-003",category:"Cables",price:1.8,specs:["1m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_f1935767.jpg"},{id:"img-004",name:"Accessory Photo D",sku:"IM-004",category:"Screen Protectors",price:2.9,specs:["Tempered"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.35_92866963.jpg"},{id:"img-005",name:"Accessory Photo E",sku:"IM-005",category:"Phone Cases",price:3.6,specs:["TPU"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.36_d9ee268e.jpg"},{id:"img-006",name:"Accessory Photo F",sku:"IM-006",category:"Back Glass",price:5.5,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.37_ef5ed98e.jpg"},{id:"img-007",name:"Accessory Photo G",sku:"IM-007",category:"Earphones",price:6,specs:["Wireless"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_b444897c.jpg"},{id:"img-008",name:"Accessory Photo H",sku:"IM-008",category:"Power Banks",price:9.9,specs:["10k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_f170faf6.jpg"},{id:"img-009",name:"Accessory Photo I",sku:"IM-009",category:"Cables",price:2,specs:["2m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.39_c37cddc9.jpg"},{id:"img-010",name:"Accessory Photo J",sku:"IM-010",category:"Chargers",price:11.5,specs:["65W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.40_7a858ba3.jpg"},{id:"img-011",name:"Accessory Photo K",sku:"IM-011",category:"Phone Cases",price:4.4,specs:["Silicone"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_80d08b54.jpg"},{id:"img-012",name:"Accessory Photo L",sku:"IM-012",category:"Screen Protectors",price:1.9,specs:["Hydrogel"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_a2efd2e1.jpg"},{id:"img-013",name:"Accessory Photo M",sku:"IM-013",category:"Back Glass",price:6.5,specs:["Back glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.42_63c16e8a.jpg"},{id:"img-014",name:"Accessory Photo N",sku:"IM-014",category:"Batteries",price:8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.43_06e00e31.jpg"},{id:"img-015",name:"Accessory Photo O",sku:"IM-015",category:"Phone Cases",price:3.2,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_de3a612b.jpg"},{id:"img-016",name:"Accessory Photo P",sku:"IM-016",category:"Cables",price:2.4,specs:["Nylon"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_fddf905d.jpg"},{id:"img-017",name:"Accessory Photo Q",sku:"IM-017",category:"Earphones",price:5,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.45_b1dd7f8a.jpg"},{id:"img-018",name:"Accessory Photo R",sku:"IM-018",category:"Chargers",price:9.5,specs:["30W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_30024620.jpg"},{id:"img-019",name:"Accessory Photo S",sku:"IM-019",category:"Power Banks",price:14,specs:["20k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_cb602f30.jpg"},{id:"img-020",name:"Accessory Photo T",sku:"IM-020",category:"Phone Cases",price:3.8,specs:["Leather"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_d9e5908c.jpg"},{id:"img-021",name:"Accessory Photo U",sku:"IM-021",category:"Screen Protectors",price:2.7,specs:["Matte"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.47_ac758901.jpg"},{id:"img-022",name:"Accessory Photo V",sku:"IM-022",category:"Cables",price:1.6,specs:["0.5m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_bc4af4ef.jpg"},{id:"img-023",name:"Accessory Photo W",sku:"IM-023",category:"Chargers",price:4.9,specs:["USB\u2011A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_f4496fba.jpg"},{id:"img-024",name:"Accessory Photo X",sku:"IM-024",category:"Earphones",price:13.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.49_ad6d3003.jpg"},{id:"img-025",name:"Accessory Photo Y",sku:"IM-025",category:"Phone Cases",price:2.9,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.50_b3694795.jpg"},{id:"img-026",name:"Accessory Photo Z",sku:"IM-026",category:"Back Glass",price:7,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.51_5e67178c.jpg"},{id:"img-027",name:"Accessory Photo AA",sku:"IM-027",category:"Batteries",price:6.9,specs:["Refurb"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.52_df23fdba.jpg"},{id:"img-028",name:"Accessory Photo AB",sku:"IM-028",category:"Chargers",price:8.5,specs:["PD"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.53_13d347f3.jpg"},{id:"img-029",name:"Accessory Photo AC",sku:"IM-029",category:"Cables",price:2.1,specs:["Braided"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_5c3d1851.jpg"},{id:"img-030",name:"Accessory Photo AD",sku:"IM-030",category:"Power Banks",price:12.2,specs:["Dual output"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_8f092381.jpg"},{id:"img-031",name:"Accessory Photo AE",sku:"IM-031",category:"Earphones",price:3.9,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.56_cbdfea17.jpg"},{id:"img-032",name:"Accessory Photo AF",sku:"IM-032",category:"Phone Cases",price:4.5,specs:["Patterned"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_61b6ae02.jpg"},{id:"img-033",name:"Accessory Photo AG",sku:"IM-033",category:"Screen Protectors",price:2.3,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_efd60a9b.jpg"},{id:"img-034",name:"Accessory Photo AH",sku:"IM-034",category:"Chargers",price:10,specs:["GaN"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.58_082b158d.jpg"},{id:"img-035",name:"Accessory Photo AI",sku:"IM-035",category:"Power Banks",price:15,specs:["High capacity"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.00_7e6451d4.jpg"},{id:"img-036",name:"Accessory Photo AJ",sku:"IM-036",category:"Cables",price:1.5,specs:["USB-C"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.01_bf466384.jpg"},{id:"img-037",name:"Accessory Photo AK",sku:"IM-037",category:"Earphones",price:7.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2920cb02.jpg"},{id:"img-038",name:"Accessory Photo AL",sku:"IM-038",category:"Phone Cases",price:3.1,specs:["Transparent"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2ae9f56f.jpg"},{id:"img-039",name:"Accessory Photo AM",sku:"IM-039",category:"Back Glass",price:6.8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_725a57bf.jpg"},{id:"img-040",name:"Accessory Photo AN",sku:"IM-040",category:"Chargers",price:5.5,specs:["USB-A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.04_faa6a5d9.jpg"}],ye=a=>new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format(a),q=(...a)=>a.filter(Boolean).join(" ");function Fa(){const[a,r]=w(!1);return _(()=>{var n;const t=window.matchMedia("(prefers-reduced-motion: reduce)");r(t.matches);const o=()=>r(t.matches);return(n=t.addEventListener)==null||n.call(t,"change",o),()=>{var d;return(d=t.removeEventListener)==null?void 0:d.call(t,"change",o)}},[]),a}function Ie(a){const r=encodeURIComponent("#f3f4f6"),t=encodeURIComponent("#6b7280"),o=encodeURIComponent(a),n=`<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' width='800' height='600' role='img' aria-label='${o}'><rect width='100%' height='100%' fill='${r}'/><g fill='${t}' font-family='system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif'><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='24'>${o}</text></g></svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`}function Ve(a,r){return a?a.startsWith("data:")||a.startsWith("http")?a:`/img/${a}`:Ie(r)}function Wa(a){const r=Array.isArray(a.images)&&a.images.length?a.images:a.image?[a.image]:[];return r.length?r:[Ie(a.name)]}function qt(a){const r=Wa(a);return Ve(r[0],a.name)}function at(a,r,t){const o=ae(t);_(()=>{o.current=t},[t]),_(()=>{if(!a||!r.current)return;const n=r.current,d=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),l=document.activeElement;(()=>{const g=Array.from(n.querySelectorAll(d));if(!g.length){n.hasAttribute("tabindex")||n.setAttribute("tabindex","-1"),typeof n.focus=="function"&&n.focus({preventScroll:!0});return}const i=g[0];i&&typeof i.focus=="function"&&i.focus({preventScroll:!0})})();const y=g=>{var i;if(g.key==="Escape"){g.stopPropagation(),(i=o.current)==null||i.call(o);return}if(g.key==="Tab"){const m=Array.from(n.querySelectorAll(d));if(!m.length)return;const c=m[0],u=m[m.length-1];g.shiftKey&&document.activeElement===c?(g.preventDefault(),u.focus()):!g.shiftKey&&document.activeElement===u&&(g.preventDefault(),c.focus())}};return n.addEventListener("keydown",y),()=>{if(n.removeEventListener("keydown",y),l&&typeof l.focus=="function"&&document.contains(l))try{l.focus({preventScroll:!0})}catch(g){l.focus()}}},[a])}function Da(a,r){const t=ae(0),o=ae(null);Ke(()=>{if(typeof window=="undefined"||!a)return;const n=document.body,d=document.documentElement;if(!n||!d)return;const l=window.scrollY||window.pageYOffset||0,h=r&&Number.isFinite(r.current)?r.current:l;return t.current=h,o.current={position:n.style.position,top:n.style.top,width:n.style.width,overflow:n.style.overflow,htmlOverflow:d.style.overflow,overscroll:d.style.overscrollBehavior},n.style.position="fixed",n.style.top=`-${h}px`,n.style.width="100%",n.style.overflow="hidden",d.style.overflow="hidden",d.style.overscrollBehavior="none",()=>{const y=o.current||{};n.style.position=y.position||"",n.style.top=y.top||"",n.style.width=y.width||"",n.style.overflow=y.overflow||"",d.style.overflow=y.htmlOverflow||"",d.style.overscrollBehavior=y.overscroll||"",window.scrollTo(0,t.current||0),o.current=null}},[a,r])}function Rt({open:a,title:r,onClose:t,children:o,actions:n}){const d=ae(null);return at(!!a,d,t),a?React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},React.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:t,"aria-hidden":"true"}),React.createElement("div",{ref:d,role:"dialog","aria-modal":"true",className:"relative w-full max-w-lg rounded-3xl border border-[var(--surface-border)] bg-white p-5 shadow-soft-xl"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},r),React.createElement("button",{type:"button",onClick:t,className:"rounded-full p-2 text-slate-500 hover:bg-slate-100","aria-label":"Close"},"\xD7")),React.createElement("div",{className:"mt-4 space-y-4"},o),n&&React.createElement("div",{className:"mt-5 flex justify-end gap-2"},n))):null}function Ua({label:a,mode:r,fieldType:t,options:o,value:n,onChange:d,onEdit:l,onRemove:h}){const y=t==="checkbox",i=String(y?"single":r||"single").toLowerCase().trim().includes("multi")?"multi":"single",m=y?["Yes","No"]:Array.isArray(o)?o:[],[c,u]=w(!1),M=ae(null);_(()=>{if(!c)return;const v=L=>{M.current&&!M.current.contains(L.target)&&u(!1)};return document.addEventListener("mousedown",v),document.addEventListener("touchstart",v),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("touchstart",v)}},[c]);const O=!!n,A=Array.isArray(n)?n:[],k=typeof n=="string"?n:n==null?"":String(n),$=y?O?"Yes":"No":i==="multi"?A.length?`${A.length} selected`:"Select...":k||"Select...",W=()=>{d(y?!1:i==="multi"?[]:"")},j=v=>{if(y){d(v==="Yes"),u(!1);return}if(i==="multi"){const L=A.includes(v)?A.filter(x=>x!==v):[...A,v];d(L);return}d(v),u(!1)};return React.createElement("div",{ref:M,className:q("relative rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur",c&&"z-30")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",{className:"flex-1"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},a),React.createElement("button",{type:"button",onClick:()=>u(v=>!v),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-left text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-expanded":c?"true":"false"},$)),React.createElement("div",{className:"mt-6 flex items-center gap-1"},React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:W,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white",title:"Clear"},"Clear"),React.createElement("button",{type:"button",onClick:h,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove ${a}`},"\xD7"))),c&&React.createElement("div",{className:"absolute left-4 right-4 top-[78px] z-40 overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-white shadow-soft-xl"},React.createElement("div",{className:"max-h-64 overflow-y-auto p-2"},m.map(v=>{const L=y?v==="Yes"?O:!O:i==="multi"?A.includes(v):k===v;return React.createElement("button",{key:v,type:"button",onClick:()=>j(v),className:q("flex w-full items-center gap-3 rounded-xl px-3 py-2 text-left text-sm transition",L?"bg-brand-soft text-slate-900":"hover:bg-slate-50")},React.createElement("span",{className:q("inline-flex h-4 w-4 items-center justify-center rounded border",L?"border-brand bg-brand text-white":"border-[var(--surface-border)] bg-white")},L?"\u2713":""),React.createElement("span",{className:"flex-1"},v))})),React.createElement("div",{className:"flex items-center justify-end border-t border-[var(--surface-border)] bg-white/80 px-3 py-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>u(!1),className:"rounded-full bg-brand px-3 py-1 font-semibold text-white hover:bg-brand-muted"},"Done"))))}function $a({label:a,mode:r,options:t,value:o,onChange:n,onEdit:d,onRemove:l}){const h=Array.isArray(t)?t:[],g=String(r||"multi").toLowerCase().trim().includes("multi")?"multi":"single",i=Array.isArray(o)?o:[],m=typeof o=="string"?o:o==null?"":String(o),c=u=>{if(g==="multi"){const M=i.includes(u)?i.filter(O=>O!==u):[...i,u];n(M);return}n(m===u?"":u)};return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-1 text-xs"},g==="multi"&&h.length>0&&React.createElement("button",{type:"button",onClick:()=>{n(h)},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),g==="multi"&&React.createElement("button",{type:"button",onClick:()=>{n([])},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Edit"),React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60","aria-label":`Remove ${a}`},"\xD7"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},h.map(u=>{const M=g==="multi"?i.includes(u):m===u,O=et[u]!==void 0||/color/i.test(a);return React.createElement("button",{type:"button",key:u,onClick:()=>c(u),className:q("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",M?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},O?React.createElement(React.Fragment,null,React.createElement(Me,{name:u}),u):u)})))}function Ga(){const[a,r]=w([]),[t,o]=w("");_(()=>{try{const g=localStorage.getItem(ke);if(g){const i=JSON.parse(g);Array.isArray(i.items)&&r(i.items),typeof i.notes=="string"&&o(i.notes)}}catch(g){}},[]),_(()=>{try{localStorage.setItem(ke,JSON.stringify({items:a,notes:t}))}catch(g){}},[a,t]);const n=g=>r(i=>{const m=i.findIndex(c=>c.id===g.id&&JSON.stringify(c.variants||{})===JSON.stringify(g.variants||{}));if(m>=0){const c=[...i];return c[m]={...c[m],qty:c[m].qty+g.qty},c}return[...i,g]}),d=(g,i)=>r(m=>m.map((c,u)=>u===g?{...c,qty:Math.max(0,Number(i)||0)}:c)),l=g=>r(i=>i.filter((m,c)=>c!==g)),h=()=>r([]),y=a.reduce((g,i)=>g+i.price*i.qty,0);return{items:a,add:n,updateQty:d,removeIndex:l,clear:h,subtotal:y,notes:t,setNotes:o}}function Ka(a,r){const[t,o]=w(()=>wt());return _(()=>{var h;const d=(a||[]).find(y=>y&&y.id===Ze),l=(h=d==null?void 0:d.variants)==null?void 0:h.__config;l&&typeof l=="object"&&o(Xe(l))},[a]),{catalogConfig:t,saveCatalogConfig:async d=>{const l=Xe(d);o(l);const h=ce({id:Ze,name:"__catalog_config__",sku:"__catalog_config__",category:"All",price:0,description:"Internal catalog config row",hidden:!0,images:[],specs:[],variants:{__config:l},inventory:{}}),y=await ft(h);y&&r(g=>{const i=Array.isArray(g)?g:[],m=i.findIndex(c=>c&&c.id===Ze);if(m>=0){const c=[...i];return c[m]=y,c}return[y,...i]})}}}function Ha(){const[a,r]=w([]),[t,o]=w(!0),[n,d]=w("connecting");_(()=>{(async()=>{try{d("connecting");const i=await Lt();r(i);try{localStorage.setItem(Pe,JSON.stringify(i))}catch(m){}d("connected")}catch(i){console.error("Failed to load products from database:",i),d("error");try{const m=localStorage.getItem(Pe);if(m){const c=JSON.parse(m);Array.isArray(c)&&r(c.map(ce).filter(Boolean))}}catch(m){}}finally{o(!1)}})()},[]),_(()=>{if(!fe){console.warn("\u26A0\uFE0F Cannot setup realtime: Supabase not initialized");return}console.log("\u{1F504} Setting up realtime subscription...");const g=fe.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"products"},i=>{console.log("\u{1F534} Realtime event received:",i.eventType,i),r(m=>{if(i.eventType==="INSERT"){console.log("\u2795 Adding product via realtime:",i.new.name);const c=ce(i.new),u=m.findIndex(M=>M.id===c.id);if(u>=0){console.log("\u{1F504} Updating existing product instead of duplicating");const M=[...m];return M[u]=c,M}return[c,...m]}if(i.eventType==="UPDATE"){console.log("\u270F\uFE0F Updating product via realtime:",i.new.name);const c=ce(i.new);return m.map(u=>u.id===i.new.id?c:u)}return i.eventType==="DELETE"?(console.log("\u{1F5D1}\uFE0F Deleting product via realtime:",i.old.id),m.filter(c=>c.id!==i.old.id)):m})}).subscribe(i=>{console.log("\u{1F534} Realtime status:",i),i==="SUBSCRIBED"?(console.log("\u2705 Realtime subscription active!"),d("connected"),Lt().then(m=>{console.log("\u{1F504} Reloaded products after reconnection");const c=m.map(ce).filter(Boolean);r(c);try{localStorage.setItem(Pe,JSON.stringify(c))}catch(u){}}).catch(m=>{console.error("\u274C Failed to reload products after reconnection:",m)})):i==="CHANNEL_ERROR"||i==="CLOSED"?(console.error("\u274C Realtime subscription failed!"),d("error")):(console.log("\u{1F504} Realtime connecting..."),d("connecting"))});return()=>{console.log("\u{1F50C} Cleaning up realtime subscription"),g.unsubscribe()}},[]);const l=g=>{if(typeof g=="function")r(i=>{const m=g(i),c=(Array.isArray(m)?m:[]).map(ce).filter(Boolean);try{localStorage.setItem(Pe,JSON.stringify(c))}catch(u){}return c});else{const i=(Array.isArray(g)?g:[]).map(ce).filter(Boolean);r(i);try{localStorage.setItem(Pe,JSON.stringify(i))}catch(m){}}};return{ownerProducts:a,setOwnerProducts:l,addProduct:async g=>{const i=await ha(g);if(i)return l(c=>[i,...c]),{product:i,persisted:!0};const m=ce(g);return l(c=>[m,...c]),{product:m,persisted:!1}},deleteProduct:async g=>{const i=await va(g);return i&&l(m=>m.filter(c=>c.id!==g)),i},loading:t,connectionStatus:n}}const Yt=a=>{var c;if(!a)return null;const{total_cents:r,totalCents:t,currency:o,status:n,order_items:d,orderItems:l,metadata:h,...y}=a,g=Number((c=r!=null?r:t)!=null?c:0),m=(Array.isArray(d)?d:Array.isArray(l)?l:[]).map(u=>{var O,A,k,$,W,j,v,L;if(!u)return null;const M=Number((W=(O=u.subtotal_cents)!=null?O:u.subtotalCents)!=null?W:(Number((A=u.quantity)!=null?A:0)||0)*(Number(($=(k=u.unit_price_cents)!=null?k:u.unitPriceCents)!=null?$:0)||0));return{...u,quantity:Number((j=u.quantity)!=null?j:0),unit_price_cents:Number((L=(v=u.unit_price_cents)!=null?v:u.unitPriceCents)!=null?L:0),subtotal_cents:M}}).filter(Boolean);return{...y,status:(n||"open").toLowerCase(),total_cents:g,currency:o||Je,metadata:h||{},order_items:m}},Vt=a=>{if(!a)return 0;const r=a.created_at||a.createdAt||a.inserted_at||a.insertedAt,t=r?new Date(r).getTime():0;return Number.isFinite(t)?t:0},Qt=a=>[...Array.isArray(a)?a:[]].sort((t,o)=>Vt(o)-Vt(t));function za(){const[a,r]=w([]),[t,o]=w(!0),[n,d]=w(null),[l,h]=w(null),y=React.useCallback(async()=>{try{o(!0),d(null);const i=await Le("listOrders"),c=(Array.isArray(i==null?void 0:i.data)?i.data:[]).map(Yt).filter(Boolean);r(Qt(c)),h((i==null?void 0:i.meta)||null)}catch(i){console.error("Failed to load orders",i),d(i),r([]),h(null)}finally{o(!1)}},[]);_(()=>{y()},[y]);const g=React.useCallback(async(i,m)=>{if(!i||!m)return null;try{const c=await Le("updateOrderStatus",{id:i,status:m}),u=Yt(c==null?void 0:c.data);return u&&r(M=>{const O=M.map(A=>A.id===u.id?u:A);return Qt(O)}),u}catch(c){throw console.error("Failed to update order status",c),c!=null&&c.message&&/404/.test(c.message)?new Error("Order no longer exists. Refresh the list and try again."):new Error((c==null?void 0:c.message)||"Unable to update order status. Please try again.")}},[]);return{orders:a,loadingOrders:t,ordersError:n,ordersMeta:l,refreshOrders:y,updateOrderStatus:g}}function qa({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))}function Nt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}function Ya({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}function Jt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}function Va({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}function Qa({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.164a1.5 1.5 0 0 0-1.5 1.5v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}function Ja({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 13.5v2.25m2.598-9.05a6.75 6.75 0 1 1-5.196 0m7.346 9.591 1.263 1.263m-9.856-1.263L6.892 17.05m.944-4.117L5.4 8.5m13.2 0-2.436 4.433"}))}function Za({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}function Xa({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9A2.25 2.25 0 0 0 7.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9A2.25 2.25 0 0 0 16.5 5.25H15m-6 0A1.5 1.5 0 0 1 10.5 3.75h3A1.5 1.5 0 0 1 15 5.25m-6 0v.75A1.5 1.5 0 0 0 10.5 7.5h3A1.5 1.5 0 0 0 15 6V5.25"}))}function er({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.5h13.5v9h-13.5V7.5Zm13.5 0H18a2.25 2.25 0 0 1 1.8.9l1.95 2.6a2.25 2.25 0 0 1 .45 1.35v4.65h-2.25m-1.5 0a1.5 1.5 0 1 0-3 0m3 0H15.75m-9 0a1.5 1.5 0 1 0-3 0m3 0H3.75"}))}function Zt({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0 0 20.885 3.488"}))}function kt({status:a}){const r=(a||"").toLowerCase(),t=r==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":r==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":r==="cancelled"?"border-rose-200 bg-rose-50 text-rose-700":"border-amber-200 bg-amber-50 text-amber-800";return React.createElement("span",{className:q("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium capitalize",t)},tt[r]||r||"Open")}function rt({title:a,value:r,subtext:t,trend:o}){return React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm ring-1 ring-black/5 sm:p-5"},React.createElement("p",{className:"text-sm font-medium text-slate-500"},a),React.createElement("p",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900"},r),t&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},t),o&&React.createElement("div",{className:"mt-3 inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700"},o))}function tr({allProducts:a,ownerProducts:r,orders:t,loadingOrders:o,ordersMeta:n,ordersError:d,onNavigate:l,refreshOrders:h}){const y=a.filter(v=>!v.hidden).length,g=r.filter(v=>v.sourceId&&!v.hidden).length,i=r.filter(v=>!v.sourceId&&!v.hidden).length,m=r.filter(v=>v.hidden).length,c=t.reduce((v,L)=>{const x=((L==null?void 0:L.status)||"open").toLowerCase();return v[x]=(v[x]||0)+1,v},{}),u=[...zt,"cancelled"],M=c.open||0,O=c.confirmed||0,A=c.shipped||0,k=t.filter(v=>["confirmed","shipped"].includes(((v==null?void 0:v.status)||"").toLowerCase())).reduce((v,L)=>v+(Number(L==null?void 0:L.total_cents)||0),0),$=new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format(k/100),W=t.slice(0,5),j=v=>{l==null||l(v)};return React.createElement("div",{className:"flex flex-col gap-10"},React.createElement("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900"},"Owner dashboard"),React.createElement("p",{className:"mt-1 text-sm text-slate-600"},"Monitor catalogue health and stay on top of incoming orders."))),React.createElement("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},React.createElement(rt,{title:"Active SKUs",value:y,subtext:g?`${g} overrides`:void 0}),React.createElement(rt,{title:"Owner additions",value:i,subtext:m?`${m} hidden`:"Live to customers"}),React.createElement(rt,{title:"Open orders",value:o?"\u2014":M,subtext:O?`${O} confirmed`:"Awaiting confirmation"}),React.createElement(rt,{title:"Fulfilled value",value:$,subtext:A?`${A} shipped`:"No shipments yet"})),React.createElement("section",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,1fr)]"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order pipeline"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},"Track each stage to keep fulfilment moving.")),React.createElement("button",{type:"button",onClick:h,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",disabled:o},o?"Refreshing\u2026":"Refresh")),d?/schema cache|relation "orders"/i.test(d.message||"")?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900"},React.createElement("p",{className:"font-medium"},"Orders could not be loaded"),React.createElement("p",{className:"mt-1"},d.message||"Check your connection or Supabase policies and try again.")):n!=null&&n.missingOrdersTable?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("dl",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-4"},u.map(v=>React.createElement("div",{key:v,className:q("rounded-xl border px-4 py-3 text-center flex flex-col items-center justify-center gap-1",v==="open"?"border-amber-200 bg-amber-50 text-amber-800":v==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":v==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":"border-rose-200 bg-rose-50 text-rose-700")},React.createElement("dt",{className:"text-[11px] font-medium uppercase tracking-wide"},tt[v]||v),React.createElement("dd",{className:"text-2xl font-semibold leading-none"},o?"\u2014":c[v]||0))))),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Recent orders"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},W.length?"Latest activity from verified customers.":"No orders yet \u2014 your list will appear here.")),React.createElement("button",{type:"button",onClick:()=>j("orders"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Open orders")),W.length>0&&React.createElement("ul",{className:"mt-5 space-y-3"},W.map(v=>React.createElement("li",{key:v.id,className:"rounded-xl border border-slate-200 bg-white px-4 py-3 shadow-sm"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium text-slate-900"},v.customer_name||v.customer_email||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},v.customer_email||"Email pending")),React.createElement(kt,{status:v.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(v.created_at||v.createdAt||Date.now()))),React.createElement("span",{className:"font-medium text-slate-700"},new Intl.NumberFormat("en-GB",{style:"currency",currency:be}).format((Number(v.total_cents)||0)/100)))))))))}function ar({orders:a,loading:r,error:t,meta:o,onRefresh:n,onStatusChange:d,onNotify:l}){var v,L;const[h,y]=w("open"),[g,i]=w(null),[m,c]=w(!1),u=X(()=>a.reduce((x,H)=>{const C=((H==null?void 0:H.status)||"open").toLowerCase();return x[C]=(x[C]||0)+1,x.all=(x.all||0)+1,x},{all:0}),[a]),M=X(()=>Array.from(new Set([...zt,"cancelled","all"])),[]),O=X(()=>h==="all"?a:a.filter(x=>((x==null?void 0:x.status)||"open").toLowerCase()===h),[a,h]);_(()=>{var x;if(!O.length){i(null);return}(!g||!O.some(H=>H.id===g))&&i(((x=O[0])==null?void 0:x.id)||null)},[O,g]);const A=O.find(x=>x.id===g)||null,k=X(()=>new Intl.NumberFormat("en-GB",{style:"currency",currency:be}),[]),$=x=>k.format((Number(x)||0)/100),W=x=>{try{return new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(x))}catch(H){return"\u2014"}},j=async(x,H)=>{const C=String(H||"").toLowerCase();if(!(!x||!C)){if(!Ta.includes(C)){l==null||l("error",`Unsupported status transition: ${H}`);return}try{if(c(!0),await(d==null?void 0:d(x,C))){const S=tt[C]||C;l==null||l("success",`Order status updated to ${S}.`)}}catch(f){console.error("Failed to update order status",f),l==null||l("error",(f==null?void 0:f.message)||"Unable to update order status right now.")}finally{c(!1)}}};if(o!=null&&o.missingOrdersTable)return React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh"));if(t){const x=(t==null?void 0:t.message)||"";return/schema cache|relation "orders"/i.test(x)?React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh")):React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-6 text-sm text-rose-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-rose-900"},"Unable to load orders"),React.createElement("p",{className:"mt-2"},t.message||"Check your connection or Supabase permissions and try again."),React.createElement("button",{type:"button",onClick:n,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-rose-300 bg-white px-4 py-2 text-xs font-medium text-rose-700 hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-500"},"Retry"))}return React.createElement("div",{className:"flex flex-col gap-6"},React.createElement("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Orders pipeline"),React.createElement("p",{className:"text-sm text-slate-600"},"Move orders from open to shipped, while keeping a full audit trail.")),React.createElement("div",{className:"flex flex-wrap gap-2 text-xs text-slate-500"},React.createElement("span",{className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-amber-700"},`Open: ${u.open||0}`),React.createElement("span",{className:"rounded-full border border-emerald-200 bg-emerald-50 px-3 py-1 text-emerald-700"},`Confirmed: ${u.confirmed||0}`),React.createElement("span",{className:"rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-sky-700"},`Shipped: ${u.shipped||0}`),React.createElement("button",{type:"button",onClick:n,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1 text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},r?"Refreshing\u2026":"Refresh"))),React.createElement("div",{className:"flex flex-wrap gap-2"},M.map(x=>React.createElement("button",{key:x,type:"button",onClick:()=>y(x),className:q("rounded-full border px-3 py-1.5 text-xs font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",h===x?"border-brand bg-[var(--brand-soft-strong)] text-brand shadow-sm":"border-slate-300 bg-white text-slate-600 hover:bg-slate-50")},x==="all"?"All":tt[x]||x))),r&&!a.length?React.createElement("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white/80 p-10 text-slate-500"},"Loading orders\u2026"):O.length?React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,360px)]"},React.createElement("div",{className:"space-y-3"},O.map(x=>React.createElement("button",{key:x.id,type:"button",onClick:()=>i(x.id),className:q("w-full rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",x.id===g?"border-brand bg-[var(--brand-soft-strong)]/70 text-slate-900 shadow-md":"border-slate-200 bg-white hover:border-slate-300")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-semibold text-slate-900"},x.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},x.customer_email||"Email pending")),React.createElement(kt,{status:x.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,W(x.created_at||x.createdAt)),React.createElement("span",{className:"font-medium text-slate-700"},$(x.total_cents)))))),React.createElement("aside",{className:"rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm"},A?React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},A.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},A.customer_email||"Email pending")),React.createElement(kt,{status:A.status})),React.createElement("dl",{className:"grid grid-cols-2 gap-3 text-xs text-slate-500"},React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Placed"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(A.created_at||A.createdAt))),React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Total"),React.createElement("dd",{className:"mt-1 text-slate-700 font-semibold"},$(A.total_cents))),A.updated_at&&React.createElement("div",{className:"col-span-2"},React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Updated"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(A.updated_at)))),A.order_items&&A.order_items.length>0&&React.createElement("div",null,React.createElement("h4",{className:"text-sm font-semibold text-slate-800"},"Items"),React.createElement("ul",{className:"mt-3 space-y-3"},A.order_items.map(x=>React.createElement("li",{key:x.id||`${x.product_id}-${x.sku}`},React.createElement("div",{className:"flex items-start justify-between gap-3 text-sm text-slate-700"},React.createElement("div",null,React.createElement("p",{className:"font-medium text-slate-900"},x.name||"Item"),x.sku&&React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",x.sku)),React.createElement("span",{className:"text-xs text-slate-500"},`\xD7${x.quantity||0}`)),x.variants&&Object.keys(x.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1 text-xs text-slate-600"},Object.entries(x.variants).map(([H,C])=>{const f=Array.isArray(C)?C.join(", "):C,S=/color/i.test(H);return React.createElement("span",{key:H,className:q("inline-flex items-center gap-1 rounded-full border px-2 py-0.5",S?"border-slate-300 bg-slate-50":"border-slate-200 bg-white")},S?React.createElement(Me,{name:f}):null,`${H}: ${f}`)})),React.createElement("div",{className:"mt-1 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,$(x.unit_price_cents)),React.createElement("span",{className:"font-medium text-slate-700"},$(x.subtotal_cents))))))),(A.note||((v=A.metadata)==null?void 0:v.notes))&&React.createElement("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},A.note||((L=A.metadata)==null?void 0:L.notes)),React.createElement("div",{className:"flex flex-wrap gap-2"},(()=>{const x=(A.status||"open").toLowerCase(),H=[];return x==="open"&&(H.push({label:"Mark as confirmed",next:"confirmed"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),x==="confirmed"&&(H.push({label:"Mark as shipped",next:"shipped"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),H.map(C=>React.createElement("button",{key:C.next,type:"button",onClick:()=>j(A.id,C.next),disabled:m,className:q("inline-flex items-center gap-2 rounded-full border px-4 py-2 text-xs font-medium shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",C.variant==="danger"?"border-rose-300 bg-rose-50 text-rose-700 hover:bg-rose-100":C.next==="shipped"?"border-sky-300 bg-sky-50 text-sky-700 hover:bg-sky-100":"border-emerald-300 bg-emerald-50 text-emerald-700 hover:bg-emerald-100",m?"opacity-60":"")},m?"Updating\u2026":C.label))})())):React.createElement("p",{className:"text-sm text-slate-500"},O.length?"Select an order to see its breakdown.":"No orders in this stage yet."))):React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-8 text-sm text-slate-500"},"No orders in this stage yet."))}function rr({views:a,section:r,onSectionChange:t}){const o=a.find(n=>n.id===r)||a[0];return React.createElement("main",{id:"main",className:"mx-auto w-full max-w-7xl px-4 pb-16 pt-6 sm:px-6 lg:px-8"},React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(200px,240px),minmax(0,1fr)]"},React.createElement("nav",{className:"flex snap-x snap-mandatory gap-3 overflow-x-auto pb-1 lg:flex-col lg:overflow-visible lg:pb-0"},a.map(n=>React.createElement("button",{key:n.id,type:"button",onClick:()=>t(n.id),className:q("snap-start rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",n.id===o.id?"border-brand bg-brand-soft text-brand":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50")},n.icon?React.createElement(n.icon,{className:"mb-2 h-5 w-5 text-current"}):null,React.createElement("span",{className:"block text-sm font-semibold"},n.label),n.description&&React.createElement("span",{className:"mt-1 block text-xs text-slate-500"},n.description)))),React.createElement("section",{className:"min-h-[480px]"},(o==null?void 0:o.element)||React.createElement("p",{className:"text-sm text-slate-500"},"Select a section to begin."))))}function sr(){return React.createElement("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 rounded-full border border-[var(--surface-border)] bg-white/90 px-3 py-2 text-sm font-semibold text-brand shadow-sm backdrop-blur"},"Skip to content")}function nr({onOpenCart:a,search:r,setSearch:t,ownerMode:o,setOwnerMode:n,cartQty:d,connectionStatus:l,allowOwnerToggle:h}){const[y,g]=w(!1),i=ae(null);_(()=>{const c=()=>g(window.scrollY>4);return c(),window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[]),_(()=>{const c=()=>{var M;const u=((M=i.current)==null?void 0:M.offsetHeight)||64;document.documentElement.style.setProperty("--header-offset",u+"px")};return c(),window.addEventListener("resize",c,{passive:!0}),()=>window.removeEventListener("resize",c)},[o,r]);const m=l==="connected"?{wrapper:"border border-emerald-200 bg-emerald-50/80 text-emerald-600",dot:"bg-emerald-500",label:"Online"}:l==="error"?{wrapper:"border border-rose-200 bg-rose-50/80 text-rose-600",dot:"bg-rose-500",label:"Offline"}:{wrapper:"border border-amber-200 bg-amber-50/80 text-amber-600",dot:"bg-amber-400 animate-pulse",label:"Connecting"};return React.createElement("header",{ref:i,className:q("sticky top-0 z-40 w-full border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-xl transition-shadow duration-300",y?"shadow-sm":"")},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"flex h-16 items-center justify-between gap-3"},React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement(qa,{className:"h-7 w-7 text-brand flex-shrink-0"}),React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement("span",{className:"font-semibold text-slate-900 text-sm sm:text-base tracking-tight truncate"},ct),React.createElement("div",{className:`hidden md:flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-medium ${m.wrapper}`,title:`Database ${l}`},React.createElement("span",{className:`inline-block h-2 w-2 rounded-full ${m.dot}`}),React.createElement("span",null,m.label)))),React.createElement("nav",{className:"flex items-center gap-1.5 sm:gap-2"},!o&&React.createElement("label",{className:"relative hidden sm:block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-48 md:w-64 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-2 text-sm font-medium text-slate-600 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(Nt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),h&&React.createElement("button",{onClick:()=>n(!o),className:q("rounded-full border px-3 py-2 text-xs sm:text-sm font-medium transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",o?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/60 text-slate-700 hover:bg-white/80")},o?"Back":"Owner"),React.createElement("button",{onClick:a,className:"relative inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/60 px-2.5 sm:px-3.5 py-2 text-xs sm:text-sm font-medium text-slate-700 transition-colors hover:bg-white/80 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Ya,{className:"h-4 w-4 text-brand"}),React.createElement("span",{className:"hidden sm:inline"},"Cart"),d>0&&React.createElement("span",{"aria-live":"polite",className:"absolute -top-1.5 -right-1.5 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-1 text-[10px] font-semibold text-brand"},String(d))))),!o&&React.createElement("div",{className:"sm:hidden pb-0"},React.createElement("label",{className:"relative block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm font-medium text-slate-700 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(Nt,{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})))))}function or(){const a=[{title:"1. Browse products",detail:"Search or tap a category to find what you need."},{title:"2. Open an item",detail:"Choose the variants and quantities, then add to cart."},{title:"3. Review the cart",detail:"Adjust quantities or notes before sending."},{title:"4. Send via WhatsApp",detail:"Use the cart button to submit the full list for confirmation."}];return React.createElement("section",{"aria-labelledby":"hero-title",className:"border-b border-[var(--surface-border)] bg-hero-gradient"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16"},React.createElement("div",{className:"grid gap-12 lg:grid-cols-[minmax(0,1fr)_420px] items-start"},React.createElement("div",{className:"space-y-6"},React.createElement("span",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-1 text-[11px] font-medium uppercase tracking-[0.14em] text-slate-600"},"Odil Accessories"),React.createElement("h1",{id:"hero-title",className:"text-[clamp(30px,6vw,48px)] font-semibold leading-tight tracking-tight text-slate-900"},"Wholesale catalogue for partner shops"),React.createElement("p",{className:"max-w-2xl text-base sm:text-lg text-slate-600"},He),React.createElement("div",{className:"flex flex-wrap gap-3"},React.createElement("a",{href:"#catalogue",className:"inline-flex items-center gap-2 rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Browse catalogue",React.createElement(Va,{className:"h-4 w-4"})),React.createElement("a",{href:`https://wa.me/${pe}`,target:"_blank",rel:"noreferrer noopener",className:"inline-flex items-center gap-2 rounded-full border border-[rgba(37,99,235,0.35)] bg-white/70 px-5 py-2.5 text-sm font-semibold text-slate-800 shadow-sm backdrop-blur transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Zt,{className:"h-4 w-4 text-emerald-500"}),"Chat on WhatsApp")),React.createElement("p",{className:"text-sm text-slate-500"},"Follow the steps on the right when you place an order.")),React.createElement("div",{className:"glass-card rounded-3xl p-8 soft-shadow"},React.createElement("div",{className:"space-y-5 text-sm text-slate-600"},React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order steps"),React.createElement("ol",{className:"space-y-3 text-sm"},a.map(r=>React.createElement("li",{key:r.title,className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 px-4 py-3 backdrop-blur"},React.createElement("p",{className:"text-sm font-semibold text-slate-900"},r.title),React.createElement("p",{className:"text-xs text-slate-500 mt-1"},r.detail))))),React.createElement("div",{className:"mt-6 flex items-center justify-between rounded-2xl border border-[var(--surface-border)] bg-white/80 px-4 py-3 text-xs uppercase tracking-[0.18em] text-slate-500"},React.createElement("span",null,"Owner metrics snapshot"),React.createElement("span",{className:"font-semibold text-slate-800"},"Realtime"))))))}function lr({active:a,setActive:r}){const t=ae(null),[o,n]=w({left:!1,right:!1});_(()=>{const l=()=>{const y=t.current;if(!y)return;const{scrollLeft:g,scrollWidth:i,clientWidth:m}=y,c=g>0,u=g+m<i-1;n(M=>M.left===c&&M.right===u?M:{left:c,right:u})};l();const h=t.current;if(h)return h.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",l),()=>{h.removeEventListener("scroll",l),window.removeEventListener("resize",l)}},[]);const d=q("relative -mx-4 overflow-x-auto px-4 chip-scroll-fade",o.left&&"show-left",o.right&&"show-right");return React.createElement(React.Fragment,null,React.createElement("div",{className:"sticky top-[var(--header-offset,64px)] z-30 border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-lg"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Categories"},React.createElement("div",{ref:t,className:d},React.createElement("div",{className:"flex gap-2 py-2 text-[11px]"},yt.map(l=>React.createElement("button",{key:l,onClick:()=>r(l),"aria-pressed":a===l,className:q("inline-flex items-center whitespace-nowrap rounded-full border px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",a===l?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/70 text-slate-600 hover:text-slate-900 hover:bg-white/90")},l)))))))}function ir({products:a,onOpen:r}){return React.createElement("section",{id:"catalogue","aria-labelledby":"catalogue-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("h2",{id:"catalogue-title",className:"sr-only"},"Catalogue"),React.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},a.map(t=>React.createElement(cr,{key:t.id,product:t,onOpen:r}))))}function cr({product:a,onOpen:r}){const[t,o]=w(qt(a));return _(()=>{o(qt(a))},[a.image,a.images,a.name]),React.createElement("article",{className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white/80 backdrop-blur transition duration-200 hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full overflow-hidden bg-slate-100"},React.createElement("img",{src:t,onError:()=>o(Ie(a.name)),alt:a.name,className:"h-full w-full object-cover",loading:"lazy"})),React.createElement("div",{className:"flex flex-1 flex-col gap-4 p-5"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},a.name),React.createElement("p",{className:"mt-1 text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400"},"SKU ",a.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-[11px]"},(a.specs||[]).slice(0,4).map(n=>React.createElement("span",{key:n,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 font-medium text-slate-600"},n))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},ye(a.price))),React.createElement("div",null,React.createElement("button",{type:"button",onClick:()=>r(a),className:"w-full rounded-full border border-[rgba(37,99,235,0.28)] bg-white/70 px-4 py-2 text-sm font-semibold text-brand transition hover:bg-brand hover:text-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"View details"))))}function dr({product:a,onClose:r,onAdd:t,cartItems:o}){const n=a&&a.__edit&&a.product?a.product:a;if(!n)return null;const d=Array.isArray(o)?o:[],l=X(()=>qe(n.inventory),[n.inventory]),h=X(()=>{const f={};return d.forEach(S=>{if(!S||S.id!==n.id)return;const R=S.inventoryKey||ve(S.variants||{});f[R]=(f[R]||0)+Number(S.qty||0)}),f},[d,n.id]),y=ae(null);at(!!n,y,r);const g=(()=>{const f=Array.isArray(n.images)&&n.images.length?n.images:n.image?[n.image]:[];return(f.length?f:[Ie(n.name)]).map(S=>Ve(S,n.name))})(),i=n.variants||{},m=Object.entries(i).filter(([,f])=>Array.isArray(f)&&f.length>0).map(([f])=>f),[c,u]=w({}),[M,O]=w({}),[A,k]=w({});_(()=>{if(!n)return;const f={};m.forEach(B=>{const I=i[B]||[];f[B]=I.length?[I[0]]:[]}),u(f);const S=(()=>{if(m.length===0)return[ee];const B=[],I=(z,re)=>{if(z===m.length){B.push(ve(re));return}const N=m[z];(f[N]||[]).forEach(D=>I(z+1,{...re,[N]:D}))};return I(0,{}),B})(),R={};S.forEach(B=>{R[B]=0}),O(R)},[n]);const $=(f,S)=>u(R=>{const B=R[f]||[],I=B.includes(S)?B.filter(z=>z!==S):[...B,S];return{...R,[f]:I}}),W=f=>u(S=>({...S,[f]:[...i[f]||[]]})),j=f=>u(S=>({...S,[f]:[]})),v=(f,S)=>{const R=Math.max(0,Number(S)||0);k(B=>{const I=B[f];if(I===void 0)return B;if(R<I){const z={...B};return delete z[f],z}return B}),O(B=>({...B,[f]:R}))},L=X(()=>{if(m.length===0)return[{key:ee,sel:{}}];if(m.some(R=>(c[R]||[]).length===0))return[];const f=[],S=(R,B)=>{if(R===m.length){f.push({key:ve(B),sel:B});return}const I=m[R];(c[I]||[]).forEach(z=>S(R+1,{...B,[I]:z}))};return S(0,{}),f},[m,c]),x=()=>{let f=!1,S=!1;L.forEach(({key:R,sel:B})=>{const I=Number(M[R]||0);if(!(I>0))return;const z=l[R]!==void 0?l[R]:R===ee?l[ee]:void 0,re=h[R]||0,N=typeof z=="number"?Math.max(z-re,0):void 0,D=typeof N=="number"?Math.min(I,N):I;D>0?(t({id:n.id,name:n.name,sku:n.sku,price:n.price,qty:D,variants:B,inventoryKey:R}),f=!0,D<I&&(S=!0)):S=!0}),S&&alert("Some items were adjusted to match available stock."),f&&r()},H=X(()=>L.reduce((f,{key:S})=>{const R=Number(M[S]||0);if(!Number.isFinite(R)||R<=0)return f;const B=l[S]!==void 0?l[S]:S===ee?l[ee]:void 0,I=h[S]||0,z=typeof B=="number"?Math.max(B-I,0):void 0,re=typeof z=="number"?Math.min(R,z):R;return re>0?f+re*n.price:f},0),[L,M,n.price,l,h]),C=L.every(({key:f})=>{const S=Number(M[f]||0);if(!(S>0))return!0;const R=l[f]!==void 0?l[f]:f===ee?l[ee]:void 0,B=h[f]||0,I=typeof R=="number"?Math.max(R-B,0):void 0;return!((typeof I=="number"?Math.min(S,I):S)>0)});return _(()=>{k(f=>{const S=new Set(L.map(({key:I})=>I));let R=!1;const B={};return Object.entries(f).forEach(([I,z])=>{S.has(I)?B[I]=z:R=!0}),R?B:f})},[L]),_(()=>{k({})},[n.id]),React.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":`product-title-${n.id}`,className:"fixed inset-0 z-50 flex items-stretch sm:items-center justify-center bg-black/40 p-0 sm:p-6",onClick:r,onTouchMove:f=>{f.target===f.currentTarget&&f.preventDefault()},onWheel:f=>{f.target===f.currentTarget&&f.preventDefault()}},React.createElement("div",{ref:y,tabIndex:-1,className:"w-full h-full sm:h-auto sm:max-w-3xl rounded-none sm:rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain overflow-y-auto max-h-none sm:max-h-[90vh]",style:{touchAction:"pan-y"},onClick:f=>f.stopPropagation()},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:`product-title-${n.id}`,className:"text-lg font-semibold text-slate-900"},n.name),React.createElement("button",{onClick:r,className:"rounded-full border border-transparent p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close"},React.createElement(Jt,{className:"h-5 w-5"}))),React.createElement("div",{className:"grid gap-6 p-5 lg:grid-cols-[minmax(0,1fr)_260px]"},React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-slate-100"},React.createElement("img",{src:g[0],onError:f=>{f.currentTarget.src=Ie(n.name)},alt:`${n.name} \u2013 photo`,className:"h-full w-full object-cover"})),n.description&&React.createElement("p",{className:"text-sm text-slate-600"},n.description),m.map(f=>{const S=i[f]||[],R=c[f]||[],B=f.toLowerCase().includes("color")||f==="Color";return React.createElement("div",{key:f,className:"rounded-2xl border border-[var(--surface-border)] bg-white/80 p-4 text-sm shadow-sm backdrop-blur"},React.createElement("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},f),S.length?React.createElement("div",{className:"flex items-center gap-2 text-xs text-slate-500"},React.createElement("button",{type:"button",onClick:()=>W(f),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:()=>j(f),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"Clear")):null),React.createElement("div",{className:"max-h-32 overflow-auto rounded-xl border border-[var(--surface-border)] bg-white/70 p-2"},React.createElement("div",{className:"flex flex-wrap gap-2 text-xs"},S.length===0?React.createElement("p",{className:"text-slate-500"},"No options"):S.map(I=>{const z=R.includes(I);return React.createElement("button",{type:"button",key:I,onClick:()=>$(f,I),className:q("inline-flex items-center gap-1 rounded-full border px-3 py-1 font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",z?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},B?React.createElement(Me,{name:I}):null,I)}))))}),React.createElement("div",{className:"space-y-3","aria-label":"Quantities"},L.length===0?React.createElement("p",{className:"text-xs text-slate-500"},"Select at least one option."):L.map(({key:f,sel:S})=>{const R=l[f]!==void 0?l[f]:f===ee?l[ee]:void 0,B=h[f]||0,I=typeof R=="number"?Math.max(R-B,0):void 0,z=typeof I=="number"&&I<=0,re=A[f];return React.createElement("div",{key:f,className:q("rounded-2xl border px-3 py-3 text-sm shadow-sm backdrop-blur sm:flex sm:items-center sm:justify-between",z?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/85 text-slate-700")},React.createElement("div",{className:"space-y-1 text-sm"},Object.entries(S).map(([N,D],Y)=>React.createElement("span",{key:`${N}-${D}`},Y>0?" \xB7 ":"",N==="Color"?React.createElement("span",{className:"inline-flex items-center gap-1"},React.createElement(Me,{name:D}),D):React.createElement("span",{className:"font-medium text-slate-900"},D))),Object.keys(S).length===0&&React.createElement("span",{className:"font-medium text-slate-900"},"Quantity"),typeof R=="number"?React.createElement("p",{className:"text-xs text-slate-500"},`Remaining: ${Math.max(R-B,0)}${B>0?` (of ${R})`:""}`):React.createElement("p",{className:"text-xs text-slate-500"},"No stock limit")),React.createElement("div",{className:"mt-2 sm:mt-0"},React.createElement(Xt,{value:Number(M[f]||0),onChange:N=>v(f,N),min:0,max:typeof I=="number"?I:void 0,onLimit:N=>{typeof N=="number"&&Number.isFinite(N)&&k(D=>({...D,[f]:N}))}})),re!==void 0?React.createElement("p",{className:"mt-2 text-xs font-medium text-rose-600 sm:ml-3 sm:mt-0 sm:text-right"},`Only ${re} available for this selection.`):null)}))),React.createElement("aside",{className:"glass-card rounded-3xl space-y-5 p-5"},React.createElement("div",{className:"space-y-2 text-sm"},React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Unit price"),React.createElement("span",{className:"font-semibold text-slate-900"},ye(n.price))),React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Selections"),React.createElement("span",{className:"font-medium text-slate-800"},L.length))),React.createElement("div",{className:"flex items-center justify-between rounded-2xl border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-4 py-3 text-sm font-medium text-brand"},React.createElement("span",{className:"uppercase tracking-[0.18em]"},"Line total"),React.createElement("span",{className:"text-base font-semibold text-brand"},ye(H))),React.createElement("p",{className:"text-xs text-slate-500"},"Add items to the cart and send the final list to WhatsApp when you are ready."),React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("button",{disabled:C,onClick:x,className:q("w-full rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",C?"pointer-events-none opacity-50":"hover:bg-brand-muted")},"Add to cart"),React.createElement("button",{onClick:r,className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Cancel"))))))}function Xt({id:a,value:r,onChange:t,min:o=0,max:n,onLimit:d}){const l=i=>{typeof n=="number"&&Number.isFinite(n)&&typeof d=="function"&&i>n&&d(n)},h=(i,m)=>{l(typeof m=="number"?m:i);let c=Math.max(o,i);return typeof n=="number"&&Number.isFinite(n)&&(c=Math.min(n,c)),c},y=Number(r)||0,g=typeof n=="number"&&Number.isFinite(n)&&y>=n;return React.createElement("div",{className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/70 shadow-sm backdrop-blur",role:"group","aria-label":"Quantity"},React.createElement("button",{onClick:()=>t(h((Number(r)||0)-1,(Number(r)||0)-1)),className:"rounded-l-full px-3 py-1.5 text-slate-700 transition hover:bg-brand-soft focus:outline-none focus-visible:outline-2 focus-visible:outline-brand touch-manipulation select-none","aria-label":"Decrease quantity"},"\u2212"),React.createElement("input",{id:a,inputMode:"numeric",pattern:"[0-9]*",value:String(r),onChange:i=>{const m=Number(i.target.value.replace(/[^0-9]/g,"")),c=Number.isFinite(m)?m:o;t(Number.isFinite(m)?h(c,c):o)},className:"w-14 appearance-none border-x border-[var(--surface-border)] bg-transparent px-2 py-1.5 text-center text-base sm:text-sm text-slate-900 focus:outline-none"}),React.createElement("button",{onClick:()=>t(h((Number(r)||0)+1,(Number(r)||0)+1)),className:q("rounded-r-full px-3 py-1.5 touch-manipulation select-none transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",g?"cursor-not-allowed text-slate-300":"text-slate-700 hover:bg-brand-soft"),"aria-label":"Increase quantity",disabled:g},"+"))}async function mr(a){var r;try{if((r=navigator.clipboard)!=null&&r.writeText)return await navigator.clipboard.writeText(a),!0}catch(t){}try{const t=document.createElement("textarea");return t.value=a,t.setAttribute("readonly",""),t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(t){return!1}}function ur({open:a,onClose:r,cart:t,productLookup:o}){const n=ae(null);at(a,n,r);const d=Fa(),l=X(()=>pr(t.items,t.subtotal,t.notes),[t.items,t.subtotal,t.notes]),h=t.items.some(u=>Number(u.qty)>0),y=`https://wa.me/${pe}?text=${encodeURIComponent(l)}`,g=`whatsapp://send?phone=${pe}&text=${encodeURIComponent(l)}`,i=/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent),[m,c]=w({});return _(()=>{c(u=>{const M=new Set((t.items||[]).map(k=>{if(!k)return null;const $=k.inventoryKey||ve(k.variants||{});return`${k.id||""}::${$}`}).filter(Boolean));let O=!1;const A={};return Object.entries(u).forEach(([k,$])=>{M.has(k)?A[k]=$:O=!0}),O?A:u})},[t.items]),React.createElement("div",{"aria-live":"polite"},React.createElement("div",{className:q("fixed inset-0 z-40 bg-black/40 transition-opacity",a?"opacity-100":"pointer-events-none opacity-0"),onClick:r,onTouchMove:u=>{u.preventDefault()},onTouchStart:u=>{u.preventDefault()},onWheel:u=>{u.preventDefault()},"aria-hidden":"true"}),React.createElement("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",className:q("fixed right-0 top-0 z-50 h-full w-full max-w-md transform border-l border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain",d?"transition-none":"transition-transform duration-200 ease-out",a?"translate-x-0":"translate-x-full")},React.createElement("div",{ref:n,className:"flex h-full flex-col"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:"cart-title",className:"text-lg font-semibold text-slate-900"},"Your cart"),React.createElement("button",{onClick:r,className:"rounded-full p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close cart"},React.createElement(Jt,{className:"h-5 w-5"}))),React.createElement("div",{className:"flex-1 overflow-y-auto p-4",style:{touchAction:"pan-y"}},t.items.length===0?React.createElement("p",{className:"text-sm text-slate-500"},"Your cart is empty."):React.createElement("ul",{className:"space-y-3"},t.items.map((u,M)=>{const O=o&&typeof o.get=="function"?o.get(u.id):void 0,A=O?qe(O.inventory):{},k=u.inventoryKey||ve(u.variants||{}),$=A[k]!==void 0?A[k]:k===ee?A[ee]:void 0;let W=0;t.items.forEach((C,f)=>{if(f===M||!C||C.id!==u.id)return;(C.inventoryKey||ve(C.variants||{}))===k&&(W+=Number(C.qty||0))});const j=typeof $=="number"?Math.max($-W,0):void 0,v=typeof j=="number"&&u.qty>j,L=typeof j=="number"?`Available: ${j}`:null,x=`${u.id||""}::${k}`,H=m[x];return React.createElement("li",{key:M,className:q("rounded-2xl border p-3 shadow-sm backdrop-blur transition",v?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/80 text-slate-700")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"font-semibold text-slate-900"},u.name),React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",u.sku),u.variants&&Object.keys(u.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1.5"},Object.entries(u.variants).map(([C,f])=>React.createElement("span",{key:C,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2 py-0.5 text-xs font-medium text-slate-600"},C==="Color"?React.createElement(React.Fragment,null,React.createElement(Me,{name:f}),`${C}: ${f}`):`${C}: ${f}`))),L&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},L),H!==void 0?React.createElement("p",{className:"mt-1 text-xs font-medium text-rose-600"},`Only ${H} available for this selection.`):null),React.createElement("button",{onClick:()=>t.removeIndex(M),className:"rounded-full p-1.5 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":`Remove ${u.name}`},React.createElement(Qa,{className:"h-4 w-4 text-slate-500"}))),React.createElement("div",{className:"mt-2 flex items-center justify-between"},React.createElement(Xt,{value:u.qty,onChange:C=>{const f=typeof j=="number"?Math.min(C,j):C;t.updateQty(M,f),c(S=>{const R=S[x];if(R===void 0)return S;if(f<R){const B={...S};return delete B[x],B}return S})},min:0,max:typeof j=="number"?j:void 0,onLimit:C=>{typeof C=="number"&&Number.isFinite(C)&&c(f=>({...f,[x]:C}))}}),React.createElement("div",{className:"text-sm text-slate-600"},ye(u.price)," \xD7 ",u.qty," = ",React.createElement("span",{className:"font-semibold text-slate-900"},ye(u.price*u.qty)))))}))),React.createElement("div",{className:"border-t border-[var(--surface-border)] bg-white/60 p-4 backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-sm text-slate-600"},React.createElement("span",null,"Subtotal"),React.createElement("span",{className:"font-semibold text-slate-900"},ye(t.subtotal))),React.createElement("label",{className:"mt-3 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Notes"),React.createElement("textarea",{value:t.notes,onChange:u=>t.setNotes(u.target.value),rows:2,className:"w-full resize-none rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Delivery preferences, color mix, etc."})),React.createElement("div",{className:"mt-3 flex gap-3"},React.createElement("button",{onClick:t.clear,className:"flex-1 rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear cart"),React.createElement("button",{type:"button",onClick:async()=>{if(!h){alert("Add at least one product before sending an order.");return}if(t.items.filter((k,$)=>{const W=o&&typeof o.get=="function"?o.get(k.id):void 0,j=W?qe(W.inventory):{},v=k.inventoryKey||ve(k.variants||{}),L=j[v]!==void 0?j[v]:v===ee?j[ee]:void 0;if(typeof L!="number")return!1;let x=0;t.items.forEach((C,f)=>{if(f===$||!C||C.id!==k.id)return;(C.inventoryKey||ve(C.variants||{}))===v&&(x+=Number(C.qty||0))});const H=Math.max(L-x,0);return k.qty>H}).length>0){alert("One or more items exceed available stock. Please adjust the quantities before sending the order.");return}try{await Le("createOrder",{currency:be,subtotal_cents:Math.round(t.subtotal*100),notes:t.notes||"",items:t.items.map((k,$)=>({product_id:k.id,sku:k.sku,name:k.name,quantity:Number(k.qty)||0,unit_price_cents:Math.round(Number(k.price||0)*100),subtotal_cents:Math.round(Number(k.price||0)*Number(k.qty||0)*100),variants:k.variants||{},inventory_key:k.inventoryKey||ve(k.variants||{})}))})}catch(k){console.error("Failed to record order",k)}try{await mr(l),alert("\u2705 Your list is copied! If WhatsApp doesn't open, you can paste it manually.")}catch(k){alert("\u{1F4CB} Please copy your order manually if WhatsApp doesn't open automatically.")}let M=!1;const O=()=>{M||(M=!0,t.clear(),t.setNotes(""))},A=()=>O();if(window.addEventListener("pagehide",A,{once:!0}),document.addEventListener("visibilitychange",function k(){document.hidden&&(O(),document.removeEventListener("visibilitychange",k))},{once:!0}),i)O(),window.location.href=g,setTimeout(()=>{try{window.open(y,"_blank","noopener,noreferrer")}catch(k){}},800);else{const k=window.open(y,"_blank","noopener,noreferrer");setTimeout(O,500)}},className:q("flex-1 inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",h?"bg-brand hover:bg-brand-muted":"pointer-events-none bg-[rgba(37,99,235,0.28)] text-white/70")},"Send via WhatsApp",React.createElement(Zt,{className:"h-4 w-4 text-white"})))))))}function pr(a,r,t){const o=(a||[]).filter(d=>Number(d.qty)>0);let n=`\u{1F6D2} *Order Request*

`;return o.forEach(d=>{n+=`\u2022 ${d.name} (SKU: ${d.sku})
`,d.variants&&Object.keys(d.variants).length>0&&(n+=`  Variants: ${Object.entries(d.variants).map(([l,h])=>`${l}: ${h}`).join(", ")}
`),n+=`  Qty: ${d.qty} \xD7 ${ye(d.price)} = ${ye(d.price*d.qty)}

`}),n+=`*Subtotal: ${ye(r)}*

`,(t||"").trim()&&(n+=`*Notes:* ${t.trim()}

`),n+="Please confirm availability and pricing. Thank you!",n}function br({addProduct:a,onNotify:r,catalogConfig:t,saveCatalogConfig:o}){var ua;const n=Array.isArray(t==null?void 0:t.categories)&&t.categories.length?t.categories:yt.filter(e=>e!=="All"),d=Array.isArray(t==null?void 0:t.families)&&t.families.length?t.families:wt().families,[l,h]=w(n[0]||"Phone Screens"),[y,g]=w(((ua=d[0])==null?void 0:ua.id)||"iphone"),i=d.find(e=>e&&e.id===y)||d[0]||{name:"iPhone",models:Fe},m=Array.isArray(i==null?void 0:i.models)?i.models:[];_(()=>{n.includes(l)||h(n[0]||"Phone Screens")},[n]),_(()=>{var e;d.some(s=>s&&s.id===y)||g(((e=d[0])==null?void 0:e.id)||"iphone")},[d]);const[c,u]=w("");_(()=>{u(e=>{const s=new Set(n),p=(e||"").trim(),b=s.has(p.replace(" \u2014",""))||p.endsWith(" \u2014");return!p||b?`${l} \u2014 `:e})},[l,n]);const[M,O]=w(""),[A,k]=w(""),[$,W]=w(""),[j,v]=w([]),[L,x]=w([]),[H,C]=w(null),[f,S]=w(!1),[R,B]=w({}),[I,z]=w(!1),[re,N]=w(""),[D,Y]=w({}),[V,oe]=w(!1),[le,ge]=w({}),we=e=>String(e||"").toLowerCase().includes("multi"),Ee=e=>we(e==null?void 0:e.mode),Ct=e=>we(e)?"multi":"single",St=e=>e==="familyModels"?"familyModels":"static",T=(e,s)=>{if(!e||typeof e!="object")return e;const p={...e};return p.mode=Ct(e.mode),p.optionsSource=St(e.optionsSource),p.options=Array.isArray(e.options)?e.options:[],s==="customer"?p.fieldType="select":p.fieldType=e.fieldType==="checkbox"?"checkbox":"select",p},Q=e=>({info:((e==null?void 0:e.info)||[]).map(s=>T(s,"info")).filter(Boolean),customer:((e==null?void 0:e.customer)||[]).map(s=>T(s,"customer")).filter(Boolean)}),te=()=>{var p;const e=(p=t==null?void 0:t.groupOverridesByCategoryFamily)==null?void 0:p[l],s=e==null?void 0:e[y];return!s||typeof s!="object"?null:{info:s.info&&typeof s.info=="object"?s.info:{},customer:s.customer&&typeof s.customer=="object"?s.customer:{}}},Re=()=>{var p;const e=(p=t==null?void 0:t.groupHiddenByCategoryFamily)==null?void 0:p[l],s=e==null?void 0:e[y];return!s||typeof s!="object"?{info:[],customer:[]}:{info:Array.isArray(s.info)?s.info:[],customer:Array.isArray(s.customer)?s.customer:[]}},st=e=>{const s=te(),p=Re(),b=(E,P)=>{const K=new Set(((p==null?void 0:p[P])||[]).map(G=>String(G))),F=(s==null?void 0:s[P])||{},J=(Array.isArray(E)?E:[]).filter(G=>G&&!K.has(String(G.id))).map(G=>{const se=F[String(G.id)];return T(se&&typeof se=="object"?{...G,...se}:G,P)});return Object.keys(F||{}).forEach(G=>{if(K.has(String(G))||J.some(ne=>String(ne.id)===String(G)))return;const se=F[G];se&&typeof se=="object"&&J.push(T({id:G,...se},P))}),J.filter(Boolean)};return{info:b(e==null?void 0:e.info,"info"),customer:b(e==null?void 0:e.customer,"customer")}},xe=(e,s)=>{x([]),C(null),B(p=>({...p,[e]:s}))},De=(e,s)=>B(p=>{x([]),C(null);const b=Array.isArray(p[e])?p[e]:[];return{...p,[e]:b.includes(s)?b.filter(E=>E!==s):[...b,s]}});function nt(e){x([]),C(null);const s=Array.from(e.target.files||[]);if(!s.length)return;const p=s.map(b=>new Promise(E=>{const P=new FileReader;P.onload=()=>E(String(P.result||"")),P.readAsDataURL(b)}));Promise.all(p).then(b=>v(E=>[...E,...b]))}const Ce=e=>Array.isArray(e)&&e.length?e[0]:e!=null?e:"",At={"Phone Screens":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"display",label:"Display type/quality",type:"select",options:["OLED \u2013 OEM","OLED \u2013 AAA","LCD \u2013 OEM","LCD \u2013 AAA"]},{key:"frame",label:"Frame",type:"select",options:["With frame","Without frame"]}],also:[{key:"frontColor",label:"Front color",type:"select",options:["Black","White"]},{key:"retention",label:"True Tone/Face ID retention",type:"checkbox"}],optional:[{key:"adhesive",label:"Pre-installed adhesive / waterproof gasket",type:"checkbox"}],name:e=>`Screen \u2014 ${Ce(e.models)} ${e.display?`${String(e.display).split(" ")[0]}`:""}`.trim(),specs:e=>[e.display,e.frame,e.frontColor].filter(Boolean)},"Back Glass":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"colors",label:"Colors / finish",type:"multiselect",options:Ye}],also:[{key:"adhesive",label:"Adhesive pre-installed",type:"checkbox"},{key:"rings",label:"With camera rings",type:"checkbox"}],optional:[{key:"grade",label:"Quality grade",type:"select",options:Wt}],name:e=>`Back Glass \u2014 ${Ce(e.models)}`.trim(),specs:e=>[Ce(e.colors)||null,e.grade,e.adhesive?"Adhesive":null,e.rings?"Camera rings":null].filter(Boolean)},"Power Banks":{must:[{key:"capacity",label:"Capacity",type:"select",options:ja},{key:"ports",label:"Output ports",type:"select",options:$t}],also:[{key:"standard",label:"Standard",type:"select",options:We}],optional:[{key:"colour",label:"Colour",type:"select",options:Ye}],name:e=>`Power bank \u2014 ${e.capacity||""}`.trim(),specs:e=>[e.capacity,e.ports,e.standard].filter(Boolean)},"Screen Protectors":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:Ra},{key:"pack",label:"Pack",type:"select",options:ka}],also:[{key:"finish",label:"Finish",type:"select",options:Na},{key:"coverage",label:"Coverage",type:"select",options:Ca}],optional:[],name:e=>`Protector \u2014 ${Ce(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,e.finish,e.coverage].filter(Boolean)},Batteries:{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"grade",label:"Grade",type:"select",options:Wt}],also:[],optional:[{key:"capacity",label:"Capacity (mAh)",type:"text",placeholder:"e.g. 3000"}],name:e=>`Battery \u2014 ${Ce(e.models)}`.trim(),specs:e=>[e.grade,e.capacity].filter(Boolean)},"Mobile Phones":{must:[{key:"model",label:"Model",type:"text",placeholder:"e.g., iPhone 13"},{key:"cond",label:"Condition/grade",type:"select",options:Gt},{key:"sim",label:"SIM",type:"select",options:Ba}],also:[{key:"connect",label:"Connectivity",type:"select",options:_a},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Kt},{key:"ram",label:"RAM",type:"multiselect",options:Ht},{key:"color",label:"Color",type:"text"},{key:"inbox",label:"Accessories in box",type:"text",placeholder:"Cable, charger"}],name:e=>`${e.model||""} ${e.cond||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.cond,e.sim,e.connect].filter(Boolean)},Tablets:{must:[{key:"model",label:"Model",type:"text",placeholder:"iPad 10th Gen"},{key:"conn",label:"Connectivity",type:"select",options:Ma}],also:[{key:"screen",label:"Screen size",type:"text",placeholder:'10.9"'},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Kt},{key:"ram",label:"RAM",type:"multiselect",options:Ht},{key:"cond",label:"Condition/grade",type:"select",options:Gt},{key:"color",label:"Color",type:"text"},{key:"compat",label:"Pencil/keyboard compatibility",type:"text"}],name:e=>`${e.model||""} ${e.conn||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.conn,e.screen,e.cond].filter(Boolean)},"Phone Cases":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:Ea}],also:[{key:"color",label:"Color",type:"multiselect",options:Ye}],optional:[{key:"pattern",label:"Pattern / style",type:"text"}],name:e=>`Case \u2014 ${Ce(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,Ce(e.color)||null].filter(Boolean)},Cables:{must:[{key:"connector",label:"Connector",type:"select",options:Et},{key:"length",label:"Length",type:"select",options:Dt}],also:[{key:"rating",label:"Power rating",type:"select",options:Ut},{key:"durability",label:"Durability",type:"select",options:Aa}],optional:[{key:"cert",label:"Certs",type:"select",options:Sa}],name:e=>`Cable \u2014 ${e.connector||""} ${e.length?`(${e.length})`:""}`.trim(),specs:e=>[e.connector,e.length,e.rating].filter(Boolean)},Chargers:{must:[{key:"wattage",label:"Wattage",type:"select",options:Pa||["20W","30W","45W","65W"]},{key:"ports",label:"Ports",type:"select",options:$t}],also:[{key:"standard",label:"Standard",type:"select",options:We},{key:"plug",label:"Plug type",type:"select",options:Oa}],optional:[],name:e=>`Charger \u2014 ${e.wattage||""}`.trim(),specs:e=>[e.wattage,e.ports].filter(Boolean)},Earphones:{must:[{key:"type",label:"Type",type:"select",options:["Wired","TWS"]}],also:[{key:"connector",label:"Connector / Standard",type:"select",options:[...Et,...We]}],optional:[{key:"color",label:"Color",type:"select",options:Ye}],name:e=>`Earphones \u2014 ${e.type||""}`.trim(),specs:e=>[e.type,e.connector].filter(Boolean)},"Charging Ports":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"type",label:"Port type",type:"select",options:["USB-C","Lightning","Micro-USB"]}],also:[],optional:[{key:"solderRequired",label:"Solder required",type:"checkbox"}],name:e=>`Charging port \u2014 ${Ce(e.models)}`.trim(),specs:e=>[e.type,e.solderRequired?"Solder":null].filter(Boolean)},"Face ID":{must:[{key:"models",label:"Phone models",type:"phoneModels",allowedBrands:["iPhone"]},{key:"service",label:"Service",type:"select",options:["Repair","Replace","Calibration"]}],also:[],optional:[],name:e=>`Face ID \u2014 ${Ce(e.models)}`.trim(),specs:e=>[e.service].filter(Boolean)}},ta=e=>{const s=At[e]||{must:[],also:[],optional:[]},p=[...s.must||[],...s.also||[],...s.optional||[]],b={info:[],customer:[]};return p.forEach(E=>{if(!E||!E.key)return;const P={id:E.key,label:E.label,schemaKey:E.key,fieldType:E.type,options:Array.isArray(E.options)?E.options:[]};if(E.type==="phoneModels"){b.customer.push({...P,key:"Model",mode:"multi",optionsSource:"familyModels"});return}if(E.type==="multiselect"){b.customer.push({...P,key:vt(E.label,E.key),mode:"multi",optionsSource:"static"});return}b.info.push({...P,mode:E.type==="multiselect"?"multi":"single",optionsSource:"static"})}),b},aa=()=>{var s;const e=(s=t==null?void 0:t.groupsByCategory)==null?void 0:s[l];return e&&e.info&&e.customer?e:null},he=X(()=>{const e=aa(),s=Q(e||ta(l)),p=st(s),b=(p.customer||[]).map(E=>E&&E.key==="Model"?{...E,label:`${(i==null?void 0:i.name)||"Phone"} models`}:E);return{...p,customer:b}},[t,l,y]),ra=async e=>{const s=Xe(t);s.groupsByCategory=s.groupsByCategory||{},s.groupsByCategory[l]=e,await o(s)},ot=async()=>{const e=aa();if(e)return e;const s=ta(l);return await ra(s),s};_(()=>{const e={};(he.info||[]).forEach(s=>{!s||!s.schemaKey||(s.fieldType==="select"||s.fieldType==="number"||s.fieldType==="text"?e[s.schemaKey]="":s.fieldType==="checkbox"?e[s.schemaKey]=!1:Ee(s)?e[s.schemaKey]=[]:e[s.schemaKey]="")}),(he.customer||[]).forEach(s=>{!s||!s.schemaKey||(Ee(s)?e[s.schemaKey]=[]:e[s.schemaKey]="")}),B(e)},[l,he]);const[Se,me]=w(null),[ue,je]=w({scope:"info",id:null,label:"",key:"",mode:"single",fieldType:"select",optionsSource:"static",optionsText:""}),[sa,Ue]=w(""),[qr,na]=w(""),[oa,Pt]=w(""),[Ae,$e]=w({id:null,name:"",modelsText:""}),xr=e=>{try{return JSON.parse(JSON.stringify(e))}catch(s){return e}},hr=e=>String(e||"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),Ge=async e=>{const s=Xe(t),p=xr(s),b=(typeof e=="function"?e(p):p)||p;await o(b)},vr=()=>{$e({id:null,name:"",modelsText:""}),me({type:"family"})},wr=()=>{Pt(""),me({type:"category"})},Er=async()=>{const e=String(oa||"").trim();e&&(await Ge(s=>{const p=Array.isArray(s.categories)?[...s.categories]:[];return p.includes(e)||p.push(e),s.categories=p,s}),h(e),Pt(""),me(null))},Rr=async e=>{const s=String(e||"").trim();s&&confirm(`Remove category "${s}"? Existing products will still keep their category text.`)&&await Ge(p=>(p.categories=(Array.isArray(p.categories)?p.categories:[]).filter(b=>b!==s),p))},Nr=e=>{const s=Array.isArray(e==null?void 0:e.models)?e.models:[];$e({id:(e==null?void 0:e.id)||null,name:(e==null?void 0:e.name)||"",modelsText:s.join(`
`)})},kr=async()=>{const e=String(Ae.name||"").trim();if(!e)return;const s=String(Ae.modelsText||"").split(`
`).map(P=>P.trim()).filter(Boolean),p=Array.from(new Set(s)),b=Ae.id?String(Ae.id):null;let E=b||hr(e)||`family_${Date.now()}`;await Ge(P=>{const K=Array.isArray(P.families)?[...P.families]:[];if(b)return P.families=K.map(F=>F&&F.id===b?{...F,name:e,models:p}:F),P;{const F=E;let J=2;for(;K.some(G=>G&&G.id===E);)E=`${F}_${J++}`;K.push({id:E,name:e,models:p})}return P.families=K,P}),g(E),$e({id:null,name:"",modelsText:""}),me(null)},Cr=async e=>{const s=String((e==null?void 0:e.id)||"").trim(),p=String((e==null?void 0:e.name)||"").trim();s&&confirm(`Remove family "${p||s}"? Existing products will still keep their family meta.`)&&await Ge(b=>(b.families=(Array.isArray(b.families)?b.families:[]).filter(E=>E&&E.id!==s),b))},la=async e=>{await ot(),Ue(""),na(""),je({scope:e,id:null,label:"",key:"",mode:e==="customer"?"multi":"single",fieldType:"select",optionsSource:"static",optionsText:""}),me({type:"group"})},ia=async(e,s)=>{await ot(),Ue(""),na("");const p=e==="info"&&s.fieldType==="checkbox",b=p?`Yes
No`:(Array.isArray(s.options)?s.options:[]).join(`
`);je({scope:e,id:s.id,label:s.label||"",key:s.key||"",mode:p?"single":we(s.mode)?"multi":"single",fieldType:"select",optionsSource:s.optionsSource||"static",optionsText:b}),me({type:"group"})},Sr=e=>Array.from(new Set(String(e||"").split(/[,;\n]/g).map(s=>s.trim()).filter(Boolean))),Yr=e=>{const s=Array.from(new Set((Array.isArray(e)?e:[]).map(p=>String(p).trim()).filter(Boolean)));je(p=>({...p,optionsText:s.join(`
`)}))},Vr=()=>{},Qr=()=>{},ca=async(e,s)=>{await ot();const p=String((s==null?void 0:s.id)||"").trim();p&&(await Ge(b=>{b.groupHiddenByCategoryFamily=b.groupHiddenByCategoryFamily&&typeof b.groupHiddenByCategoryFamily=="object"?b.groupHiddenByCategoryFamily:{},b.groupOverridesByCategoryFamily=b.groupOverridesByCategoryFamily&&typeof b.groupOverridesByCategoryFamily=="object"?b.groupOverridesByCategoryFamily:{},b.groupHiddenByCategoryFamily[l]=b.groupHiddenByCategoryFamily[l]||{},b.groupHiddenByCategoryFamily[l][y]=b.groupHiddenByCategoryFamily[l][y]||{info:[],customer:[]};const E=e==="customer"?"customer":"info",P=Array.isArray(b.groupHiddenByCategoryFamily[l][y][E])?b.groupHiddenByCategoryFamily[l][y][E]:[];P.includes(p)||P.push(p),b.groupHiddenByCategoryFamily[l][y][E]=P,b.groupOverridesByCategoryFamily[l]=b.groupOverridesByCategoryFamily[l]||{},b.groupOverridesByCategoryFamily[l][y]=b.groupOverridesByCategoryFamily[l][y]||{info:{},customer:{}};const K=b.groupOverridesByCategoryFamily[l][y][E];return K&&typeof K=="object"&&delete K[p],b}),B(b=>{const E={...b},P=s.schemaKey||s.id;return delete E[P],E}))},Ar=async()=>{var se,ne;const e=await ot(),s=ue.scope,p=String(ue.label||"").trim();if(!p){Ue("Group name is required.");return}const b=ue.mode==="multi"?"multi":"single",E=ue.optionsSource==="familyModels"?"familyModels":"static",P=E==="familyModels"?[]:Sr(ue.optionsText);if(s==="info"&&E!=="familyModels"&&P.length===0){Ue("Add at least one option (comma or new line).");return}const K=!ue.id,F=ue.id||`og_${Date.now()}`,J=K?F:(se=(e[s]||[]).find(U=>String(U.id)===String(F)))==null?void 0:se.schemaKey,G={id:F,label:p,schemaKey:J||F,fieldType:"select",options:P,optionsSource:E,mode:b};if(s==="customer"){const U=K?"":(ne=(e.customer||[]).find(Z=>Z&&String(Z.id)===String(F)))==null?void 0:ne.key;G.key=String(U||"").trim()||vt(p,F)}if(K){const Z=[...s==="customer"?e.customer||[]:e.info||[],G];if(s==="customer"&&b==="multi"&&Z.filter(Be=>we(Be==null?void 0:Be.mode)).length>2){Ue("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}const de=s==="customer"?{...e,customer:Z}:{...e,info:Z};await ra(de)}else{if(s==="customer"&&b==="multi"&&(Array.isArray(he.customer)?he.customer:[]).map(ie=>String(ie.id)===String(F)?{...ie,...G}:ie).filter(ie=>we(ie==null?void 0:ie.mode)).length>2){Ue("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}await Ge(U=>{U.groupOverridesByCategoryFamily=U.groupOverridesByCategoryFamily&&typeof U.groupOverridesByCategoryFamily=="object"?U.groupOverridesByCategoryFamily:{},U.groupHiddenByCategoryFamily=U.groupHiddenByCategoryFamily&&typeof U.groupHiddenByCategoryFamily=="object"?U.groupHiddenByCategoryFamily:{},U.groupOverridesByCategoryFamily[l]=U.groupOverridesByCategoryFamily[l]||{},U.groupOverridesByCategoryFamily[l][y]=U.groupOverridesByCategoryFamily[l][y]||{info:{},customer:{}};const Z=s==="customer"?"customer":"info";U.groupOverridesByCategoryFamily[l][y][Z]=U.groupOverridesByCategoryFamily[l][y][Z]||{},U.groupOverridesByCategoryFamily[l][y][Z][String(F)]=G,U.groupHiddenByCategoryFamily[l]=U.groupHiddenByCategoryFamily[l]||{},U.groupHiddenByCategoryFamily[l][y]=U.groupHiddenByCategoryFamily[l][y]||{info:[],customer:[]};const de=Array.isArray(U.groupHiddenByCategoryFamily[l][y][Z])?U.groupHiddenByCategoryFamily[l][y][Z]:[];return U.groupHiddenByCategoryFamily[l][y][Z]=de.filter(ie=>String(ie)!==String(F)),U})}me(null)},Jr=({f:e})=>{var b,E;if(!e)return null;const s="mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500",p="w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand";if(e.type==="select")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:s},e.label),React.createElement("select",{value:(b=R[e.key])!=null?b:"",onChange:P=>xe(e.key,P.target.value),className:p},(e.options||[]).map(P=>React.createElement("option",{key:P,value:P},P))));if(e.type==="text"||e.type==="number")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:s},e.label),React.createElement("input",{type:e.type,value:(E=R[e.key])!=null?E:"",onChange:P=>xe(e.key,e.type==="number"?P.target.value.replace(/[^0-9.]/g,""):P.target.value),placeholder:e.placeholder||"",className:p}));if(e.type==="checkbox")return React.createElement("label",{className:"inline-flex items-center gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:!!R[e.key],onChange:P=>xe(e.key,P.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),React.createElement("span",null,e.label));if(e.type==="multiselect"){const P=e.options||[],K=Array.isArray(R[e.key])?R[e.key]:[];return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},e.label),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>xe(e.key,P),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>xe(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},P.map(F=>{const J=K.includes(F),G=et[F]!==void 0||/color/i.test(e.label);return React.createElement("button",{type:"button",key:F,onClick:()=>De(e.key,F),className:q("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",J?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},G?React.createElement(React.Fragment,null,React.createElement(Me,{name:F}),F):F)})))}if(e.type==="phoneModels"){const P=m,K=Array.isArray(R[e.key])?R[e.key]:[];return React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-xs text-slate-500"},React.createElement("span",{className:"font-semibold text-slate-800"},`${(i==null?void 0:i.name)||"Phone"} models`),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{type:"button",onClick:()=>xe(e.key,P),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>xe(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},P.map(F=>{const J=K.includes(F),G=String(F).startsWith("iPhone ")?String(F).replace("iPhone ",""):F;return React.createElement("button",{type:"button",key:F,onClick:()=>{const se=Array.isArray(R[e.key])?R[e.key]:[];xe(e.key,J?se.filter(ne=>ne!==F):[...se,F])},className:q("rounded-full border px-2.5 py-1 font-medium transition",J?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},G)})))}return null},Qe=e=>e.schemaKey||e.id,da=e=>e?e.optionsSource==="familyModels"?m:Array.isArray(e.options)?e.options:[]:[],Ot=X(()=>{const e={};return(he.customer||[]).forEach(s=>{if(!s)return;const p=s.key||vt(s.label,s.schemaKey||s.id),b=Qe(s),E=R[b];if(Ee(s)){const J=(Array.isArray(E)?E:E==null?[]:[E]).map(G=>String(G).trim()).filter(Boolean);J.length&&(e[p]=Array.from(new Set(J)));return}const P=Array.isArray(E)?E[0]:E,K=String(P||"").trim();K&&(e[p]=[K])}),e},[he,R]),lt=X(()=>ya(Ot).slice().sort((s,p)=>s.key.localeCompare(p.key)),[Ot]),Ne=X(()=>lt.map(e=>e.key),[lt]);_(()=>{I&&Y(e=>{const s={};Ne.forEach(b=>{s[b]=Object.prototype.hasOwnProperty.call(e,b)?e[b]:""});const p=Object.keys(e);return p.length===Ne.length&&p.every(b=>Object.prototype.hasOwnProperty.call(s,b)&&s[b]===e[b])?e:s})},[I,Ne]),_(()=>{V&&ge(e=>{const s={};Ne.forEach(b=>{s[b]=Object.prototype.hasOwnProperty.call(e,b)?e[b]:""});const p=Object.keys(e);return p.length===Ne.length&&p.every(b=>Object.prototype.hasOwnProperty.call(s,b)&&s[b]===e[b])?e:s})},[V,Ne]);const Pr=()=>{const e=Number(re);if(!Number.isFinite(e)||e<0)return;const s=String(Math.floor(e));Y(p=>{const b={...p};return Ne.forEach(E=>{b[E]=s}),b})},Or=()=>{Y(e=>{const s={...e};return Ne.forEach(p=>{s[p]=""}),s}),N("")},Br=()=>{const e=Number(A);if(!Number.isFinite(e)||e<0)return;const s=String(e);ge(p=>{const b={...p};return Ne.forEach(E=>{E!==ee&&(b[E]=s)}),b})},_r=()=>{ge(e=>{const s={...e};return Ne.forEach(p=>{s[p]=""}),s})},ma=e=>{const s=Object.entries(e||{}).filter(([p,b])=>b!=null&&String(b).trim()!=="").sort(([p],[b])=>p.localeCompare(b));return s.length?s.map(([p,b])=>`${p}: ${b}`).join(" \u2022 "):"Base product"},Mr=()=>{const e=At[l]||{must:[],also:[],optional:[],name:null,specs:null},s=e.name&&e.name(R)||`${l} item`,p=c.trim()||s,b={...Ot||{}},E={};if(I&&Object.entries(D||{}).forEach(([ne,U])=>{const Z=String(U!=null?U:"").trim();if(!Z)return;const de=Number(Z);!Number.isFinite(de)||de<0||(E[ne&&ne.trim()||ee]=Math.floor(de))}),V){const ne=Number(A),U=Number.isFinite(ne)?ne:0,Z={};Object.entries(le||{}).forEach(([de,ie])=>{if(de===ee)return;const Be=String(ie!=null?ie:"").trim();if(!Be)return;const it=Number(Be);!Number.isFinite(it)||it<0||Math.abs(it-U)<1e-9||(Z[de&&de.trim()||ee]=it)}),Object.keys(Z).length&&(b[ut]=Z)}const P=[];(he.info||[]).forEach(ne=>{if(!ne)return;const U=Qe(ne),Z=String(ne.label||ne.key||ne.id||"").trim();if(ne.fieldType==="checkbox"){R[U]&&P.push(Z||ne.label);return}if(Ee(ne)){const ie=Array.isArray(R[U])?R[U].map(Be=>String(Be).trim()).filter(Boolean):[];if(!ie.length)return;P.push(Z?`${Z}: ${ie.join(", ")}`:ie.join(", "));return}const de=String(R[U]||"").trim();de&&P.push(Z?`${Z}: ${de}`:de)});const K=String((i==null?void 0:i.name)||"").trim(),J=[...K?[`${ht}${K}`]:[],...Array.from(new Set(P)).filter(Boolean)],G=Array.from(new Set((j||[]).filter(Boolean))),se={id:`owner-${Date.now()}`,name:p,sku:M.trim()||`SKU-${(Math.random()*1e6|0).toString(36)}`,category:l,price:Number(A)||0,description:$.trim(),image:G[0]||void 0,images:G.length?G:void 0,specs:J,variants:b,inventory:I?E:void 0};return ce(se)},Ir=()=>{var P;const e=[],s=At[l]||{must:[]},p=Number(A);(!Number.isFinite(p)||p<=0)&&e.push("Price must be greater than 0");const b=(he.customer||[]).find(K=>K&&(K.key==="Model"||K.schemaKey==="models"));if(b){const K=Qe(b),F=R[K];Ee(b)?(Array.isArray(F)?F:[]).length===0&&e.push("Please select at least one model"):String(F||"").trim()||e.push("Please select a model")}const E=(s.must||[]).find(K=>K.key==="model");return E&&(String((P=R[E.key])!=null?P:"").trim()||e.push("Model is required")),I&&Object.entries(D||{}).find(([F,J])=>{const G=String(J!=null?J:"").trim();if(!G)return!1;const se=Number(G);return!Number.isFinite(se)||se<0})&&e.push("Stock quantities must be 0 or greater (or leave blank for unlimited)."),V&&Object.entries(le||{}).find(([F,J])=>{if(F===ee)return!1;const G=String(J!=null?J:"").trim();if(!G)return!1;const se=Number(G);return!Number.isFinite(se)||se<0})&&e.push("Price overrides must be 0 or greater (or leave blank to use the base price)."),e},jr=async()=>{const e=Ir();if(e.length){x(e),C(null);return}const s=Mr();if(s){S(!0);try{const p=await a(s),b=!!(p&&p.persisted);x([]),b?C({type:"success",message:"Product added to catalogue."}):(C({type:"warning",message:"Product saved locally. Supabase sync pending."}),r==null||r("warning","Supabase connection unavailable. Product stored locally until sync succeeds.")),u(`${l} \u2014 `),O(""),k(""),W(""),v([]),B({}),z(!1),N(""),Y({}),oe(!1),ge({})}catch(p){console.error("Failed to add product:",p),C({type:"error",message:"Could not save product. Check your connection and try again."}),r==null||r("error","Could not add product. Check your connection and try again.")}finally{S(!1)}}};return React.createElement("section",{"aria-labelledby":"owner-title",className:"mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-8"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 sm:p-8 shadow-soft-xl"},React.createElement("div",{className:"space-y-2"},React.createElement("h2",{id:"owner-title",className:"text-2xl font-semibold text-slate-900"},"Owner \u2014 Add products"),React.createElement("p",{className:"text-sm text-slate-600"},"Only essentials. Fields shift by category. Keep data clean; the catalogue updates instantly.")),H&&React.createElement("div",{className:q("rounded-2xl border px-4 py-3 text-sm shadow-sm",H.type==="error"?"border-rose-200 bg-rose-50/80 text-rose-700":H.type==="warning"?"border-amber-200 bg-amber-50/80 text-amber-700":"border-emerald-200 bg-emerald-50/80 text-emerald-700")},H.message),L.length>0&&React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700 shadow-sm"},React.createElement("p",{className:"font-semibold"},"Please fix the following:"),React.createElement("ul",{className:"mt-1 list-disc space-y-0.5 pl-4"},L.map((e,s)=>React.createElement("li",{key:s},e)))),React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Essentials"),React.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family"),React.createElement("button",{type:"button",onClick:vr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:y,onChange:e=>{x([]),C(null),g(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},(d||[]).map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Category"),React.createElement("button",{type:"button",onClick:wr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:l,onChange:e=>{x([]),C(null),h(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},n.map(e=>React.createElement("option",{key:e,value:e},e)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:A,onChange:e=>{x([]),C(null),k(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Name"),React.createElement("input",{value:c,onChange:e=>{x([]),C(null),u(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"SKU"),React.createElement("input",{value:M,onChange:e=>{x([]),C(null),O(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"md:col-span-2 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Short description"),React.createElement("textarea",{rows:3,value:$,onChange:e=>{x([]),C(null),W(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:nt}),j.length>0&&React.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},j.map((e,s)=>React.createElement("div",{key:s,className:"relative"},React.createElement("img",{src:e,alt:`preview ${s+1}`,className:"h-20 w-20 overflow-hidden rounded-xl border border-[var(--surface-border)] object-cover"}),React.createElement("button",{type:"button",onClick:()=>{x([]),C(null),v(p=>p.filter((b,E)=>E!==s))},className:"absolute -right-1 -top-1 rounded-full border border-[var(--surface-border)] bg-white px-1 text-xs shadow","aria-label":`Remove photo ${s+1}`},"\xD7"))))))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Product information"),React.createElement("button",{type:"button",onClick:()=>la("info"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(he.info||[]).map(e=>{const s=Qe(e);return React.createElement(Ua,{key:e.id,label:e.label,mode:e.mode,fieldType:e.fieldType,options:da(e),value:R[s],onChange:p=>xe(s,p),onEdit:()=>ia("info",e),onRemove:()=>ca("info",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Customer options"),React.createElement("button",{type:"button",onClick:()=>la("customer"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(he.customer||[]).map(e=>{const s=Qe(e);return React.createElement($a,{key:e.id,label:e.label,mode:e.mode,options:da(e),value:R[s],onChange:p=>xe(s,p),onEdit:()=>ia("customer",e),onRemove:()=>ca("customer",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-3"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Variant prices (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-xs font-semibold text-slate-700 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:V,onChange:e=>oe(e.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),"Override prices")),React.createElement("p",{className:"text-sm text-slate-600"},"Optional. Leave blank to use the base price for a selection."),V&&React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-2"},React.createElement("div",{className:"text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},`Base price: ${A?ye(Number(A)||0):"\u2014"}`),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:Br,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Copy base to all"),React.createElement("button",{type:"button",onClick:_r,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear all"))),React.createElement("div",{className:"max-h-72 space-y-2 overflow-y-auto pr-1"},lt.filter(({key:e})=>e!==ee).map(({key:e,selection:s})=>{var p;return React.createElement("label",{key:e,className:"flex items-center justify-between gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner"},React.createElement("span",{className:"flex-1 text-xs font-semibold text-slate-700"},ma(s)),React.createElement("input",{type:"number",min:0,step:"0.01",inputMode:"decimal",value:(p=le[e])!=null?p:"",onChange:b=>ge(E=>({...E,[e]:b.target.value})),placeholder:"Default",className:"w-32 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3 py-2 text-right text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-3"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Stock limits (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-xs font-semibold text-slate-700 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:I,onChange:e=>z(e.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),"Limit stock")),React.createElement("p",{className:"text-sm text-slate-600"},"Optional. Leave blank to keep a variant unlimited."),I&&React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("label",{className:"block flex-1 text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Default quantity"),React.createElement("input",{type:"number",min:0,step:"1",value:re,onChange:e=>N(e.target.value),placeholder:"e.g. 10",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:Pr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Apply to all"),React.createElement("button",{type:"button",onClick:Or,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear all"))),React.createElement("div",{className:"max-h-72 space-y-2 overflow-y-auto pr-1"},lt.map(({key:e,selection:s})=>{var p;return React.createElement("label",{key:e,className:"flex items-center justify-between gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner"},React.createElement("span",{className:"flex-1 text-xs font-semibold text-slate-700"},ma(s)),React.createElement("input",{type:"number",min:0,step:"1",inputMode:"numeric",value:(p=D[e])!=null?p:"",onChange:b=>Y(E=>({...E,[e]:b.target.value})),placeholder:"Unlimited",className:"w-32 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3 py-2 text-right text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})))),React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end"},React.createElement("button",{type:"button",onClick:jr,disabled:f,className:q("inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",f?"bg-brand/50 cursor-not-allowed opacity-70":"bg-brand hover:bg-brand-muted")},f?"Saving...":"Add Product"),React.createElement("button",{type:"button",onClick:()=>{var e;return(e=window.__setOwnerManage)==null?void 0:e.call(window,!0)},className:"inline-flex items-center justify-center rounded-full border border-[var(--surface-border)] bg-white/70 px-6 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage catalogue")),React.createElement(Rt,{open:(Se==null?void 0:Se.type)==="group",title:ue.id?"Edit option group":"Add option group",onClose:()=>me(null),actions:React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:()=>me(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Cancel"),React.createElement("button",{type:"button",onClick:Ar,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Save"))},sa&&React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},sa),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Group name"),React.createElement("input",{value:ue.label,onChange:e=>je(s=>({...s,label:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Selection"),React.createElement("select",{value:ue.mode,onChange:e=>je(s=>({...s,mode:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"single"},"Single"),React.createElement("option",{value:"multi"},"Multi"))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options source"),React.createElement("select",{value:ue.optionsSource,onChange:e=>je(s=>({...s,optionsSource:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"static"},"Custom list"),ue.scope==="customer"&&React.createElement("option",{value:"familyModels"},"Use family models")))),ue.optionsSource!=="familyModels"&&React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options (comma or new line)"),React.createElement("textarea",{rows:6,value:ue.optionsText,onChange:e=>je(s=>({...s,optionsText:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Option 1, Option 2, Option 3\\nOption 4"}))),React.createElement(Rt,{open:(Se==null?void 0:Se.type)==="category",title:"Manage categories",onClose:()=>me(null),actions:React.createElement("button",{type:"button",onClick:()=>me(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-end gap-2"},React.createElement("label",{className:"flex-1 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"New category"),React.createElement("input",{value:oa,onChange:e=>Pt(e.target.value),placeholder:"e.g. Camera parts",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("button",{type:"button",onClick:Er,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Add")),React.createElement("div",{className:"space-y-2"},(n||[]).map(e=>React.createElement("div",{key:e,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{h(e),me(null)},className:q("flex-1 text-left font-medium",e===l?"text-slate-900":"text-slate-700")},e),React.createElement("button",{type:"button",onClick:()=>Rr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove category ${e}`},"\xD7")))))),React.createElement(Rt,{open:(Se==null?void 0:Se.type)==="family",title:"Manage families",onClose:()=>me(null),actions:React.createElement("button",{type:"button",onClick:()=>me(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"space-y-2"},React.createElement("p",{className:"text-sm text-slate-600"},"Families control which model list appears in the phone model picker."),React.createElement("div",{className:"space-y-2"},(d||[]).map(e=>React.createElement("div",{key:e.id,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{g(e.id),me(null)},className:q("flex-1 text-left font-medium",e.id===y?"text-slate-900":"text-slate-700")},e.name),React.createElement("button",{type:"button",onClick:()=>Nr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:()=>Cr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove family ${e.name}`},"\xD7"))))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h4",{className:"text-sm font-semibold text-slate-900"},Ae.id?"Edit family":"Add family"),Ae.id&&React.createElement("button",{type:"button",onClick:()=>$e({id:null,name:"",modelsText:""}),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"New")),React.createElement("div",{className:"mt-3 space-y-3"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family name"),React.createElement("input",{value:Ae.name,onChange:e=>$e(s=>({...s,name:e.target.value})),placeholder:"e.g. Samsung S",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Models (one per line)"),React.createElement("textarea",{rows:6,value:Ae.modelsText,onChange:e=>$e(s=>({...s,modelsText:e.target.value})),placeholder:"iPhone 11\\niPhone 12\\n...",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex justify-end"},React.createElement("button",{type:"button",onClick:kr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},Ae.id?"Save changes":"Add family"))))))))}function ea({label:a,options:r,value:t,onChange:o}){const n=()=>o(r),d=()=>o([]),l=h=>o(t.includes(h)?t.filter(y=>y!==h):[...t,h]);return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:n,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},r.map(h=>{const y=t.includes(h),g=/color/i.test(a)||et[h]!==void 0;return React.createElement("button",{type:"button",key:h,onClick:()=>l(h),className:q("rounded-full border px-2 py-1 text-xs",y?"border-transparent bg-brand text-white":"border-[var(--surface-border)] bg-white text-slate-700")},g?React.createElement(React.Fragment,null,React.createElement(Me,{name:h})," ",h):h)})))}function fr({open:a,onClose:r,product:t,onSave:o,onHide:n,onDelete:d}){var R,B,I,z,re;const l=ae(null);at(!!a,l,r);const[h,y]=w((t==null?void 0:t.name)||""),[g,i]=w((t==null?void 0:t.sku)||""),[m,c]=w(String((R=t==null?void 0:t.price)!=null?R:0)),[u,M]=w((t==null?void 0:t.description)||""),[O,A]=w(()=>[...Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[]]),[k,$]=w(0),[W,j]=w(()=>{const N={...(t==null?void 0:t.variants)||{}};return N.Color&&!Array.isArray(N.Color)&&(N.Color=[N.Color]),N.Model&&!Array.isArray(N.Model)&&(N.Model=[N.Model]),N});_(()=>{var D;if(!a)return;y((t==null?void 0:t.name)||""),i((t==null?void 0:t.sku)||""),c(String((D=t==null?void 0:t.price)!=null?D:0)),M((t==null?void 0:t.description)||"");const N=Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[];A([...N]),$(0),j({...(t==null?void 0:t.variants)||{}})},[a,t]);const v=N=>{const D=Array.from(N.target.files||[]);if(!D.length)return;const Y=D.map(V=>new Promise(oe=>{const le=new FileReader;le.onload=()=>oe(String(le.result||"")),le.readAsDataURL(V)}));Promise.all(Y).then(V=>A(oe=>[...oe,...V]))},L=()=>$(N=>(N-1+O.length)%O.length),x=()=>$(N=>(N+1)%O.length),H=()=>{const N=Object.fromEntries(Object.entries(W||{}).map(([le,ge])=>{const we=Array.isArray(ge)?ge.map(Ee=>String(Ee).trim()).filter(Boolean):[];return[le,Array.from(new Set(we))]}).filter(([,le])=>Array.isArray(le)&&le.length)),D=h.trim()||t.name,Y=g.trim()||t.sku,V=Number(m),oe=ce({...t||{},name:D,sku:Y,price:Number.isFinite(V)&&V>0?V:Number(t.price)||0,description:u,images:O.length?O:void 0,image:O[0]||void 0,variants:N});o(oe,t==null?void 0:t.id),r()},C=!!((I=(B=t==null?void 0:t.id)==null?void 0:B.startsWith)!=null&&I.call(B,"owner-")),f=Array.from(new Set([...W.Model||[]])),S=Array.from(new Set([...W.Color||[]]));return!a||!t?null:React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-0 sm:p-6",role:"dialog","aria-modal":"true"},React.createElement("div",{ref:l,className:"w-full sm:max-w-3xl rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none max-h-[90vh] overflow-y-auto"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},"Edit product"),React.createElement("div",{className:"flex items-center gap-2"},!C&&React.createElement("button",{onClick:()=>{n(t.id),r()},className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Hide base"),C&&React.createElement("button",{onClick:()=>{d(t.id),r()},className:"rounded-full border border-rose-300 bg-rose-50/80 px-3.5 py-1.5 text-sm font-semibold text-rose-700 transition hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-400"},"Delete"),React.createElement("button",{onClick:r,className:"rounded-full px-3.5 py-1.5 text-sm font-semibold text-slate-500 transition hover:bg-white/70 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Close"))),React.createElement("div",{className:"grid gap-4 p-4 sm:grid-cols-2"},React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-xl bg-slate-100"},React.createElement("img",{src:Ve(O[k]||"",t.name),onError:N=>{N.currentTarget.src=Ie(t.name)},alt:`${t.name} \u2013 photo ${k+1} of ${O.length}`,className:"h-full w-full object-cover"}),O.length>1&&React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:L,className:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Previous photo"},"\u2039"),React.createElement("button",{type:"button",onClick:x,className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Next photo"},"\u203A"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"text-xs text-slate-700 inline-flex items-center gap-2"},React.createElement("span",{className:"rounded-full border border-[var(--surface-border)] bg-white px-2 py-1"},"Add photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:v,className:"sr-only"}))),O.length>0&&React.createElement("div",{className:"flex gap-2 overflow-x-auto"},O.map((N,D)=>React.createElement("div",{key:D,className:q("relative h-14 w-20 flex-shrink-0 overflow-hidden rounded-md border",D===k?"border-brand":"border-[var(--surface-border)]")},React.createElement("button",{type:"button",onClick:()=>$(D),className:"absolute inset-0"},React.createElement("img",{src:Ve(N,t.name),alt:"",className:"h-full w-full object-cover"})),React.createElement("button",{type:"button",onClick:()=>A(Y=>Y.filter((V,oe)=>oe!==D)),className:"absolute -right-1 -top-1 rounded-full bg-white border p-0.5 shadow","aria-label":`Remove photo ${D+1}`},"\xD7"))))),React.createElement("div",{className:"flex min-w-0 flex-col gap-3"},React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Name"),React.createElement("input",{value:h,onChange:N=>y(N.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"SKU"),React.createElement("input",{value:g,onChange:N=>i(N.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:m,onChange:N=>c(N.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Description"),React.createElement("textarea",{rows:3,value:u,onChange:N=>M(N.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid gap-3"},!!((z=t==null?void 0:t.variants)!=null&&z.Model)&&React.createElement(ea,{label:"Models",options:[...Fe,...gt,...xt],value:f,onChange:N=>j(D=>({...D,Model:N}))}),!!((re=t==null?void 0:t.variants)!=null&&re.Color)&&React.createElement(ea,{label:"Colors",options:Ye,value:S,onChange:N=>j(D=>({...D,Color:N}))}),Object.entries((t==null?void 0:t.variants)||{}).filter(([N])=>N!=="Model"&&N!=="Color").map(([N,D])=>React.createElement("div",{key:N,className:"text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},N),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(W[N]||D).map(Y=>React.createElement("span",{key:Y,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-1 text-xs font-medium text-slate-600"},Y,React.createElement("button",{type:"button",onClick:()=>j(V=>({...V,[N]:(V[N]||D).filter(oe=>oe!==Y)})),"aria-label":`Remove ${Y}`},"\xD7")))),React.createElement("div",{className:"mt-1 flex gap-2"},React.createElement("input",{type:"text",placeholder:`Add ${N} option`,className:"w-44 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-medium text-slate-700 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onKeyDown:Y=>{if(Y.key==="Enter"){const V=Y.currentTarget.value.trim();V&&j(oe=>({...oe,[N]:Array.from(new Set([...oe[N]||D,V]))})),Y.currentTarget.value=""}}}),React.createElement("button",{type:"button",className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onClick:Y=>{const V=Y.currentTarget.previousSibling;if(V&&V.value){const oe=V.value.trim();j(le=>({...le,[N]:Array.from(new Set([...le[N]||D,oe]))})),V.value=""}}},"Add"))))),React.createElement("div",{className:"mt-2 flex justify-end gap-3"},React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm text-slate-900 hover:bg-white/70"},"Cancel"),React.createElement("button",{onClick:H,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition hover:bg-brand-muted"},"Save changes"))))))}function yr({products:a,onClose:r,onEdit:t,onHide:o,onDelete:n,onSave:d}){const[l,h]=w(""),[y,g]=w(null),i=X(()=>{let m=a;if(l){const c=l.toLowerCase();m=m.filter(u=>u.name.toLowerCase().includes(c)||u.sku.toLowerCase().includes(c)||(u.description||"").toLowerCase().includes(c))}return m},[a,l]);return React.createElement("section",{"aria-labelledby":"mgr-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 shadow-soft-xl sm:p-8"},React.createElement("div",{className:"sticky top-[calc(var(--header-offset,64px)+12px)] z-10 rounded-2xl border border-[var(--surface-border)] bg-white/90 px-4 py-3 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},React.createElement("h2",{id:"mgr-title",className:"text-base sm:text-lg font-semibold text-slate-900"},"Owner \u2014 Manage catalogue"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"relative flex-1 sm:w-auto"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:l,onChange:m=>h(m.target.value),placeholder:"Search\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-medium text-slate-600 shadow-inner placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"}),React.createElement(Nt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Back")))),React.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},(i||[]).map(m=>React.createElement("article",{key:m.id,className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white transition hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full bg-slate-100"},React.createElement("img",{src:Ve(Array.isArray(m.images)&&m.images[0]||m.image||"",m.name),onError:c=>{c.currentTarget.src=Ie(m.name)},alt:m.name,className:"h-full w-full object-cover"})),React.createElement("div",{className:"flex flex-1 flex-col gap-3 p-4"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},m.name),React.createElement("p",{className:"mt-0.5 text-xs text-slate-500"},"SKU: ",m.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(m.specs||[]).slice(0,4).map(c=>React.createElement("span",{key:c,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 text-xs font-medium text-slate-600"},c))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"font-semibold text-slate-900"},ye(m.price)),m.minOrder&&React.createElement("span",{className:"text-xs text-slate-500"},"MOQ ",m.minOrder)),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>g(m),className:"flex-1 rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted"},"Edit"),m.id.startsWith("owner-")?React.createElement("button",{onClick:()=>n(m.id),className:"rounded-full border border-red-300 bg-white px-3 py-2 text-sm text-red-700 hover:bg-red-50"},"Delete"):React.createElement("button",{onClick:()=>o(m.id),className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white/90"},"Hide"))))))),React.createElement(fr,{open:!!y,onClose:()=>g(null),product:y,onSave:d,onHide:o,onDelete:n}))}function gr(){const a=React.useRef(0),[r,t]=w(""),[o,n]=w("All"),[d,l]=w(null),[h,y]=w(!1),[g,i]=w("dashboard"),[m,c]=w(mt&&Te),u=_e?!0:Te?m:!1,M=Ga(),O=Oe?c:()=>{};_(()=>{u||i("dashboard")},[u]);const[A,k]=w(null),$=ae(null),W=(T,Q)=>{Q&&(k({type:T,message:Q}),$.current&&clearTimeout($.current),$.current=setTimeout(()=>k(null),4e3))};_(()=>()=>{$.current&&clearTimeout($.current)},[]);const{ownerProducts:j,setOwnerProducts:v,addProduct:L,deleteProduct:x,loading:H,connectionStatus:C}=Ha(),{catalogConfig:f,saveCatalogConfig:S}=Ka(j,v),{orders:R,loadingOrders:B,ordersError:I,ordersMeta:z,refreshOrders:re,updateOrderStatus:N}=za();Da(!!(d||h),a);const Y=X(()=>{const T=new Map(La.map(te=>[te.id,te])),Q=[];return j.forEach(te=>{if(!(te&&te.id===Ze)){if(te.sourceId&&T.has(te.sourceId)){if(te.hidden){T.delete(te.sourceId);return}T.delete(te.sourceId)}te.hidden||(te.sourceId?T.set(te.id,te):Q.push(te))}}),[...Q,...Array.from(T.values())]},[j]),V=X(()=>{let T=Y;return o!=="All"&&(T=T.filter(Q=>Q.category===o)),r&&(T=T.filter(Q=>Q.name.toLowerCase().includes(r.toLowerCase())||Q.sku.toLowerCase().includes(r.toLowerCase())||(Q.description||"").toLowerCase().includes(r.toLowerCase()))),T},[Y,o,r]);_(()=>(window.__setOwnerManage=T=>{i(T?"manage":"dashboard")},()=>{window.__setOwnerManage=void 0}),[]);const oe=T=>v(Q=>{const te=Q.findIndex(Re=>Re.id===T.id);if(te>=0){const Re=[...Q];return Re[te]=T,Re}return[...Q,T]}),le=async(T,Q)=>{var De,nt;const te=(nt=(De=T.id)==null?void 0:De.startsWith)==null?void 0:nt.call(De,"owner-"),Re=ce(te?T:{...T,id:`owner-${Date.now()}`,sourceId:Q}),st=await ft(Re);oe(st||Re),st?W("success","Product updated."):W("warning","Product updated locally. Supabase sync pending.")},ge=async T=>{const Q=ce({id:`owner-hide-${Date.now()}`,sourceId:T,hidden:!0,name:"",sku:"",category:"All",price:0,description:"",specs:[]}),te=await ft(Q);oe(te||Q),te?W("success","Base product hidden."):W("warning","Base product hidden locally. Supabase sync pending.")},we=async T=>{const Q=await x(T);return Q?W("success","Product deleted."):W("error","Could not delete product. Check your connection and try again."),Q},Ee=X(()=>React.createElement(tr,{allProducts:Y,ownerProducts:j,orders:R,loadingOrders:B,ordersMeta:z,ordersError:I,onNavigate:i,refreshOrders:re}),[Y,j,R,B,z,I,re]),Ct=X(()=>[{id:"dashboard",label:"Dashboard",description:"Key metrics & recents",icon:Ja,element:Ee},{id:"add",label:"Add product",description:"Create new catalogue items",icon:Za,element:React.createElement(br,{addProduct:L,onNotify:W,onNavigate:i,catalogConfig:f,saveCatalogConfig:S})},{id:"manage",label:"Manage catalogue",description:"Edit overrides & hide base items",icon:Xa,element:React.createElement(yr,{products:Y,onClose:()=>i("add"),onEdit:T=>l({__edit:!0,product:T}),onHide:T=>ge(T),onDelete:T=>we(T),onSave:le})},{id:"orders",label:"Orders",description:"Track open, confirmed & shipped",icon:er,element:React.createElement(ar,{orders:R,loading:B,error:I,meta:z,onRefresh:re,onStatusChange:N,onNotify:W})}],[Ee,Y,j,R,B,I,z,re,N,we,ge,le,i,W,L,f,S]),St=M.items.reduce((T,Q)=>T+(Number(Q.qty)||0),0);return H?React.createElement("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center"},React.createElement("div",{className:"text-center"},React.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),React.createElement("p",{className:"text-slate-600"},"Loading products..."))):React.createElement("div",{className:"min-h-screen bg-slate-50"},React.createElement(sr),A&&React.createElement("div",{className:q("fixed bottom-4 right-4 z-40 max-w-sm rounded-lg border px-4 py-3 text-sm shadow-lg backdrop-blur",A.type==="error"?"border-red-200 bg-red-50/90 text-red-700":A.type==="warning"?"border-amber-200 bg-amber-50/90 text-amber-800":"border-emerald-200 bg-emerald-50/90 text-emerald-700")},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("span",{className:"flex-1 leading-snug"},A.message),React.createElement("button",{type:"button",onClick:()=>k(null),className:"text-xs font-medium uppercase tracking-wide text-slate-500 hover:text-slate-700"},"Dismiss"))),React.createElement(nr,{onOpenCart:()=>{a.current=window.scrollY||0,y(!0)},search:r,setSearch:t,ownerMode:u,setOwnerMode:O,cartQty:St,connectionStatus:C,allowOwnerToggle:Oe}),u?React.createElement(rr,{views:Ct,section:g,onSectionChange:i}):React.createElement(React.Fragment,null,React.createElement(or),React.createElement(lr,{active:o,setActive:n}),React.createElement(ir,{products:V,onOpen:T=>{a.current=window.scrollY||0,l(T&&T.__edit&&T.product?T.product:T)}})),React.createElement(dr,{product:d,onClose:()=>{l(null)},onAdd:M.add}),React.createElement(ur,{open:h,onClose:()=>y(!1),cart:M}))}ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(gr))},ba=w=>{const _=document.createElement("div");_.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",_.innerHTML=`
          <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
            <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
            <p style="margin:0 0 16px;font-size:14px;color:#4B5563;">Sign in to manage the catalogue.</p>
            <form style="display:flex;flex-direction:column;gap:12px;">
              <input name="email" type="email" autocomplete="email" placeholder="Email" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <input name="password" type="password" autocomplete="current-password" placeholder="Password" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <div data-status style="min-height:18px;font-size:13px;color:#DC2626;"></div>
              <button type="submit" style="border:none;border-radius:8px;background:#4F46E5;color:white;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign in</button>
              <button type="button" data-signout style="display:none;border:1px solid #D1D5DB;border-radius:8px;background:white;color:#111827;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign out</button>
            </form>
            <p style="margin:16px 0 0;font-size:12px;color:#6B7280;line-height:1.4;">
              This page requires Supabase Auth + owner-only RLS. If you haven't yet, run <code>supabase-owner-rls.sql</code> in Supabase, then add your Auth user UUID to <code>public.owner_users</code>.
            </p>
          </div>
        `,document.body.appendChild(_);const ae=_.querySelector("form"),X=_.querySelector("input[name=email]"),Ke=_.querySelector("input[name=password]"),ct=_.querySelector("[data-status]"),He=_.querySelector("[data-signout]");X.focus();const be=pe=>{ct.textContent=pe||""},dt=pe=>{const ke=ae.querySelector("button[type=submit]");ke.disabled=pe,ke.style.opacity=pe?"0.7":"1",ke.textContent=pe?"Signing in...":"Sign in"};He.addEventListener("click",async()=>{try{await w.auth.signOut()}catch(pe){}He.style.display="none",be("Signed out.")}),ae.addEventListener("submit",async pe=>{var ke,Pe,_e,Te;pe.preventDefault(),be(""),dt(!0);try{const Oe=String(X.value||"").trim(),mt=String(Ke.value||""),{data:ze,error:Je}=await w.auth.signInWithPassword({email:Oe,password:mt});if(Je)throw Je;const ee=await _t(w);if(ee===!0){_.remove(),Mt();return}const ut=((ke=ze==null?void 0:ze.user)==null?void 0:ke.id)||((Te=(_e=(Pe=await w.auth.getUser())==null?void 0:Pe.data)==null?void 0:_e.user)==null?void 0:Te.id);He.style.display="block",be(ee===!1?`Signed in, but not an owner. User ID: ${ut||"(unknown)"}`:"Signed in, but owner check failed. Ensure public.is_owner() exists and you are listed in public.owner_users.")}catch(Oe){be((Oe==null?void 0:Oe.message)||"Sign-in failed.")}finally{dt(!1),Ke.value=""}})};(async()=>{const w=pa();if(!w){const _=document.createElement("div");_.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",_.innerHTML=`
            <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
              <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
              <p style="margin:0;font-size:14px;color:#4B5563;">Supabase is not configured. Ensure <code>supabase-config.js</code> is present and loads before this page script.</p>
            </div>
          `,document.body.appendChild(_);return}try{const{data:_}=await w.auth.getSession();if(_==null?void 0:_.session){const X=await _t(w);if(X===!0){Mt();return}if(X===!1)try{await w.auth.signOut()}catch(Ke){}}}catch(_){}ba(w)})()})();})();

(()=>{(()=>{let At=!1;const la=()=>{const E=window.SUPABASE_PUBLIC_CONFIG||{},I=E.url||"",ae=E.anonKey||"";if(!I||!ae||!window.supabase)return null;try{return window.supabase.createClient(I,ae)}catch(J){return console.error("Failed to init Supabase client for auth",J),null}},Pt=async E=>{try{const{data:I,error:ae}=await E.rpc("is_owner");if(ae)throw ae;return!!I}catch(I){return console.error("Owner check failed",I),null}},Ot=()=>{if(At)return;At=!0;const{useState:E,useEffect:I,useRef:ae,useMemo:J,useLayoutEffect:$e}=React,ot="Odil Accessories",Ge="Simple wholesale catalogue with WhatsApp ordering.",pe="GBP",lt="\xA3",me="992935563306",we="nova_wholesale_cart_v1",Ne="nova_owner_products_v1",Se=document.body.dataset.layout==="owner",Ie=Se||document.body.dataset.ownerMode!=="disabled",ke=Ie&&!Se,it=Se||document.body.dataset.defaultOwner==="true",Ke="/.netlify/functions/catalogue",Je=pe,re="__base__",ct=(a,r)=>{const t=(a||r||"").trim();if(!t)return r||"";const o=t.toLowerCase();return o.includes("color")||o.includes("colour")?"Color":r==="models"||o.includes("model")?"Model":t.replace(/\s+/g," ").trim()},ye=(a={})=>{const r=Object.entries(a||{}).filter(([t,o])=>o!=null&&String(o).trim()!=="");return r.length?r.sort(([t],[o])=>t.localeCompare(o)).map(([t,o])=>`${t}:${o}`).join("|"):re},He=a=>{if(!a||typeof a!="object")return{};const r={};return Object.entries(a).forEach(([t,o])=>{const s=Number(o);Number.isFinite(s)&&s>=0&&(r[t&&t.trim()||re]=s)}),r},ca=a=>{const r=Object.entries(a||{}).filter(([s,d])=>Array.isArray(d)&&d.length);if(!r.length)return[{key:re,selection:{}}];const t=[],o=(s,d)=>{if(s>=r.length){const f=ye(d);t.push({key:f,selection:{...d}});return}const[l,h]=r[s];h.forEach(f=>o(s+1,{...d,[l]:f}))};return o(0,{}),t},Ar=(a,r)=>{const t=[...r.must||[],...r.also||[],...r.optional||[]],o={};return t.forEach(s=>{const d=a[s.key],l=ct(s.label,s.key);if(s.type==="checkbox"){d&&(o[l]=["Yes"]);return}if(d==null)return;if(Array.isArray(d)){const f=d.map(g=>String(g).trim()).filter(Boolean);f.length&&(o[l]=Array.from(new Set(f)));return}const h=String(d).trim();h&&(o[l]=[h])}),o},Bt=window.SUPABASE_PUBLIC_CONFIG||{},dt=Bt.url||"",_t=Bt.anonKey||"",da=!!(dt&&_t);let be=null;try{window.supabase&&da?(be=window.supabase.createClient(dt,_t),console.log("\u2705 Supabase client initialized successfully"),console.log("\u{1F4CD} Supabase URL:",dt),setTimeout(async()=>{try{console.log("\u{1F504} Testing database connection...");const{data:r,error:t}=await be.from("products").select("count").limit(1);t?(console.error("\u274C Database test failed:",t),t.message.includes("permission denied")&&console.error("\u{1F6AB} RLS Policy Issue: Run the SQL script to fix permissions"),t.message.includes('relation "products" does not exist')&&console.error("\u{1F3D7}\uFE0F Table Missing: Run the SQL script to create the products table")):console.log("\u2705 Database connection successful"),console.log("\u{1F504} Testing realtime connection...");const o=be.channel("test-channel");o.subscribe(s=>{s==="SUBSCRIBED"?(console.log("\u2705 Realtime connection successful"),o.unsubscribe()):s==="CHANNEL_ERROR"&&console.error("\u274C Realtime connection failed")})}catch(r){console.error("\u274C Connection test failed:",r)}},1e3)):console.warn("\u26A0\uFE0F Supabase not initialized - supply SUPABASE_PUBLIC_CONFIG in supabase-config.js")}catch(a){console.error("\u274C Supabase initialization failed:",a)}const mt=async(a,r=3,t=1e3)=>{for(let o=1;o<=r;o++)try{return await a()}catch(s){if(console.warn(`\u26A0\uFE0F Attempt ${o}/${r} failed:`,s.message),o===r)throw s;await new Promise(d=>setTimeout(d,t*o))}},ma=async()=>{var a;try{if(!be)return null;const{data:r}=await be.auth.getSession(),t=(a=r==null?void 0:r.session)==null?void 0:a.access_token;return t?`Bearer ${t}`:null}catch(r){return null}},je=async(a,r)=>{try{const t=await ma(),o=await fetch(Ke,{method:"POST",headers:{"Content-Type":"application/json",...t?{Authorization:t}:{}},body:JSON.stringify({action:a,data:r})});if(!o.ok){const d=await o.text().catch(()=>"");throw new Error(`Owner API ${a} failed: ${o.status} ${d}`)}const s=await o.json().catch(()=>({}));if(s!=null&&s.error){const d=new Error(s.error.message||s.error);throw d.details=s.error.details,d.hint=s.error.hint,d.code=s.error.code,d}return s}catch(t){throw console.error(`Owner API ${a} error`,t),t}},oe=a=>{var W;if(!a)return null;const{sourceid:r,sourceId:t,images:o,image:s,specs:d,variants:l,inventory:h,price:f,hidden:g,...i}=a,m=(W=t!=null?t:r)!=null?W:null,c=j=>Array.isArray(j)?j:j==null?[]:typeof j=="string"&&j.trim().length?[j]:[],u=c(o),B=c(d),P=typeof l=="object"&&l!==null&&!Array.isArray(l)?l:{},A=He(h),k=s||u[0]||void 0,U=u.length?u:k?[k]:[];return{...i,sourceId:m,images:U,specs:B,variants:P,inventory:A,price:typeof f=="number"?f:Number(f)||0,hidden:!!g,image:k}},Mt=a=>{var s;const r={id:a.id,name:a.name,sku:a.sku,category:a.category,price:Number(a.price)||0,description:(s=a.description)!=null?s:""},t=Array.isArray(a.images)?a.images:a.image?[a.image]:[];t.length&&(r.images=t),Array.isArray(a.specs)&&a.specs.length&&(r.specs=a.specs),a.variants&&Object.keys(a.variants).length&&(r.variants=a.variants),a.sourceId&&(r.sourceid=a.sourceId),a.hidden&&(r.hidden=!0);const o=He(a.inventory);return Object.keys(o).length&&(r.inventory=o),r},It=async()=>{if(!be)return console.warn("\u26A0\uFE0F Cannot load products: Supabase not initialized"),[];try{console.log("\u{1F504} Loading products from database...");const{data:a,error:r}=await be.from("products").select("*").order("created_at",{ascending:!1});if(r)throw console.error("\u274C Database error:",r),r;return console.log(`\u2705 Loaded ${(a==null?void 0:a.length)||0} products from database`),(a||[]).map(oe).filter(Boolean)}catch(a){return console.error("Failed to load products:",a),[]}},ua=async a=>{try{const r=Mt(a),{data:t}=await mt(()=>je("insert",r)),o=oe(t);return console.log("\u2705 Product saved successfully:",o),o}catch(r){return console.error("\u274C Failed to save product after retries:",r),null}},ut=async a=>{try{const r=Mt(a),{data:t}=await mt(()=>je("upsert",r));return oe(t)}catch(r){return console.error("Failed to upsert product:",r),null}},pa=async a=>{try{return await mt(()=>je("delete",{id:a})),!0}catch(r){return console.error("Failed to delete product:",r),!1}},Pr=a=>{if(!be)return null;try{return be.channel("products").on("postgres_changes",{event:"*",schema:"public",table:"products"},a).subscribe()}catch(r){return console.error("Failed to subscribe to product changes:",r),null}},pt=["All","Phone Screens","Back Glass","Power Banks","Screen Protectors","Batteries","Mobile Phones","Tablets","Phone Cases","Cables","Chargers","Earphones","Charging Ports","Face ID"],Le=["iPhone 11","iPhone 12","iPhone 12 Pro","iPhone 13","iPhone 13 Pro","iPhone 14","iPhone 14 Pro","iPhone 15","iPhone 15 Plus","iPhone 15 Pro","iPhone 15 Pro Max","iPhone 16","iPhone 16 Pro","iPhone 16 Pro Max"],jt=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],Or=[...Le,...jt],bt=["Galaxy S20","Galaxy S21","Galaxy S22","Galaxy S23","Galaxy S24","Galaxy S25"],ft=["Galaxy A14","Galaxy A24","Galaxy A34","Galaxy A54","Galaxy A55","Galaxy A15"],Br=["iPhone","Samsung S","Samsung A"],_r={iPhone:Le,"Samsung S":bt,"Samsung A":ft},Ze="__catalog_config__",ba="__",yt="__family:",Mr=a=>(Array.isArray(a)?a:[]).filter(r=>{const t=String(r||"");return t&&!t.startsWith(ba)}),Ir=a=>{const t=(Array.isArray(a==null?void 0:a.specs)?a.specs:[]).find(o=>typeof o=="string"&&o.startsWith(yt));return t?String(t).slice(yt.length).trim():""},gt=(a,r)=>{var o,s;if(r==="models")return"Model";const t=String((o=a!=null?a:r)!=null?o:"").toLowerCase().trim();return t==="color"||t==="colors"||t==="colour"?"Color":t==="model"||t==="models"?"Model":String((s=a!=null?a:r)!=null?s:"").trim()},xt=()=>({version:1,categories:pt.filter(a=>a!=="All"),families:[{id:"iphone",name:"iPhone",models:[...Le]},{id:"samsung_s",name:"Samsung S",models:[...bt]},{id:"samsung_a",name:"Samsung A",models:[...ft]},{id:"accessories",name:"Accessories",models:[]}],groupsByCategory:{},groupOverridesByCategoryFamily:{},groupHiddenByCategoryFamily:{}}),Xe=a=>{const r=xt();if(!a||typeof a!="object")return r;const t={...r,...a};return t.categories=Array.isArray(t.categories)?t.categories.filter(Boolean):r.categories,t.families=Array.isArray(t.families)?t.families.filter(Boolean):r.families,t.groupsByCategory=t.groupsByCategory&&typeof t.groupsByCategory=="object"?t.groupsByCategory:{},t.groupOverridesByCategoryFamily=t.groupOverridesByCategoryFamily&&typeof t.groupOverridesByCategoryFamily=="object"?t.groupOverridesByCategoryFamily:{},t.groupHiddenByCategoryFamily=t.groupHiddenByCategoryFamily&&typeof t.groupHiddenByCategoryFamily=="object"?t.groupHiddenByCategoryFamily:{},t},Lt=["Original","OEM","AAA","Aftermarket","Refurb"],fa=["TPU","Silicone","PC","Leather"],ze=["Black","White","Navy","Clear","Red","Lavender","Stone","Midnight","Starlight","Blue","Green","Gold"],et={Black:"#111827",White:"#ffffff",Navy:"#1e3a8a",Clear:"#ffffff",Red:"#ef4444",Lavender:"#b57edc",Stone:"#a8a29e",Midnight:"#0f172a",Starlight:"#f8fafc",Blue:"#3b82f6",Green:"#10b981",Gold:"#f59e0b"};function Ae({name:a}){const r=et[a],t=r?{backgroundColor:r,border:"1px solid rgba(0,0,0,.15)"}:{backgroundImage:"linear-gradient(45deg,#e5e7eb 25%,transparent 25%),linear-gradient(-45deg,#e5e7eb 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#e5e7eb 75%),linear-gradient(-45deg,transparent 75%,#e5e7eb 75%)",backgroundSize:"8px 8px",border:"1px solid rgba(0,0,0,.15)"};return React.createElement("span",{"aria-hidden":"true",className:"inline-block h-3 w-3 rounded-full align-[-2px]",style:t})}const ya=["Tempered","Hydrogel"],ga=["Clear","Matte","Privacy"],xa=["1-Pack","2-Pack"],ha=["Edge-to-edge","Full glue"],ht=["USB-C \u2194 USB-C","USB-C \u2194 Lightning","USB-A \u2194 Micro-USB"],Tt=["0.5m","1m","2m"],Ft=["27W","60W","100W"],va=["MFi","USB-IF"],wa=["Standard","Braided",">10k bends"],Ea=["20W","30W","45W","65W"],Wt=["1\xD7USB-C","1\xD7USB-A","1\xD7USB-C + 1\xD7USB-A","2\xD7USB-C"],Te=["PD 3.0","PPS","QC 3.0","QC 4+"],jr=["CE","UKCA"],Ra=["UK 3-pin","EU","US"],Dt=["New","Refurb","Used A","Used B"],Na=["Unlocked","Locked","Dual-SIM Yes","Dual-SIM No"],ka=["5G","4G"],Ca=["Wi-Fi","Wi-Fi + Cellular"],Ut=["32GB","64GB","128GB","256GB","512GB","1TB"],$t=["3GB","4GB","6GB","8GB","12GB","16GB"],Lr=ht,Sa=Tt,Tr=Ft,Aa=["10,000 mAh","20,000 mAh"],Gt=["open","confirmed","shipped"],Pa=["open","confirmed","shipped","cancelled"],tt={open:"Open",confirmed:"Confirmed",shipped:"Shipped",cancelled:"Cancelled"},Oa=[{id:"sp-iph-13-tmp-2pk",name:"Tempered Glass \u2013 iPhone 13 (2\u2011Pack)",sku:"SP-IP13-TG2",category:"Screen Protectors",price:3.2,specs:["2\u2011Pack","Tempered","9H","Oleophobic"],description:"Clear tempered glass for iPhone 13.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.07_b6d5696d.jpg",variants:{Model:["iPhone 13"],Material:["Tempered"],Pack:["2\u2011Pack"]}},{id:"sp-iph-14-hg-1pk",name:"Hydrogel Protector \u2013 iPhone 14",sku:"SP-IP14-HG1",category:"Screen Protectors",price:2.6,specs:["Hydrogel","Self\u2011healing","Case\u2011friendly"],description:"Flexible hydrogel film.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.08_46a12f36.jpg",variants:{Model:["iPhone 14"],Material:["Hydrogel"],Pack:["1\u2011Pack","2\u2011Pack"]}},{id:"case-slim-tpu-iph-11-16",name:"Slim TPU Case \u2013 iPhone Series",sku:"CA-IP-TPU",category:"Phone Cases",price:3.9,specs:["TPU","Slim","Matte"],description:"Slim matte TPU case.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.09_811264ed.jpg",variants:{Color:["Black","Navy","Clear","Red"],Material:["TPU"],Model:Le}},{id:"case-silicone-sg-s20-s25",name:"Soft Silicone Case \u2013 Galaxy Series",sku:"CA-SG-SIL",category:"Phone Cases",price:4.1,specs:["Silicone","Microfiber"],description:"Soft\u2011touch silicone for Galaxy.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.10_3d78676b.jpg",variants:{Color:["Midnight","Stone","Lavender"],Material:["Silicone"],Model:jt}},{id:"chg-65w-gan-dual",name:"65W GaN Charger \u2013 Dual Port",sku:"CH-65W-GAN",category:"Chargers",price:12.5,specs:["65W","USB\u2011C + USB\u2011A","PD/QC"],description:"Compact GaN charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_89070b32.jpg",variants:{Wattage:["65W"],Ports:["USB\u2011C + USB\u2011A"],Standard:Te}},{id:"chg-20w-usbc",name:"20W USB\u2011C Wall Charger",sku:"CH-20W-USBC",category:"Chargers",price:6,specs:["20W","USB\u2011C","PD"],description:"USB\u2011C PD charger.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.11_9ebc1ea2.jpg",variants:{Wattage:["20W"],Ports:["USB\u2011C"],Standard:["PD 3.0"]}},{id:"cbl-usbc-60w-1m-2m",name:"USB\u2011C Cable 60W",sku:"CB-UC-60",category:"Cables",price:2.2,specs:["USB\u2011C","60W","Nylon"],description:"Braided 60W cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.12_628fcab2.jpg",variants:{Connector:["USB\u2011C \u2194 USB\u2011C"],Length:Sa,Rating:["60W"]}},{id:"cbl-lightning-mfi",name:"Lightning Cable (MFi)",sku:"CB-LT-MFI",category:"Cables",price:3.5,specs:["Lightning","MFi","1m"],description:"MFi Lightning cable.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.13_22d8e7c9.jpg",variants:{Connector:["USB\u2011C \u2194 Lightning"],Length:["1m"],Rating:["27W"]}},{id:"ear-wired-classic",name:"Wired Earphones \u2013 Classic",sku:"EA-WI-CLS",category:"Earphones",price:4.2,specs:["3.5mm","In\u2011line mic"],description:"Wired earphones.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.14_4f407f9a.jpg",variants:{Connector:["3.5mm"],Color:["Black","White"]}},{id:"ear-tws-basic",name:"TWS Earbuds \u2013 Basic",sku:"EA-TWS-BSC",category:"Earphones",price:12.9,specs:["BT 5.3","20h"],description:"TWS earbuds.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.15_e7b8adc0.jpg",variants:{Color:["White","Black"],Standard:["BT 5.3"]}},{id:"pb-10000-compact",name:"Power Bank 10,000 mAh",sku:"PB-10K-CMP",category:"Power Banks",price:11,specs:["10,000 mAh","USB\u2011C","PD"],description:"Slim 10k power bank.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.17_01d0dcae.jpg",variants:{Capacity:["10,000 mAh"],Ports:["USB\u2011C","USB\u2011A"],Standard:Te}},{id:"pb-20000-dual",name:"Power Bank 20,000 mAh \u2013 Dual",sku:"PB-20K-DUAL",category:"Power Banks",price:16.5,specs:["20,000 mAh","Dual","PD/QC"],description:"20k dual output.",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.19_3b58c17b.jpg",variants:{Capacity:["20,000 mAh"],Ports:["USB\u2011C + USB\u2011A"],Standard:Te}},{id:"img-001",name:"Accessory Photo A",sku:"IM-001",category:"Phone Cases",price:2.5,specs:["Assorted"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.33_5dd08e33.jpg"},{id:"img-002",name:"Accessory Photo B",sku:"IM-002",category:"Chargers",price:7.2,specs:["Fast"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_09a1e9d9.jpg"},{id:"img-003",name:"Accessory Photo C",sku:"IM-003",category:"Cables",price:1.8,specs:["1m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.34_f1935767.jpg"},{id:"img-004",name:"Accessory Photo D",sku:"IM-004",category:"Screen Protectors",price:2.9,specs:["Tempered"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.35_92866963.jpg"},{id:"img-005",name:"Accessory Photo E",sku:"IM-005",category:"Phone Cases",price:3.6,specs:["TPU"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.36_d9ee268e.jpg"},{id:"img-006",name:"Accessory Photo F",sku:"IM-006",category:"Back Glass",price:5.5,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.37_ef5ed98e.jpg"},{id:"img-007",name:"Accessory Photo G",sku:"IM-007",category:"Earphones",price:6,specs:["Wireless"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_b444897c.jpg"},{id:"img-008",name:"Accessory Photo H",sku:"IM-008",category:"Power Banks",price:9.9,specs:["10k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.38_f170faf6.jpg"},{id:"img-009",name:"Accessory Photo I",sku:"IM-009",category:"Cables",price:2,specs:["2m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.39_c37cddc9.jpg"},{id:"img-010",name:"Accessory Photo J",sku:"IM-010",category:"Chargers",price:11.5,specs:["65W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.40_7a858ba3.jpg"},{id:"img-011",name:"Accessory Photo K",sku:"IM-011",category:"Phone Cases",price:4.4,specs:["Silicone"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_80d08b54.jpg"},{id:"img-012",name:"Accessory Photo L",sku:"IM-012",category:"Screen Protectors",price:1.9,specs:["Hydrogel"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.41_a2efd2e1.jpg"},{id:"img-013",name:"Accessory Photo M",sku:"IM-013",category:"Back Glass",price:6.5,specs:["Back glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.42_63c16e8a.jpg"},{id:"img-014",name:"Accessory Photo N",sku:"IM-014",category:"Batteries",price:8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.43_06e00e31.jpg"},{id:"img-015",name:"Accessory Photo O",sku:"IM-015",category:"Phone Cases",price:3.2,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_de3a612b.jpg"},{id:"img-016",name:"Accessory Photo P",sku:"IM-016",category:"Cables",price:2.4,specs:["Nylon"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.44_fddf905d.jpg"},{id:"img-017",name:"Accessory Photo Q",sku:"IM-017",category:"Earphones",price:5,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.45_b1dd7f8a.jpg"},{id:"img-018",name:"Accessory Photo R",sku:"IM-018",category:"Chargers",price:9.5,specs:["30W"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_30024620.jpg"},{id:"img-019",name:"Accessory Photo S",sku:"IM-019",category:"Power Banks",price:14,specs:["20k"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_cb602f30.jpg"},{id:"img-020",name:"Accessory Photo T",sku:"IM-020",category:"Phone Cases",price:3.8,specs:["Leather"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.46_d9e5908c.jpg"},{id:"img-021",name:"Accessory Photo U",sku:"IM-021",category:"Screen Protectors",price:2.7,specs:["Matte"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.47_ac758901.jpg"},{id:"img-022",name:"Accessory Photo V",sku:"IM-022",category:"Cables",price:1.6,specs:["0.5m"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_bc4af4ef.jpg"},{id:"img-023",name:"Accessory Photo W",sku:"IM-023",category:"Chargers",price:4.9,specs:["USB\u2011A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.48_f4496fba.jpg"},{id:"img-024",name:"Accessory Photo X",sku:"IM-024",category:"Earphones",price:13.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.49_ad6d3003.jpg"},{id:"img-025",name:"Accessory Photo Y",sku:"IM-025",category:"Phone Cases",price:2.9,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.50_b3694795.jpg"},{id:"img-026",name:"Accessory Photo Z",sku:"IM-026",category:"Back Glass",price:7,specs:["Glass"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.51_5e67178c.jpg"},{id:"img-027",name:"Accessory Photo AA",sku:"IM-027",category:"Batteries",price:6.9,specs:["Refurb"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.52_df23fdba.jpg"},{id:"img-028",name:"Accessory Photo AB",sku:"IM-028",category:"Chargers",price:8.5,specs:["PD"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.53_13d347f3.jpg"},{id:"img-029",name:"Accessory Photo AC",sku:"IM-029",category:"Cables",price:2.1,specs:["Braided"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_5c3d1851.jpg"},{id:"img-030",name:"Accessory Photo AD",sku:"IM-030",category:"Power Banks",price:12.2,specs:["Dual output"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.54_8f092381.jpg"},{id:"img-031",name:"Accessory Photo AE",sku:"IM-031",category:"Earphones",price:3.9,specs:["Wired"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.56_cbdfea17.jpg"},{id:"img-032",name:"Accessory Photo AF",sku:"IM-032",category:"Phone Cases",price:4.5,specs:["Patterned"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_61b6ae02.jpg"},{id:"img-033",name:"Accessory Photo AG",sku:"IM-033",category:"Screen Protectors",price:2.3,specs:["Clear"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.57_efd60a9b.jpg"},{id:"img-034",name:"Accessory Photo AH",sku:"IM-034",category:"Chargers",price:10,specs:["GaN"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.36.58_082b158d.jpg"},{id:"img-035",name:"Accessory Photo AI",sku:"IM-035",category:"Power Banks",price:15,specs:["High capacity"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.00_7e6451d4.jpg"},{id:"img-036",name:"Accessory Photo AJ",sku:"IM-036",category:"Cables",price:1.5,specs:["USB-C"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.01_bf466384.jpg"},{id:"img-037",name:"Accessory Photo AK",sku:"IM-037",category:"Earphones",price:7.5,specs:["TWS"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2920cb02.jpg"},{id:"img-038",name:"Accessory Photo AL",sku:"IM-038",category:"Phone Cases",price:3.1,specs:["Transparent"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_2ae9f56f.jpg"},{id:"img-039",name:"Accessory Photo AM",sku:"IM-039",category:"Back Glass",price:6.8,specs:["OEM"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.03_725a57bf.jpg"},{id:"img-040",name:"Accessory Photo AN",sku:"IM-040",category:"Chargers",price:5.5,specs:["USB-A"],description:"Sample product using real photo",image:"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 WhatsApp 2025-08-16 \u0432 15.37.04_faa6a5d9.jpg"}],ge=a=>new Intl.NumberFormat("en-GB",{style:"currency",currency:pe}).format(a),q=(...a)=>a.filter(Boolean).join(" ");function Ba(){const[a,r]=E(!1);return I(()=>{var s;const t=window.matchMedia("(prefers-reduced-motion: reduce)");r(t.matches);const o=()=>r(t.matches);return(s=t.addEventListener)==null||s.call(t,"change",o),()=>{var d;return(d=t.removeEventListener)==null?void 0:d.call(t,"change",o)}},[]),a}function Pe(a){const r=encodeURIComponent("#f3f4f6"),t=encodeURIComponent("#6b7280"),o=encodeURIComponent(a),s=`<?xml version='1.0' encoding='UTF-8'?><svg xmlns='http://www.w3.org/2000/svg' width='800' height='600' role='img' aria-label='${o}'><rect width='100%' height='100%' fill='${r}'/><g fill='${t}' font-family='system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif'><text x='50%' y='50%' dominant-baseline='middle' text-anchor='middle' font-size='24'>${o}</text></g></svg>`;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(s)}`}function qe(a,r){return a?a.startsWith("data:")||a.startsWith("http")?a:`/img/${a}`:Pe(r)}function _a(a){const r=Array.isArray(a.images)&&a.images.length?a.images:a.image?[a.image]:[];return r.length?r:[Pe(a.name)]}function Kt(a){const r=_a(a);return qe(r[0],a.name)}function at(a,r,t){const o=ae(t);I(()=>{o.current=t},[t]),I(()=>{if(!a||!r.current)return;const s=r.current,d=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(","),l=document.activeElement;(()=>{const g=Array.from(s.querySelectorAll(d));if(!g.length){s.hasAttribute("tabindex")||s.setAttribute("tabindex","-1"),typeof s.focus=="function"&&s.focus({preventScroll:!0});return}const i=g[0];i&&typeof i.focus=="function"&&i.focus({preventScroll:!0})})();const f=g=>{var i;if(g.key==="Escape"){g.stopPropagation(),(i=o.current)==null||i.call(o);return}if(g.key==="Tab"){const m=Array.from(s.querySelectorAll(d));if(!m.length)return;const c=m[0],u=m[m.length-1];g.shiftKey&&document.activeElement===c?(g.preventDefault(),u.focus()):!g.shiftKey&&document.activeElement===u&&(g.preventDefault(),c.focus())}};return s.addEventListener("keydown",f),()=>{if(s.removeEventListener("keydown",f),l&&typeof l.focus=="function"&&document.contains(l))try{l.focus({preventScroll:!0})}catch(g){l.focus()}}},[a])}function Ma(a,r){const t=ae(0),o=ae(null);$e(()=>{if(typeof window=="undefined"||!a)return;const s=document.body,d=document.documentElement;if(!s||!d)return;const l=window.scrollY||window.pageYOffset||0,h=r&&Number.isFinite(r.current)?r.current:l;return t.current=h,o.current={position:s.style.position,top:s.style.top,width:s.style.width,overflow:s.style.overflow,htmlOverflow:d.style.overflow,overscroll:d.style.overscrollBehavior},s.style.position="fixed",s.style.top=`-${h}px`,s.style.width="100%",s.style.overflow="hidden",d.style.overflow="hidden",d.style.overscrollBehavior="none",()=>{const f=o.current||{};s.style.position=f.position||"",s.style.top=f.top||"",s.style.width=f.width||"",s.style.overflow=f.overflow||"",d.style.overflow=f.htmlOverflow||"",d.style.overscrollBehavior=f.overscroll||"",window.scrollTo(0,t.current||0),o.current=null}},[a,r])}function vt({open:a,title:r,onClose:t,children:o,actions:s}){const d=ae(null);return at(!!a,d,t),a?React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},React.createElement("div",{className:"absolute inset-0 bg-black/40",onClick:t,"aria-hidden":"true"}),React.createElement("div",{ref:d,role:"dialog","aria-modal":"true",className:"relative w-full max-w-lg rounded-3xl border border-[var(--surface-border)] bg-white p-5 shadow-soft-xl"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},r),React.createElement("button",{type:"button",onClick:t,className:"rounded-full p-2 text-slate-500 hover:bg-slate-100","aria-label":"Close"},"\xD7")),React.createElement("div",{className:"mt-4 space-y-4"},o),s&&React.createElement("div",{className:"mt-5 flex justify-end gap-2"},s))):null}function Ia({label:a,mode:r,fieldType:t,options:o,value:s,onChange:d,onEdit:l,onRemove:h}){const f=t==="checkbox",i=String(f?"single":r||"single").toLowerCase().trim().includes("multi")?"multi":"single",m=f?["Yes","No"]:Array.isArray(o)?o:[],[c,u]=E(!1),B=ae(null);I(()=>{if(!c)return;const v=L=>{B.current&&!B.current.contains(L.target)&&u(!1)};return document.addEventListener("mousedown",v),document.addEventListener("touchstart",v),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("touchstart",v)}},[c]);const P=!!s,A=Array.isArray(s)?s:[],k=typeof s=="string"?s:s==null?"":String(s),U=f?P?"Yes":"No":i==="multi"?A.length?`${A.length} selected`:"Select...":k||"Select...",W=()=>{d(f?!1:i==="multi"?[]:"")},j=v=>{if(f){d(v==="Yes"),u(!1);return}if(i==="multi"){const L=A.includes(v)?A.filter(x=>x!==v):[...A,v];d(L);return}d(v),u(!1)};return React.createElement("div",{ref:B,className:q("relative rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur",c&&"z-30")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",{className:"flex-1"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},a),React.createElement("button",{type:"button",onClick:()=>u(v=>!v),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-left text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-expanded":c?"true":"false"},U)),React.createElement("div",{className:"mt-6 flex items-center gap-1"},React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:W,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white",title:"Clear"},"Clear"),React.createElement("button",{type:"button",onClick:h,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove ${a}`},"\xD7"))),c&&React.createElement("div",{className:"absolute left-4 right-4 top-[78px] z-40 overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-white shadow-soft-xl"},React.createElement("div",{className:"max-h-64 overflow-y-auto p-2"},m.map(v=>{const L=f?v==="Yes"?P:!P:i==="multi"?A.includes(v):k===v;return React.createElement("button",{key:v,type:"button",onClick:()=>j(v),className:q("flex w-full items-center gap-3 rounded-xl px-3 py-2 text-left text-sm transition",L?"bg-brand-soft text-slate-900":"hover:bg-slate-50")},React.createElement("span",{className:q("inline-flex h-4 w-4 items-center justify-center rounded border",L?"border-brand bg-brand text-white":"border-[var(--surface-border)] bg-white")},L?"\u2713":""),React.createElement("span",{className:"flex-1"},v))})),React.createElement("div",{className:"flex items-center justify-end border-t border-[var(--surface-border)] bg-white/80 px-3 py-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>u(!1),className:"rounded-full bg-brand px-3 py-1 font-semibold text-white hover:bg-brand-muted"},"Done"))))}function ja({label:a,mode:r,options:t,value:o,onChange:s,onEdit:d,onRemove:l}){const h=Array.isArray(t)?t:[],g=String(r||"multi").toLowerCase().trim().includes("multi")?"multi":"single",i=Array.isArray(o)?o:[],m=typeof o=="string"?o:o==null?"":String(o),c=u=>{if(g==="multi"){const B=i.includes(u)?i.filter(P=>P!==u):[...i,u];s(B);return}s(m===u?"":u)};return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-1 text-xs"},g==="multi"&&h.length>0&&React.createElement("button",{type:"button",onClick:()=>{s(h)},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),g==="multi"&&React.createElement("button",{type:"button",onClick:()=>{s([])},className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Edit"),React.createElement("button",{type:"button",onClick:l,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60","aria-label":`Remove ${a}`},"\xD7"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},h.map(u=>{const B=g==="multi"?i.includes(u):m===u,P=et[u]!==void 0||/color/i.test(a);return React.createElement("button",{type:"button",key:u,onClick:()=>c(u),className:q("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",B?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},P?React.createElement(React.Fragment,null,React.createElement(Ae,{name:u}),u):u)})))}function La(){const[a,r]=E([]),[t,o]=E("");I(()=>{try{const g=localStorage.getItem(we);if(g){const i=JSON.parse(g);Array.isArray(i.items)&&r(i.items),typeof i.notes=="string"&&o(i.notes)}}catch(g){}},[]),I(()=>{try{localStorage.setItem(we,JSON.stringify({items:a,notes:t}))}catch(g){}},[a,t]);const s=g=>r(i=>{const m=i.findIndex(c=>c.id===g.id&&JSON.stringify(c.variants||{})===JSON.stringify(g.variants||{}));if(m>=0){const c=[...i];return c[m]={...c[m],qty:c[m].qty+g.qty},c}return[...i,g]}),d=(g,i)=>r(m=>m.map((c,u)=>u===g?{...c,qty:Math.max(0,Number(i)||0)}:c)),l=g=>r(i=>i.filter((m,c)=>c!==g)),h=()=>r([]),f=a.reduce((g,i)=>g+i.price*i.qty,0);return{items:a,add:s,updateQty:d,removeIndex:l,clear:h,subtotal:f,notes:t,setNotes:o}}function Ta(a,r){const[t,o]=E(()=>xt());return I(()=>{var h;const d=(a||[]).find(f=>f&&f.id===Ze),l=(h=d==null?void 0:d.variants)==null?void 0:h.__config;l&&typeof l=="object"&&o(Xe(l))},[a]),{catalogConfig:t,saveCatalogConfig:async d=>{const l=Xe(d);o(l);const h=oe({id:Ze,name:"__catalog_config__",sku:"__catalog_config__",category:"All",price:0,description:"Internal catalog config row",hidden:!0,images:[],specs:[],variants:{__config:l},inventory:{}}),f=await ut(h);f&&r(g=>{const i=Array.isArray(g)?g:[],m=i.findIndex(c=>c&&c.id===Ze);if(m>=0){const c=[...i];return c[m]=f,c}return[f,...i]})}}}function Fa(){const[a,r]=E([]),[t,o]=E(!0),[s,d]=E("connecting");I(()=>{(async()=>{try{d("connecting");const i=await It();r(i);try{localStorage.setItem(Ne,JSON.stringify(i))}catch(m){}d("connected")}catch(i){console.error("Failed to load products from database:",i),d("error");try{const m=localStorage.getItem(Ne);if(m){const c=JSON.parse(m);Array.isArray(c)&&r(c.map(oe).filter(Boolean))}}catch(m){}}finally{o(!1)}})()},[]),I(()=>{if(!be){console.warn("\u26A0\uFE0F Cannot setup realtime: Supabase not initialized");return}console.log("\u{1F504} Setting up realtime subscription...");const g=be.channel("schema-db-changes").on("postgres_changes",{event:"*",schema:"public",table:"products"},i=>{console.log("\u{1F534} Realtime event received:",i.eventType,i),r(m=>{if(i.eventType==="INSERT"){console.log("\u2795 Adding product via realtime:",i.new.name);const c=oe(i.new),u=m.findIndex(B=>B.id===c.id);if(u>=0){console.log("\u{1F504} Updating existing product instead of duplicating");const B=[...m];return B[u]=c,B}return[c,...m]}if(i.eventType==="UPDATE"){console.log("\u270F\uFE0F Updating product via realtime:",i.new.name);const c=oe(i.new);return m.map(u=>u.id===i.new.id?c:u)}return i.eventType==="DELETE"?(console.log("\u{1F5D1}\uFE0F Deleting product via realtime:",i.old.id),m.filter(c=>c.id!==i.old.id)):m})}).subscribe(i=>{console.log("\u{1F534} Realtime status:",i),i==="SUBSCRIBED"?(console.log("\u2705 Realtime subscription active!"),d("connected"),It().then(m=>{console.log("\u{1F504} Reloaded products after reconnection");const c=m.map(oe).filter(Boolean);r(c);try{localStorage.setItem(Ne,JSON.stringify(c))}catch(u){}}).catch(m=>{console.error("\u274C Failed to reload products after reconnection:",m)})):i==="CHANNEL_ERROR"||i==="CLOSED"?(console.error("\u274C Realtime subscription failed!"),d("error")):(console.log("\u{1F504} Realtime connecting..."),d("connecting"))});return()=>{console.log("\u{1F50C} Cleaning up realtime subscription"),g.unsubscribe()}},[]);const l=g=>{if(typeof g=="function")r(i=>{const m=g(i),c=(Array.isArray(m)?m:[]).map(oe).filter(Boolean);try{localStorage.setItem(Ne,JSON.stringify(c))}catch(u){}return c});else{const i=(Array.isArray(g)?g:[]).map(oe).filter(Boolean);r(i);try{localStorage.setItem(Ne,JSON.stringify(i))}catch(m){}}};return{ownerProducts:a,setOwnerProducts:l,addProduct:async g=>{const i=await ua(g);if(i)return l(c=>[i,...c]),{product:i,persisted:!0};const m=oe(g);return l(c=>[m,...c]),{product:m,persisted:!1}},deleteProduct:async g=>{const i=await pa(g);return i&&l(m=>m.filter(c=>c.id!==g)),i},loading:t,connectionStatus:s}}const Ht=a=>{var c;if(!a)return null;const{total_cents:r,totalCents:t,currency:o,status:s,order_items:d,orderItems:l,metadata:h,...f}=a,g=Number((c=r!=null?r:t)!=null?c:0),m=(Array.isArray(d)?d:Array.isArray(l)?l:[]).map(u=>{var P,A,k,U,W,j,v,L;if(!u)return null;const B=Number((W=(P=u.subtotal_cents)!=null?P:u.subtotalCents)!=null?W:(Number((A=u.quantity)!=null?A:0)||0)*(Number((U=(k=u.unit_price_cents)!=null?k:u.unitPriceCents)!=null?U:0)||0));return{...u,quantity:Number((j=u.quantity)!=null?j:0),unit_price_cents:Number((L=(v=u.unit_price_cents)!=null?v:u.unitPriceCents)!=null?L:0),subtotal_cents:B}}).filter(Boolean);return{...f,status:(s||"open").toLowerCase(),total_cents:g,currency:o||Je,metadata:h||{},order_items:m}},zt=a=>{if(!a)return 0;const r=a.created_at||a.createdAt||a.inserted_at||a.insertedAt,t=r?new Date(r).getTime():0;return Number.isFinite(t)?t:0},qt=a=>[...Array.isArray(a)?a:[]].sort((t,o)=>zt(o)-zt(t));function Wa(){const[a,r]=E([]),[t,o]=E(!0),[s,d]=E(null),[l,h]=E(null),f=React.useCallback(async()=>{try{o(!0),d(null);const i=await je("listOrders"),c=(Array.isArray(i==null?void 0:i.data)?i.data:[]).map(Ht).filter(Boolean);r(qt(c)),h((i==null?void 0:i.meta)||null)}catch(i){console.error("Failed to load orders",i),d(i),r([]),h(null)}finally{o(!1)}},[]);I(()=>{f()},[f]);const g=React.useCallback(async(i,m)=>{if(!i||!m)return null;try{const c=await je("updateOrderStatus",{id:i,status:m}),u=Ht(c==null?void 0:c.data);return u&&r(B=>{const P=B.map(A=>A.id===u.id?u:A);return qt(P)}),u}catch(c){throw console.error("Failed to update order status",c),c!=null&&c.message&&/404/.test(c.message)?new Error("Order no longer exists. Refresh the list and try again."):new Error((c==null?void 0:c.message)||"Unable to update order status. Please try again.")}},[]);return{orders:a,loadingOrders:t,ordersError:s,ordersMeta:l,refreshOrders:f,updateOrderStatus:g}}function Da({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}))}function wt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}function Ua({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}function Yt({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}function $a({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3"}))}function Ga({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.164a1.5 1.5 0 0 0-1.5 1.5v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}function Ka({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 13.5v2.25m2.598-9.05a6.75 6.75 0 1 1-5.196 0m7.346 9.591 1.263 1.263m-9.856-1.263L6.892 17.05m.944-4.117L5.4 8.5m13.2 0-2.436 4.433"}))}function Ha({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}function za({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9A2.25 2.25 0 0 0 7.5 18.75h9a2.25 2.25 0 0 0 2.25-2.25v-9A2.25 2.25 0 0 0 16.5 5.25H15m-6 0A1.5 1.5 0 0 1 10.5 3.75h3A1.5 1.5 0 0 1 15 5.25m-6 0v.75A1.5 1.5 0 0 0 10.5 7.5h3A1.5 1.5 0 0 0 15 6V5.25"}))}function qa({className:a}){return React.createElement("svg",{className:a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor"},React.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 7.5h13.5v9h-13.5V7.5Zm13.5 0H18a2.25 2.25 0 0 1 1.8.9l1.95 2.6a2.25 2.25 0 0 1 .45 1.35v4.65h-2.25m-1.5 0a1.5 1.5 0 1 0-3 0m3 0H15.75m-9 0a1.5 1.5 0 1 0-3 0m3 0H3.75"}))}function Qt({className:a}){return React.createElement("svg",{className:a,fill:"currentColor",viewBox:"0 0 24 24"},React.createElement("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0 0 12.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 0 0 5.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0 0 20.885 3.488"}))}function Et({status:a}){const r=(a||"").toLowerCase(),t=r==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":r==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":r==="cancelled"?"border-rose-200 bg-rose-50 text-rose-700":"border-amber-200 bg-amber-50 text-amber-800";return React.createElement("span",{className:q("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-medium capitalize",t)},tt[r]||r||"Open")}function rt({title:a,value:r,subtext:t,trend:o}){return React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/90 p-4 shadow-sm ring-1 ring-black/5 sm:p-5"},React.createElement("p",{className:"text-sm font-medium text-slate-500"},a),React.createElement("p",{className:"mt-2 text-2xl font-semibold tracking-tight text-slate-900"},r),t&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},t),o&&React.createElement("div",{className:"mt-3 inline-flex items-center gap-1 rounded-full bg-emerald-50 px-2 py-1 text-xs font-medium text-emerald-700"},o))}function Ya({allProducts:a,ownerProducts:r,orders:t,loadingOrders:o,ordersMeta:s,ordersError:d,onNavigate:l,refreshOrders:h}){const f=a.filter(v=>!v.hidden).length,g=r.filter(v=>v.sourceId&&!v.hidden).length,i=r.filter(v=>!v.sourceId&&!v.hidden).length,m=r.filter(v=>v.hidden).length,c=t.reduce((v,L)=>{const x=((L==null?void 0:L.status)||"open").toLowerCase();return v[x]=(v[x]||0)+1,v},{}),u=[...Gt,"cancelled"],B=c.open||0,P=c.confirmed||0,A=c.shipped||0,k=t.filter(v=>["confirmed","shipped"].includes(((v==null?void 0:v.status)||"").toLowerCase())).reduce((v,L)=>v+(Number(L==null?void 0:L.total_cents)||0),0),U=new Intl.NumberFormat("en-GB",{style:"currency",currency:pe}).format(k/100),W=t.slice(0,5),j=v=>{l==null||l(v)};return React.createElement("div",{className:"flex flex-col gap-10"},React.createElement("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h1",{className:"text-2xl font-semibold tracking-tight text-slate-900"},"Owner dashboard"),React.createElement("p",{className:"mt-1 text-sm text-slate-600"},"Monitor catalogue health and stay on top of incoming orders."))),React.createElement("section",{className:"grid gap-4 sm:grid-cols-2 xl:grid-cols-4"},React.createElement(rt,{title:"Active SKUs",value:f,subtext:g?`${g} overrides`:void 0}),React.createElement(rt,{title:"Owner additions",value:i,subtext:m?`${m} hidden`:"Live to customers"}),React.createElement(rt,{title:"Open orders",value:o?"\u2014":B,subtext:P?`${P} confirmed`:"Awaiting confirmation"}),React.createElement(rt,{title:"Fulfilled value",value:U,subtext:A?`${A} shipped`:"No shipments yet"})),React.createElement("section",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,1fr)]"},React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order pipeline"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},"Track each stage to keep fulfilment moving.")),React.createElement("button",{type:"button",onClick:h,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",disabled:o},o?"Refreshing\u2026":"Refresh")),d?/schema cache|relation "orders"/i.test(d.message||"")?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("div",{className:"mt-4 rounded-xl border border-rose-200 bg-rose-50 p-4 text-sm text-rose-900"},React.createElement("p",{className:"font-medium"},"Orders could not be loaded"),React.createElement("p",{className:"mt-1"},d.message||"Check your connection or Supabase policies and try again.")):s!=null&&s.missingOrdersTable?React.createElement("div",{className:"mt-4 rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-900"},React.createElement("p",{className:"font-medium"},"Orders table not detected"),React.createElement("p",{className:"mt-1"},"Set up the orders tables & policies in Supabase, then refresh to start tracking customer purchase history.")):React.createElement("dl",{className:"mt-6 grid grid-cols-1 gap-4 sm:grid-cols-4"},u.map(v=>React.createElement("div",{key:v,className:q("rounded-xl border px-4 py-3 text-center flex flex-col items-center justify-center gap-1",v==="open"?"border-amber-200 bg-amber-50 text-amber-800":v==="confirmed"?"border-emerald-200 bg-emerald-50 text-emerald-700":v==="shipped"?"border-sky-200 bg-sky-50 text-sky-700":"border-rose-200 bg-rose-50 text-rose-700")},React.createElement("dt",{className:"text-[11px] font-medium uppercase tracking-wide"},tt[v]||v),React.createElement("dd",{className:"text-2xl font-semibold leading-none"},o?"\u2014":c[v]||0))))),React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-6 shadow-sm ring-1 ring-black/5"},React.createElement("div",{className:"flex items-center justify-between gap-3"},React.createElement("div",null,React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Recent orders"),React.createElement("p",{className:"mt-1 text-sm text-slate-500"},W.length?"Latest activity from verified customers.":"No orders yet \u2014 your list will appear here.")),React.createElement("button",{type:"button",onClick:()=>j("orders"),className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Open orders")),W.length>0&&React.createElement("ul",{className:"mt-5 space-y-3"},W.map(v=>React.createElement("li",{key:v.id,className:"rounded-xl border border-slate-200 bg-white px-4 py-3 shadow-sm"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-medium text-slate-900"},v.customer_name||v.customer_email||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},v.customer_email||"Email pending")),React.createElement(Et,{status:v.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(v.created_at||v.createdAt||Date.now()))),React.createElement("span",{className:"font-medium text-slate-700"},new Intl.NumberFormat("en-GB",{style:"currency",currency:pe}).format((Number(v.total_cents)||0)/100)))))))))}function Qa({orders:a,loading:r,error:t,meta:o,onRefresh:s,onStatusChange:d,onNotify:l}){var v,L;const[h,f]=E("open"),[g,i]=E(null),[m,c]=E(!1),u=J(()=>a.reduce((x,H)=>{const C=((H==null?void 0:H.status)||"open").toLowerCase();return x[C]=(x[C]||0)+1,x.all=(x.all||0)+1,x},{all:0}),[a]),B=J(()=>Array.from(new Set([...Gt,"cancelled","all"])),[]),P=J(()=>h==="all"?a:a.filter(x=>((x==null?void 0:x.status)||"open").toLowerCase()===h),[a,h]);I(()=>{var x;if(!P.length){i(null);return}(!g||!P.some(H=>H.id===g))&&i(((x=P[0])==null?void 0:x.id)||null)},[P,g]);const A=P.find(x=>x.id===g)||null,k=J(()=>new Intl.NumberFormat("en-GB",{style:"currency",currency:pe}),[]),U=x=>k.format((Number(x)||0)/100),W=x=>{try{return new Intl.DateTimeFormat("en-GB",{dateStyle:"medium",timeStyle:"short"}).format(new Date(x))}catch(H){return"\u2014"}},j=async(x,H)=>{const C=String(H||"").toLowerCase();if(!(!x||!C)){if(!Pa.includes(C)){l==null||l("error",`Unsupported status transition: ${H}`);return}try{if(c(!0),await(d==null?void 0:d(x,C))){const S=tt[C]||C;l==null||l("success",`Order status updated to ${S}.`)}}catch(p){console.error("Failed to update order status",p),l==null||l("error",(p==null?void 0:p.message)||"Unable to update order status right now.")}finally{c(!1)}}};if(o!=null&&o.missingOrdersTable)return React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh"));if(t){const x=(t==null?void 0:t.message)||"";return/schema cache|relation "orders"/i.test(x)?React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50 p-6 text-sm text-amber-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-amber-900"},"Orders table not detected"),React.createElement("p",{className:"mt-2"},"Create the orders and order_items tables in Supabase, apply RLS policies, then refresh this view to start tracking customer history."),React.createElement("div",{className:"mt-4 flex flex-wrap gap-2 text-xs"},React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"orders"),React.createElement("span",{className:"rounded-full border border-amber-300 bg-white px-3 py-1 text-amber-700"},"order_items")),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-amber-300 bg-white px-4 py-2 text-xs font-medium text-amber-800 hover:bg-amber-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-amber-500"},"Refresh")):React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 p-6 text-sm text-rose-900 shadow-sm"},React.createElement("h2",{className:"text-base font-semibold text-rose-900"},"Unable to load orders"),React.createElement("p",{className:"mt-2"},t.message||"Check your connection or Supabase permissions and try again."),React.createElement("button",{type:"button",onClick:s,className:"mt-4 inline-flex items-center gap-2 rounded-full border border-rose-300 bg-white px-4 py-2 text-xs font-medium text-rose-700 hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-500"},"Retry"))}return React.createElement("div",{className:"flex flex-col gap-6"},React.createElement("header",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("div",null,React.createElement("h2",{className:"text-xl font-semibold text-slate-900"},"Orders pipeline"),React.createElement("p",{className:"text-sm text-slate-600"},"Move orders from open to shipped, while keeping a full audit trail.")),React.createElement("div",{className:"flex flex-wrap gap-2 text-xs text-slate-500"},React.createElement("span",{className:"rounded-full border border-amber-200 bg-amber-50 px-3 py-1 text-amber-700"},`Open: ${u.open||0}`),React.createElement("span",{className:"rounded-full border border-emerald-200 bg-emerald-50 px-3 py-1 text-emerald-700"},`Confirmed: ${u.confirmed||0}`),React.createElement("span",{className:"rounded-full border border-sky-200 bg-sky-50 px-3 py-1 text-sky-700"},`Shipped: ${u.shipped||0}`),React.createElement("button",{type:"button",onClick:s,className:"inline-flex items-center gap-2 rounded-full border border-slate-300 bg-white px-3 py-1 text-slate-700 hover:bg-slate-50 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},r?"Refreshing\u2026":"Refresh"))),React.createElement("div",{className:"flex flex-wrap gap-2"},B.map(x=>React.createElement("button",{key:x,type:"button",onClick:()=>f(x),className:q("rounded-full border px-3 py-1.5 text-xs font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",h===x?"border-brand bg-[var(--brand-soft-strong)] text-brand shadow-sm":"border-slate-300 bg-white text-slate-600 hover:bg-slate-50")},x==="all"?"All":tt[x]||x))),r&&!a.length?React.createElement("div",{className:"flex items-center justify-center rounded-2xl border border-slate-200 bg-white/80 p-10 text-slate-500"},"Loading orders\u2026"):P.length?React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,1fr),minmax(0,360px)]"},React.createElement("div",{className:"space-y-3"},P.map(x=>React.createElement("button",{key:x.id,type:"button",onClick:()=>i(x.id),className:q("w-full rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",x.id===g?"border-brand bg-[var(--brand-soft-strong)]/70 text-slate-900 shadow-md":"border-slate-200 bg-white hover:border-slate-300")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"text-sm font-semibold text-slate-900"},x.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},x.customer_email||"Email pending")),React.createElement(Et,{status:x.status})),React.createElement("div",{className:"mt-3 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,W(x.created_at||x.createdAt)),React.createElement("span",{className:"font-medium text-slate-700"},U(x.total_cents)))))),React.createElement("aside",{className:"rounded-2xl border border-slate-200 bg-white/90 p-5 shadow-sm"},A?React.createElement("div",{className:"flex flex-col gap-4"},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},A.customer_name||"Customer"),React.createElement("p",{className:"text-xs text-slate-500"},A.customer_email||"Email pending")),React.createElement(Et,{status:A.status})),React.createElement("dl",{className:"grid grid-cols-2 gap-3 text-xs text-slate-500"},React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Placed"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(A.created_at||A.createdAt))),React.createElement("div",null,React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Total"),React.createElement("dd",{className:"mt-1 text-slate-700 font-semibold"},U(A.total_cents))),A.updated_at&&React.createElement("div",{className:"col-span-2"},React.createElement("dt",{className:"font-medium uppercase tracking-wide text-slate-600"},"Updated"),React.createElement("dd",{className:"mt-1 text-slate-700"},W(A.updated_at)))),A.order_items&&A.order_items.length>0&&React.createElement("div",null,React.createElement("h4",{className:"text-sm font-semibold text-slate-800"},"Items"),React.createElement("ul",{className:"mt-3 space-y-3"},A.order_items.map(x=>React.createElement("li",{key:x.id||`${x.product_id}-${x.sku}`},React.createElement("div",{className:"flex items-start justify-between gap-3 text-sm text-slate-700"},React.createElement("div",null,React.createElement("p",{className:"font-medium text-slate-900"},x.name||"Item"),x.sku&&React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",x.sku)),React.createElement("span",{className:"text-xs text-slate-500"},`\xD7${x.quantity||0}`)),x.variants&&Object.keys(x.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1 text-xs text-slate-600"},Object.entries(x.variants).map(([H,C])=>{const p=Array.isArray(C)?C.join(", "):C,S=/color/i.test(H);return React.createElement("span",{key:H,className:q("inline-flex items-center gap-1 rounded-full border px-2 py-0.5",S?"border-slate-300 bg-slate-50":"border-slate-200 bg-white")},S?React.createElement(Ae,{name:p}):null,`${H}: ${p}`)})),React.createElement("div",{className:"mt-1 flex items-center justify-between text-xs text-slate-500"},React.createElement("span",null,U(x.unit_price_cents)),React.createElement("span",{className:"font-medium text-slate-700"},U(x.subtotal_cents))))))),(A.note||((v=A.metadata)==null?void 0:v.notes))&&React.createElement("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},A.note||((L=A.metadata)==null?void 0:L.notes)),React.createElement("div",{className:"flex flex-wrap gap-2"},(()=>{const x=(A.status||"open").toLowerCase(),H=[];return x==="open"&&(H.push({label:"Mark as confirmed",next:"confirmed"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),x==="confirmed"&&(H.push({label:"Mark as shipped",next:"shipped"}),H.push({label:"Cancel order",next:"cancelled",variant:"danger"})),H.map(C=>React.createElement("button",{key:C.next,type:"button",onClick:()=>j(A.id,C.next),disabled:m,className:q("inline-flex items-center gap-2 rounded-full border px-4 py-2 text-xs font-medium shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",C.variant==="danger"?"border-rose-300 bg-rose-50 text-rose-700 hover:bg-rose-100":C.next==="shipped"?"border-sky-300 bg-sky-50 text-sky-700 hover:bg-sky-100":"border-emerald-300 bg-emerald-50 text-emerald-700 hover:bg-emerald-100",m?"opacity-60":"")},m?"Updating\u2026":C.label))})())):React.createElement("p",{className:"text-sm text-slate-500"},P.length?"Select an order to see its breakdown.":"No orders in this stage yet."))):React.createElement("div",{className:"rounded-2xl border border-slate-200 bg-white/80 p-8 text-sm text-slate-500"},"No orders in this stage yet."))}function Va({views:a,section:r,onSectionChange:t}){const o=a.find(s=>s.id===r)||a[0];return React.createElement("main",{id:"main",className:"mx-auto w-full max-w-7xl px-4 pb-16 pt-6 sm:px-6 lg:px-8"},React.createElement("div",{className:"grid gap-6 lg:grid-cols-[minmax(200px,240px),minmax(0,1fr)]"},React.createElement("nav",{className:"flex snap-x snap-mandatory gap-3 overflow-x-auto pb-1 lg:flex-col lg:overflow-visible lg:pb-0"},a.map(s=>React.createElement("button",{key:s.id,type:"button",onClick:()=>t(s.id),className:q("snap-start rounded-2xl border px-4 py-3 text-left shadow-sm transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",s.id===o.id?"border-brand bg-brand-soft text-brand":"border-slate-200 bg-white text-slate-600 hover:border-slate-300 hover:bg-slate-50")},s.icon?React.createElement(s.icon,{className:"mb-2 h-5 w-5 text-current"}):null,React.createElement("span",{className:"block text-sm font-semibold"},s.label),s.description&&React.createElement("span",{className:"mt-1 block text-xs text-slate-500"},s.description)))),React.createElement("section",{className:"min-h-[480px]"},(o==null?void 0:o.element)||React.createElement("p",{className:"text-sm text-slate-500"},"Select a section to begin."))))}function Ja(){return React.createElement("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:top-2 focus:left-2 rounded-full border border-[var(--surface-border)] bg-white/90 px-3 py-2 text-sm font-semibold text-brand shadow-sm backdrop-blur"},"Skip to content")}function Za({onOpenCart:a,search:r,setSearch:t,ownerMode:o,setOwnerMode:s,cartQty:d,connectionStatus:l,allowOwnerToggle:h}){const[f,g]=E(!1),i=ae(null);I(()=>{const c=()=>g(window.scrollY>4);return c(),window.addEventListener("scroll",c,{passive:!0}),()=>window.removeEventListener("scroll",c)},[]),I(()=>{const c=()=>{var B;const u=((B=i.current)==null?void 0:B.offsetHeight)||64;document.documentElement.style.setProperty("--header-offset",u+"px")};return c(),window.addEventListener("resize",c,{passive:!0}),()=>window.removeEventListener("resize",c)},[o,r]);const m=l==="connected"?{wrapper:"border border-emerald-200 bg-emerald-50/80 text-emerald-600",dot:"bg-emerald-500",label:"Online"}:l==="error"?{wrapper:"border border-rose-200 bg-rose-50/80 text-rose-600",dot:"bg-rose-500",label:"Offline"}:{wrapper:"border border-amber-200 bg-amber-50/80 text-amber-600",dot:"bg-amber-400 animate-pulse",label:"Connecting"};return React.createElement("header",{ref:i,className:q("sticky top-0 z-40 w-full border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-xl transition-shadow duration-300",f?"shadow-sm":"")},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"flex h-16 items-center justify-between gap-3"},React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement(Da,{className:"h-7 w-7 text-brand flex-shrink-0"}),React.createElement("div",{className:"flex items-center gap-3 min-w-0"},React.createElement("span",{className:"font-semibold text-slate-900 text-sm sm:text-base tracking-tight truncate"},ot),React.createElement("div",{className:`hidden md:flex items-center gap-1 rounded-full px-2.5 py-1 text-[11px] font-medium ${m.wrapper}`,title:`Database ${l}`},React.createElement("span",{className:`inline-block h-2 w-2 rounded-full ${m.dot}`}),React.createElement("span",null,m.label)))),React.createElement("nav",{className:"flex items-center gap-1.5 sm:gap-2"},!o&&React.createElement("label",{className:"relative hidden sm:block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-48 md:w-64 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-2 text-sm font-medium text-slate-600 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(wt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),h&&React.createElement("button",{onClick:()=>s(!o),className:q("rounded-full border px-3 py-2 text-xs sm:text-sm font-medium transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",o?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/60 text-slate-700 hover:bg-white/80")},o?"Back":"Owner"),React.createElement("button",{onClick:a,className:"relative inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/60 px-2.5 sm:px-3.5 py-2 text-xs sm:text-sm font-medium text-slate-700 transition-colors hover:bg-white/80 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Ua,{className:"h-4 w-4 text-brand"}),React.createElement("span",{className:"hidden sm:inline"},"Cart"),d>0&&React.createElement("span",{"aria-live":"polite",className:"absolute -top-1.5 -right-1.5 inline-flex h-5 min-w-[1.25rem] items-center justify-center rounded-full border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-1 text-[10px] font-semibold text-brand"},String(d))))),!o&&React.createElement("div",{className:"sm:hidden pb-0"},React.createElement("label",{className:"relative block"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:r,onChange:c=>t(c.target.value),placeholder:"Search products\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm font-medium text-slate-700 shadow-inner backdrop-blur focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent placeholder:text-slate-400"}),React.createElement(wt,{className:"pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})))))}function Xa(){const a=[{title:"1. Browse products",detail:"Search or tap a category to find what you need."},{title:"2. Open an item",detail:"Choose the variants and quantities, then add to cart."},{title:"3. Review the cart",detail:"Adjust quantities or notes before sending."},{title:"4. Send via WhatsApp",detail:"Use the cart button to submit the full list for confirmation."}];return React.createElement("section",{"aria-labelledby":"hero-title",className:"border-b border-[var(--surface-border)] bg-hero-gradient"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-16"},React.createElement("div",{className:"grid gap-12 lg:grid-cols-[minmax(0,1fr)_420px] items-start"},React.createElement("div",{className:"space-y-6"},React.createElement("span",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/60 px-3 py-1 text-[11px] font-medium uppercase tracking-[0.14em] text-slate-600"},"Odil Accessories"),React.createElement("h1",{id:"hero-title",className:"text-[clamp(30px,6vw,48px)] font-semibold leading-tight tracking-tight text-slate-900"},"Wholesale catalogue for partner shops"),React.createElement("p",{className:"max-w-2xl text-base sm:text-lg text-slate-600"},Ge),React.createElement("div",{className:"flex flex-wrap gap-3"},React.createElement("a",{href:"#catalogue",className:"inline-flex items-center gap-2 rounded-full bg-brand px-5 py-2.5 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Browse catalogue",React.createElement($a,{className:"h-4 w-4"})),React.createElement("a",{href:`https://wa.me/${me}`,target:"_blank",rel:"noreferrer noopener",className:"inline-flex items-center gap-2 rounded-full border border-[rgba(37,99,235,0.35)] bg-white/70 px-5 py-2.5 text-sm font-semibold text-slate-800 shadow-sm backdrop-blur transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement(Qt,{className:"h-4 w-4 text-emerald-500"}),"Chat on WhatsApp")),React.createElement("p",{className:"text-sm text-slate-500"},"Follow the steps on the right when you place an order.")),React.createElement("div",{className:"glass-card rounded-3xl p-8 soft-shadow"},React.createElement("div",{className:"space-y-5 text-sm text-slate-600"},React.createElement("h2",{className:"text-base font-semibold text-slate-900"},"Order steps"),React.createElement("ol",{className:"space-y-3 text-sm"},a.map(r=>React.createElement("li",{key:r.title,className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 px-4 py-3 backdrop-blur"},React.createElement("p",{className:"text-sm font-semibold text-slate-900"},r.title),React.createElement("p",{className:"text-xs text-slate-500 mt-1"},r.detail))))),React.createElement("div",{className:"mt-6 flex items-center justify-between rounded-2xl border border-[var(--surface-border)] bg-white/80 px-4 py-3 text-xs uppercase tracking-[0.18em] text-slate-500"},React.createElement("span",null,"Owner metrics snapshot"),React.createElement("span",{className:"font-semibold text-slate-800"},"Realtime"))))))}function er({active:a,setActive:r}){const t=ae(null),[o,s]=E({left:!1,right:!1});I(()=>{const l=()=>{const f=t.current;if(!f)return;const{scrollLeft:g,scrollWidth:i,clientWidth:m}=f,c=g>0,u=g+m<i-1;s(B=>B.left===c&&B.right===u?B:{left:c,right:u})};l();const h=t.current;if(h)return h.addEventListener("scroll",l,{passive:!0}),window.addEventListener("resize",l),()=>{h.removeEventListener("scroll",l),window.removeEventListener("resize",l)}},[]);const d=q("relative -mx-4 overflow-x-auto px-4 chip-scroll-fade",o.left&&"show-left",o.right&&"show-right");return React.createElement(React.Fragment,null,React.createElement("div",{className:"sticky top-[var(--header-offset,64px)] z-30 border-b border-[var(--surface-border)] bg-[rgba(246,247,251,0.85)] backdrop-blur-lg"},React.createElement("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8","aria-label":"Categories"},React.createElement("div",{ref:t,className:d},React.createElement("div",{className:"flex gap-2 py-2 text-[11px]"},pt.map(l=>React.createElement("button",{key:l,onClick:()=>r(l),"aria-pressed":a===l,className:q("inline-flex items-center whitespace-nowrap rounded-full border px-3.5 py-1.5 text-[11px] font-semibold uppercase tracking-[0.18em] transition-colors focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",a===l?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/70 text-slate-600 hover:text-slate-900 hover:bg-white/90")},l)))))))}function tr({products:a,onOpen:r}){return React.createElement("section",{id:"catalogue","aria-labelledby":"catalogue-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("h2",{id:"catalogue-title",className:"sr-only"},"Catalogue"),React.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"},a.map(t=>React.createElement(ar,{key:t.id,product:t,onOpen:r}))))}function ar({product:a,onOpen:r}){const[t,o]=E(Kt(a));return I(()=>{o(Kt(a))},[a.image,a.images,a.name]),React.createElement("article",{className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white/80 backdrop-blur transition duration-200 hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full overflow-hidden bg-slate-100"},React.createElement("img",{src:t,onError:()=>o(Pe(a.name)),alt:a.name,className:"h-full w-full object-cover",loading:"lazy"})),React.createElement("div",{className:"flex flex-1 flex-col gap-4 p-5"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},a.name),React.createElement("p",{className:"mt-1 text-[11px] font-medium uppercase tracking-[0.18em] text-slate-400"},"SKU ",a.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-[11px]"},(a.specs||[]).slice(0,4).map(s=>React.createElement("span",{key:s,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 font-medium text-slate-600"},s))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},ge(a.price))),React.createElement("div",null,React.createElement("button",{type:"button",onClick:()=>r(a),className:"w-full rounded-full border border-[rgba(37,99,235,0.28)] bg-white/70 px-4 py-2 text-sm font-semibold text-brand transition hover:bg-brand hover:text-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"View details"))))}function rr({product:a,onClose:r,onAdd:t,cartItems:o}){const s=a&&a.__edit&&a.product?a.product:a;if(!s)return null;const d=Array.isArray(o)?o:[],l=J(()=>He(s.inventory),[s.inventory]),h=J(()=>{const p={};return d.forEach(S=>{if(!S||S.id!==s.id)return;const w=S.inventoryKey||ye(S.variants||{});p[w]=(p[w]||0)+Number(S.qty||0)}),p},[d,s.id]),f=ae(null);at(!!s,f,r);const g=(()=>{const p=Array.isArray(s.images)&&s.images.length?s.images:s.image?[s.image]:[];return(p.length?p:[Pe(s.name)]).map(S=>qe(S,s.name))})(),i=s.variants||{},m=Object.entries(i).filter(([,p])=>Array.isArray(p)&&p.length>0).map(([p])=>p),[c,u]=E({}),[B,P]=E({}),[A,k]=E({});I(()=>{if(!s)return;const p={};m.forEach(O=>{const _=i[O]||[];p[O]=_.length?[_[0]]:[]}),u(p);const S=(()=>{if(m.length===0)return[re];const O=[],_=(z,se)=>{if(z===m.length){O.push(ye(se));return}const R=m[z];(p[R]||[]).forEach(D=>_(z+1,{...se,[R]:D}))};return _(0,{}),O})(),w={};S.forEach(O=>{w[O]=0}),P(w)},[s]);const U=(p,S)=>u(w=>{const O=w[p]||[],_=O.includes(S)?O.filter(z=>z!==S):[...O,S];return{...w,[p]:_}}),W=p=>u(S=>({...S,[p]:[...i[p]||[]]})),j=p=>u(S=>({...S,[p]:[]})),v=(p,S)=>{const w=Math.max(0,Number(S)||0);k(O=>{const _=O[p];if(_===void 0)return O;if(w<_){const z={...O};return delete z[p],z}return O}),P(O=>({...O,[p]:w}))},L=J(()=>{if(m.length===0)return[{key:re,sel:{}}];if(m.some(w=>(c[w]||[]).length===0))return[];const p=[],S=(w,O)=>{if(w===m.length){p.push({key:ye(O),sel:O});return}const _=m[w];(c[_]||[]).forEach(z=>S(w+1,{...O,[_]:z}))};return S(0,{}),p},[m,c]),x=()=>{let p=!1,S=!1;L.forEach(({key:w,sel:O})=>{const _=Number(B[w]||0);if(!(_>0))return;const z=l[w]!==void 0?l[w]:w===re?l[re]:void 0,se=h[w]||0,R=typeof z=="number"?Math.max(z-se,0):void 0,D=typeof R=="number"?Math.min(_,R):_;D>0?(t({id:s.id,name:s.name,sku:s.sku,price:s.price,qty:D,variants:O,inventoryKey:w}),p=!0,D<_&&(S=!0)):S=!0}),S&&alert("Some items were adjusted to match available stock."),p&&r()},H=J(()=>L.reduce((p,{key:S})=>{const w=Number(B[S]||0);if(!Number.isFinite(w)||w<=0)return p;const O=l[S]!==void 0?l[S]:S===re?l[re]:void 0,_=h[S]||0,z=typeof O=="number"?Math.max(O-_,0):void 0,se=typeof z=="number"?Math.min(w,z):w;return se>0?p+se*s.price:p},0),[L,B,s.price,l,h]),C=L.every(({key:p})=>{const S=Number(B[p]||0);if(!(S>0))return!0;const w=l[p]!==void 0?l[p]:p===re?l[re]:void 0,O=h[p]||0,_=typeof w=="number"?Math.max(w-O,0):void 0;return!((typeof _=="number"?Math.min(S,_):S)>0)});return I(()=>{k(p=>{const S=new Set(L.map(({key:_})=>_));let w=!1;const O={};return Object.entries(p).forEach(([_,z])=>{S.has(_)?O[_]=z:w=!0}),w?O:p})},[L]),I(()=>{k({})},[s.id]),React.createElement("div",{role:"dialog","aria-modal":"true","aria-labelledby":`product-title-${s.id}`,className:"fixed inset-0 z-50 flex items-stretch sm:items-center justify-center bg-black/40 p-0 sm:p-6",onClick:r,onTouchMove:p=>{p.target===p.currentTarget&&p.preventDefault()},onWheel:p=>{p.target===p.currentTarget&&p.preventDefault()}},React.createElement("div",{ref:f,tabIndex:-1,className:"w-full h-full sm:h-auto sm:max-w-3xl rounded-none sm:rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain overflow-y-auto max-h-none sm:max-h-[90vh]",style:{touchAction:"pan-y"},onClick:p=>p.stopPropagation()},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:`product-title-${s.id}`,className:"text-lg font-semibold text-slate-900"},s.name),React.createElement("button",{onClick:r,className:"rounded-full border border-transparent p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close"},React.createElement(Yt,{className:"h-5 w-5"}))),React.createElement("div",{className:"grid gap-6 p-5 lg:grid-cols-[minmax(0,1fr)_260px]"},React.createElement("div",{className:"space-y-6"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-2xl border border-[var(--surface-border)] bg-slate-100"},React.createElement("img",{src:g[0],onError:p=>{p.currentTarget.src=Pe(s.name)},alt:`${s.name} \u2013 photo`,className:"h-full w-full object-cover"})),s.description&&React.createElement("p",{className:"text-sm text-slate-600"},s.description),m.map(p=>{const S=i[p]||[],w=c[p]||[],O=p.toLowerCase().includes("color")||p==="Color";return React.createElement("div",{key:p,className:"rounded-2xl border border-[var(--surface-border)] bg-white/80 p-4 text-sm shadow-sm backdrop-blur"},React.createElement("div",{className:"mb-2 flex flex-wrap items-center justify-between gap-2"},React.createElement("span",{className:"text-sm font-semibold text-slate-900"},p),S.length?React.createElement("div",{className:"flex items-center gap-2 text-xs text-slate-500"},React.createElement("button",{type:"button",onClick:()=>W(p),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:()=>j(p),className:"rounded-full border border-[var(--surface-border)] px-2 py-1 font-medium hover:bg-white/60"},"Clear")):null),React.createElement("div",{className:"max-h-32 overflow-auto rounded-xl border border-[var(--surface-border)] bg-white/70 p-2"},React.createElement("div",{className:"flex flex-wrap gap-2 text-xs"},S.length===0?React.createElement("p",{className:"text-slate-500"},"No options"):S.map(_=>{const z=w.includes(_);return React.createElement("button",{type:"button",key:_,onClick:()=>U(p,_),className:q("inline-flex items-center gap-1 rounded-full border px-3 py-1 font-medium transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",z?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},O?React.createElement(Ae,{name:_}):null,_)}))))}),React.createElement("div",{className:"space-y-3","aria-label":"Quantities"},L.length===0?React.createElement("p",{className:"text-xs text-slate-500"},"Select at least one option."):L.map(({key:p,sel:S})=>{const w=l[p]!==void 0?l[p]:p===re?l[re]:void 0,O=h[p]||0,_=typeof w=="number"?Math.max(w-O,0):void 0,z=typeof _=="number"&&_<=0,se=A[p];return React.createElement("div",{key:p,className:q("rounded-2xl border px-3 py-3 text-sm shadow-sm backdrop-blur sm:flex sm:items-center sm:justify-between",z?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/85 text-slate-700")},React.createElement("div",{className:"space-y-1 text-sm"},Object.entries(S).map(([R,D],Q)=>React.createElement("span",{key:`${R}-${D}`},Q>0?" \xB7 ":"",R==="Color"?React.createElement("span",{className:"inline-flex items-center gap-1"},React.createElement(Ae,{name:D}),D):React.createElement("span",{className:"font-medium text-slate-900"},D))),Object.keys(S).length===0&&React.createElement("span",{className:"font-medium text-slate-900"},"Quantity"),typeof w=="number"?React.createElement("p",{className:"text-xs text-slate-500"},`Remaining: ${Math.max(w-O,0)}${O>0?` (of ${w})`:""}`):React.createElement("p",{className:"text-xs text-slate-500"},"No stock limit")),React.createElement("div",{className:"mt-2 sm:mt-0"},React.createElement(Vt,{value:Number(B[p]||0),onChange:R=>v(p,R),min:0,max:typeof _=="number"?_:void 0,onLimit:R=>{typeof R=="number"&&Number.isFinite(R)&&k(D=>({...D,[p]:R}))}})),se!==void 0?React.createElement("p",{className:"mt-2 text-xs font-medium text-rose-600 sm:ml-3 sm:mt-0 sm:text-right"},`Only ${se} available for this selection.`):null)}))),React.createElement("aside",{className:"glass-card rounded-3xl space-y-5 p-5"},React.createElement("div",{className:"space-y-2 text-sm"},React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Unit price"),React.createElement("span",{className:"font-semibold text-slate-900"},ge(s.price))),React.createElement("div",{className:"flex items-center justify-between text-slate-500"},React.createElement("span",null,"Selections"),React.createElement("span",{className:"font-medium text-slate-800"},L.length))),React.createElement("div",{className:"flex items-center justify-between rounded-2xl border border-[rgba(37,99,235,0.28)] bg-[rgba(37,99,235,0.12)] px-4 py-3 text-sm font-medium text-brand"},React.createElement("span",{className:"uppercase tracking-[0.18em]"},"Line total"),React.createElement("span",{className:"text-base font-semibold text-brand"},ge(H))),React.createElement("p",{className:"text-xs text-slate-500"},"Add items to the cart and send the final list to WhatsApp when you are ready."),React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("button",{disabled:C,onClick:x,className:q("w-full rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",C?"pointer-events-none opacity-50":"hover:bg-brand-muted")},"Add to cart"),React.createElement("button",{onClick:r,className:"w-full rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Cancel"))))))}function Vt({id:a,value:r,onChange:t,min:o=0,max:s,onLimit:d}){const l=i=>{typeof s=="number"&&Number.isFinite(s)&&typeof d=="function"&&i>s&&d(s)},h=(i,m)=>{l(typeof m=="number"?m:i);let c=Math.max(o,i);return typeof s=="number"&&Number.isFinite(s)&&(c=Math.min(s,c)),c},f=Number(r)||0,g=typeof s=="number"&&Number.isFinite(s)&&f>=s;return React.createElement("div",{className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/70 shadow-sm backdrop-blur",role:"group","aria-label":"Quantity"},React.createElement("button",{onClick:()=>t(h((Number(r)||0)-1,(Number(r)||0)-1)),className:"rounded-l-full px-3 py-1.5 text-slate-700 transition hover:bg-brand-soft focus:outline-none focus-visible:outline-2 focus-visible:outline-brand touch-manipulation select-none","aria-label":"Decrease quantity"},"\u2212"),React.createElement("input",{id:a,inputMode:"numeric",pattern:"[0-9]*",value:String(r),onChange:i=>{const m=Number(i.target.value.replace(/[^0-9]/g,"")),c=Number.isFinite(m)?m:o;t(Number.isFinite(m)?h(c,c):o)},className:"w-14 appearance-none border-x border-[var(--surface-border)] bg-transparent px-2 py-1.5 text-center text-base sm:text-sm text-slate-900 focus:outline-none"}),React.createElement("button",{onClick:()=>t(h((Number(r)||0)+1,(Number(r)||0)+1)),className:q("rounded-r-full px-3 py-1.5 touch-manipulation select-none transition focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",g?"cursor-not-allowed text-slate-300":"text-slate-700 hover:bg-brand-soft"),"aria-label":"Increase quantity",disabled:g},"+"))}async function sr(a){var r;try{if((r=navigator.clipboard)!=null&&r.writeText)return await navigator.clipboard.writeText(a),!0}catch(t){}try{const t=document.createElement("textarea");return t.value=a,t.setAttribute("readonly",""),t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),!0}catch(t){return!1}}function nr({open:a,onClose:r,cart:t,productLookup:o}){const s=ae(null);at(a,s,r);const d=Ba(),l=J(()=>or(t.items,t.subtotal,t.notes),[t.items,t.subtotal,t.notes]),h=t.items.some(u=>Number(u.qty)>0),f=`https://wa.me/${me}?text=${encodeURIComponent(l)}`,g=`whatsapp://send?phone=${me}&text=${encodeURIComponent(l)}`,i=/Android|iPhone|iPad|iPod|Windows Phone/i.test(navigator.userAgent),[m,c]=E({});return I(()=>{c(u=>{const B=new Set((t.items||[]).map(k=>{if(!k)return null;const U=k.inventoryKey||ye(k.variants||{});return`${k.id||""}::${U}`}).filter(Boolean));let P=!1;const A={};return Object.entries(u).forEach(([k,U])=>{B.has(k)?A[k]=U:P=!0}),P?A:u})},[t.items]),React.createElement("div",{"aria-live":"polite"},React.createElement("div",{className:q("fixed inset-0 z-40 bg-black/40 transition-opacity",a?"opacity-100":"pointer-events-none opacity-0"),onClick:r,onTouchMove:u=>{u.preventDefault()},onTouchStart:u=>{u.preventDefault()},onWheel:u=>{u.preventDefault()},"aria-hidden":"true"}),React.createElement("aside",{role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",className:q("fixed right-0 top-0 z-50 h-full w-full max-w-md transform border-l border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none overscroll-contain",d?"transition-none":"transition-transform duration-200 ease-out",a?"translate-x-0":"translate-x-full")},React.createElement("div",{ref:s,className:"flex h-full flex-col"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{id:"cart-title",className:"text-lg font-semibold text-slate-900"},"Your cart"),React.createElement("button",{onClick:r,className:"rounded-full p-2 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Close cart"},React.createElement(Yt,{className:"h-5 w-5"}))),React.createElement("div",{className:"flex-1 overflow-y-auto p-4",style:{touchAction:"pan-y"}},t.items.length===0?React.createElement("p",{className:"text-sm text-slate-500"},"Your cart is empty."):React.createElement("ul",{className:"space-y-3"},t.items.map((u,B)=>{const P=o&&typeof o.get=="function"?o.get(u.id):void 0,A=P?He(P.inventory):{},k=u.inventoryKey||ye(u.variants||{}),U=A[k]!==void 0?A[k]:k===re?A[re]:void 0;let W=0;t.items.forEach((C,p)=>{if(p===B||!C||C.id!==u.id)return;(C.inventoryKey||ye(C.variants||{}))===k&&(W+=Number(C.qty||0))});const j=typeof U=="number"?Math.max(U-W,0):void 0,v=typeof j=="number"&&u.qty>j,L=typeof j=="number"?`Available: ${j}`:null,x=`${u.id||""}::${k}`,H=m[x];return React.createElement("li",{key:B,className:q("rounded-2xl border p-3 shadow-sm backdrop-blur transition",v?"border-rose-200 bg-rose-50/80 text-rose-700":"border-[var(--surface-border)] bg-white/80 text-slate-700")},React.createElement("div",{className:"flex items-start justify-between gap-3"},React.createElement("div",null,React.createElement("p",{className:"font-semibold text-slate-900"},u.name),React.createElement("p",{className:"text-xs text-slate-500"},"SKU: ",u.sku),u.variants&&Object.keys(u.variants).length>0&&React.createElement("div",{className:"mt-1 flex flex-wrap gap-1.5"},Object.entries(u.variants).map(([C,p])=>React.createElement("span",{key:C,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2 py-0.5 text-xs font-medium text-slate-600"},C==="Color"?React.createElement(React.Fragment,null,React.createElement(Ae,{name:p}),`${C}: ${p}`):`${C}: ${p}`))),L&&React.createElement("p",{className:"mt-1 text-xs text-slate-500"},L),H!==void 0?React.createElement("p",{className:"mt-1 text-xs font-medium text-rose-600"},`Only ${H} available for this selection.`):null),React.createElement("button",{onClick:()=>t.removeIndex(B),className:"rounded-full p-1.5 text-slate-500 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":`Remove ${u.name}`},React.createElement(Ga,{className:"h-4 w-4 text-slate-500"}))),React.createElement("div",{className:"mt-2 flex items-center justify-between"},React.createElement(Vt,{value:u.qty,onChange:C=>{const p=typeof j=="number"?Math.min(C,j):C;t.updateQty(B,p),c(S=>{const w=S[x];if(w===void 0)return S;if(p<w){const O={...S};return delete O[x],O}return S})},min:0,max:typeof j=="number"?j:void 0,onLimit:C=>{typeof C=="number"&&Number.isFinite(C)&&c(p=>({...p,[x]:C}))}}),React.createElement("div",{className:"text-sm text-slate-600"},ge(u.price)," \xD7 ",u.qty," = ",React.createElement("span",{className:"font-semibold text-slate-900"},ge(u.price*u.qty)))))}))),React.createElement("div",{className:"border-t border-[var(--surface-border)] bg-white/60 p-4 backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-sm text-slate-600"},React.createElement("span",null,"Subtotal"),React.createElement("span",{className:"font-semibold text-slate-900"},ge(t.subtotal))),React.createElement("label",{className:"mt-3 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Notes"),React.createElement("textarea",{value:t.notes,onChange:u=>t.setNotes(u.target.value),rows:2,className:"w-full resize-none rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Delivery preferences, color mix, etc."})),React.createElement("div",{className:"mt-3 flex gap-3"},React.createElement("button",{onClick:t.clear,className:"flex-1 rounded-full border border-[var(--surface-border)] bg-white/70 px-4 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear cart"),React.createElement("button",{type:"button",onClick:async()=>{if(!h){alert("Add at least one product before sending an order.");return}if(t.items.filter((k,U)=>{const W=o&&typeof o.get=="function"?o.get(k.id):void 0,j=W?He(W.inventory):{},v=k.inventoryKey||ye(k.variants||{}),L=j[v]!==void 0?j[v]:v===re?j[re]:void 0;if(typeof L!="number")return!1;let x=0;t.items.forEach((C,p)=>{if(p===U||!C||C.id!==k.id)return;(C.inventoryKey||ye(C.variants||{}))===v&&(x+=Number(C.qty||0))});const H=Math.max(L-x,0);return k.qty>H}).length>0){alert("One or more items exceed available stock. Please adjust the quantities before sending the order.");return}try{await je("createOrder",{currency:pe,subtotal_cents:Math.round(t.subtotal*100),notes:t.notes||"",items:t.items.map((k,U)=>({product_id:k.id,sku:k.sku,name:k.name,quantity:Number(k.qty)||0,unit_price_cents:Math.round(Number(k.price||0)*100),subtotal_cents:Math.round(Number(k.price||0)*Number(k.qty||0)*100),variants:k.variants||{},inventory_key:k.inventoryKey||ye(k.variants||{})}))})}catch(k){console.error("Failed to record order",k)}try{await sr(l),alert("\u2705 Your list is copied! If WhatsApp doesn't open, you can paste it manually.")}catch(k){alert("\u{1F4CB} Please copy your order manually if WhatsApp doesn't open automatically.")}let B=!1;const P=()=>{B||(B=!0,t.clear(),t.setNotes(""))},A=()=>P();if(window.addEventListener("pagehide",A,{once:!0}),document.addEventListener("visibilitychange",function k(){document.hidden&&(P(),document.removeEventListener("visibilitychange",k))},{once:!0}),i)P(),window.location.href=g,setTimeout(()=>{try{window.open(f,"_blank","noopener,noreferrer")}catch(k){}},800);else{const k=window.open(f,"_blank","noopener,noreferrer");setTimeout(P,500)}},className:q("flex-1 inline-flex items-center justify-center gap-2 rounded-full px-4 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",h?"bg-brand hover:bg-brand-muted":"pointer-events-none bg-[rgba(37,99,235,0.28)] text-white/70")},"Send via WhatsApp",React.createElement(Qt,{className:"h-4 w-4 text-white"})))))))}function or(a,r,t){const o=(a||[]).filter(d=>Number(d.qty)>0);let s=`\u{1F6D2} *Order Request*

`;return o.forEach(d=>{s+=`\u2022 ${d.name} (SKU: ${d.sku})
`,d.variants&&Object.keys(d.variants).length>0&&(s+=`  Variants: ${Object.entries(d.variants).map(([l,h])=>`${l}: ${h}`).join(", ")}
`),s+=`  Qty: ${d.qty} \xD7 ${ge(d.price)} = ${ge(d.price*d.qty)}

`}),s+=`*Subtotal: ${ge(r)}*

`,(t||"").trim()&&(s+=`*Notes:* ${t.trim()}

`),s+="Please confirm availability and pricing. Thank you!",s}function lr({addProduct:a,onNotify:r,catalogConfig:t,saveCatalogConfig:o}){var oa;const s=Array.isArray(t==null?void 0:t.categories)&&t.categories.length?t.categories:pt.filter(e=>e!=="All"),d=Array.isArray(t==null?void 0:t.families)&&t.families.length?t.families:xt().families,[l,h]=E(s[0]||"Phone Screens"),[f,g]=E(((oa=d[0])==null?void 0:oa.id)||"iphone"),i=d.find(e=>e&&e.id===f)||d[0]||{name:"iPhone",models:Le},m=Array.isArray(i==null?void 0:i.models)?i.models:[];I(()=>{s.includes(l)||h(s[0]||"Phone Screens")},[s]),I(()=>{var e;d.some(n=>n&&n.id===f)||g(((e=d[0])==null?void 0:e.id)||"iphone")},[d]);const[c,u]=E("");I(()=>{u(e=>{const n=new Set(s),b=(e||"").trim(),y=n.has(b.replace(" \u2014",""))||b.endsWith(" \u2014");return!b||y?`${l} \u2014 `:e})},[l,s]);const[B,P]=E(""),[A,k]=E(""),[U,W]=E(""),[j,v]=E([]),[L,x]=E([]),[H,C]=E(null),[p,S]=E(!1),[w,O]=E({}),[_,z]=E(!1),[se,R]=E(""),[D,Q]=E({}),V=e=>String(e||"").toLowerCase().includes("multi"),X=e=>V(e==null?void 0:e.mode),le=e=>V(e)?"multi":"single",Oe=e=>e==="familyModels"?"familyModels":"static",xe=(e,n)=>{if(!e||typeof e!="object")return e;const b={...e};return b.mode=le(e.mode),b.optionsSource=Oe(e.optionsSource),b.options=Array.isArray(e.options)?e.options:[],n==="customer"?b.fieldType="select":b.fieldType=e.fieldType==="checkbox"?"checkbox":"select",b},Fe=e=>({info:((e==null?void 0:e.info)||[]).map(n=>xe(n,"info")).filter(Boolean),customer:((e==null?void 0:e.customer)||[]).map(n=>xe(n,"customer")).filter(Boolean)}),Rt=()=>{var b;const e=(b=t==null?void 0:t.groupOverridesByCategoryFamily)==null?void 0:b[l],n=e==null?void 0:e[f];return!n||typeof n!="object"?null:{info:n.info&&typeof n.info=="object"?n.info:{},customer:n.customer&&typeof n.customer=="object"?n.customer:{}}},Nt=()=>{var b;const e=(b=t==null?void 0:t.groupHiddenByCategoryFamily)==null?void 0:b[l],n=e==null?void 0:e[f];return!n||typeof n!="object"?{info:[],customer:[]}:{info:Array.isArray(n.info)?n.info:[],customer:Array.isArray(n.customer)?n.customer:[]}},F=e=>{const n=Rt(),b=Nt(),y=(N,M)=>{const G=new Set(((b==null?void 0:b[M])||[]).map(Y=>String(Y))),T=(n==null?void 0:n[M])||{},te=(Array.isArray(N)?N:[]).filter(Y=>Y&&!G.has(String(Y.id))).map(Y=>{const ne=T[String(Y.id)];return xe(ne&&typeof ne=="object"?{...Y,...ne}:Y,M)});return Object.keys(T||{}).forEach(Y=>{if(G.has(String(Y))||te.some(Ce=>String(Ce.id)===String(Y)))return;const ne=T[Y];ne&&typeof ne=="object"&&te.push(xe({id:Y,...ne},M))}),te.filter(Boolean)};return{info:y(e==null?void 0:e.info,"info"),customer:y(e==null?void 0:e.customer,"customer")}},K=(e,n)=>{x([]),C(null),O(b=>({...b,[e]:n}))},Z=(e,n)=>O(b=>{x([]),C(null);const y=Array.isArray(b[e])?b[e]:[];return{...b,[e]:y.includes(n)?y.filter(N=>N!==n):[...y,n]}});function he(e){x([]),C(null);const n=Array.from(e.target.files||[]);if(!n.length)return;const b=n.map(y=>new Promise(N=>{const M=new FileReader;M.onload=()=>N(String(M.result||"")),M.readAsDataURL(y)}));Promise.all(b).then(y=>v(N=>[...N,...y]))}const ue=e=>Array.isArray(e)&&e.length?e[0]:e!=null?e:"",st={"Phone Screens":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"display",label:"Display type/quality",type:"select",options:["OLED \u2013 OEM","OLED \u2013 AAA","LCD \u2013 OEM","LCD \u2013 AAA"]},{key:"frame",label:"Frame",type:"select",options:["With frame","Without frame"]}],also:[{key:"frontColor",label:"Front color",type:"select",options:["Black","White"]},{key:"retention",label:"True Tone/Face ID retention",type:"checkbox"}],optional:[{key:"adhesive",label:"Pre-installed adhesive / waterproof gasket",type:"checkbox"}],name:e=>`Screen \u2014 ${ue(e.models)} ${e.display?`${String(e.display).split(" ")[0]}`:""}`.trim(),specs:e=>[e.display,e.frame,e.frontColor].filter(Boolean)},"Back Glass":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"colors",label:"Colors / finish",type:"multiselect",options:ze}],also:[{key:"adhesive",label:"Adhesive pre-installed",type:"checkbox"},{key:"rings",label:"With camera rings",type:"checkbox"}],optional:[{key:"grade",label:"Quality grade",type:"select",options:Lt}],name:e=>`Back Glass \u2014 ${ue(e.models)}`.trim(),specs:e=>[ue(e.colors)||null,e.grade,e.adhesive?"Adhesive":null,e.rings?"Camera rings":null].filter(Boolean)},"Power Banks":{must:[{key:"capacity",label:"Capacity",type:"select",options:Aa},{key:"ports",label:"Output ports",type:"select",options:Wt}],also:[{key:"standard",label:"Standard",type:"select",options:Te}],optional:[{key:"colour",label:"Colour",type:"select",options:ze}],name:e=>`Power bank \u2014 ${e.capacity||""}`.trim(),specs:e=>[e.capacity,e.ports,e.standard].filter(Boolean)},"Screen Protectors":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:ya},{key:"pack",label:"Pack",type:"select",options:xa}],also:[{key:"finish",label:"Finish",type:"select",options:ga},{key:"coverage",label:"Coverage",type:"select",options:ha}],optional:[],name:e=>`Protector \u2014 ${ue(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,e.finish,e.coverage].filter(Boolean)},Batteries:{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"grade",label:"Grade",type:"select",options:Lt}],also:[],optional:[{key:"capacity",label:"Capacity (mAh)",type:"text",placeholder:"e.g. 3000"}],name:e=>`Battery \u2014 ${ue(e.models)}`.trim(),specs:e=>[e.grade,e.capacity].filter(Boolean)},"Mobile Phones":{must:[{key:"model",label:"Model",type:"text",placeholder:"e.g., iPhone 13"},{key:"cond",label:"Condition/grade",type:"select",options:Dt},{key:"sim",label:"SIM",type:"select",options:Na}],also:[{key:"connect",label:"Connectivity",type:"select",options:ka},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Ut},{key:"ram",label:"RAM",type:"multiselect",options:$t},{key:"color",label:"Color",type:"text"},{key:"inbox",label:"Accessories in box",type:"text",placeholder:"Cable, charger"}],name:e=>`${e.model||""} ${e.cond||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.cond,e.sim,e.connect].filter(Boolean)},Tablets:{must:[{key:"model",label:"Model",type:"text",placeholder:"iPad 10th Gen"},{key:"conn",label:"Connectivity",type:"select",options:Ca}],also:[{key:"screen",label:"Screen size",type:"text",placeholder:'10.9"'},{key:"warranty",label:"Warranty (months)",type:"number"}],optional:[{key:"storage",label:"Storage",type:"multiselect",options:Ut},{key:"ram",label:"RAM",type:"multiselect",options:$t},{key:"cond",label:"Condition/grade",type:"select",options:Dt},{key:"color",label:"Color",type:"text"},{key:"compat",label:"Pencil/keyboard compatibility",type:"text"}],name:e=>`${e.model||""} ${e.conn||""}`.trim(),specs:e=>[Array.isArray(e.storage)&&e.storage[0]||null,Array.isArray(e.ram)&&e.ram[0]||null,e.conn,e.screen,e.cond].filter(Boolean)},"Phone Cases":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"material",label:"Material",type:"select",options:fa}],also:[{key:"color",label:"Color",type:"multiselect",options:ze}],optional:[{key:"pattern",label:"Pattern / style",type:"text"}],name:e=>`Case \u2014 ${ue(e.models)} ${e.material?`(${e.material})`:""}`.trim(),specs:e=>[e.material,ue(e.color)||null].filter(Boolean)},Cables:{must:[{key:"connector",label:"Connector",type:"select",options:ht},{key:"length",label:"Length",type:"select",options:Tt}],also:[{key:"rating",label:"Power rating",type:"select",options:Ft},{key:"durability",label:"Durability",type:"select",options:wa}],optional:[{key:"cert",label:"Certs",type:"select",options:va}],name:e=>`Cable \u2014 ${e.connector||""} ${e.length?`(${e.length})`:""}`.trim(),specs:e=>[e.connector,e.length,e.rating].filter(Boolean)},Chargers:{must:[{key:"wattage",label:"Wattage",type:"select",options:Ea||["20W","30W","45W","65W"]},{key:"ports",label:"Ports",type:"select",options:Wt}],also:[{key:"standard",label:"Standard",type:"select",options:Te},{key:"plug",label:"Plug type",type:"select",options:Ra}],optional:[],name:e=>`Charger \u2014 ${e.wattage||""}`.trim(),specs:e=>[e.wattage,e.ports].filter(Boolean)},Earphones:{must:[{key:"type",label:"Type",type:"select",options:["Wired","TWS"]}],also:[{key:"connector",label:"Connector / Standard",type:"select",options:[...ht,...Te]}],optional:[{key:"color",label:"Color",type:"select",options:ze}],name:e=>`Earphones \u2014 ${e.type||""}`.trim(),specs:e=>[e.type,e.connector].filter(Boolean)},"Charging Ports":{must:[{key:"models",label:"Phone models",type:"phoneModels"},{key:"type",label:"Port type",type:"select",options:["USB-C","Lightning","Micro-USB"]}],also:[],optional:[{key:"solderRequired",label:"Solder required",type:"checkbox"}],name:e=>`Charging port \u2014 ${ue(e.models)}`.trim(),specs:e=>[e.type,e.solderRequired?"Solder":null].filter(Boolean)},"Face ID":{must:[{key:"models",label:"Phone models",type:"phoneModels",allowedBrands:["iPhone"]},{key:"service",label:"Service",type:"select",options:["Repair","Replace","Calibration"]}],also:[],optional:[],name:e=>`Face ID \u2014 ${ue(e.models)}`.trim(),specs:e=>[e.service].filter(Boolean)}},Be=e=>{const n=st[e]||{must:[],also:[],optional:[]},b=[...n.must||[],...n.also||[],...n.optional||[]],y={info:[],customer:[]};return b.forEach(N=>{if(!N||!N.key)return;const M={id:N.key,label:N.label,schemaKey:N.key,fieldType:N.type,options:Array.isArray(N.options)?N.options:[]};if(N.type==="phoneModels"){y.customer.push({...M,key:"Model",mode:"multi",optionsSource:"familyModels"});return}if(N.type==="multiselect"){y.customer.push({...M,key:gt(N.label,N.key),mode:"multi",optionsSource:"static"});return}y.info.push({...M,mode:N.type==="multiselect"?"multi":"single",optionsSource:"static"})}),y},Ye=()=>{var n;const e=(n=t==null?void 0:t.groupsByCategory)==null?void 0:n[l];return e&&e.info&&e.customer?e:null},fe=J(()=>{const e=Ye(),n=Fe(e||Be(l)),b=F(n),y=(b.customer||[]).map(N=>N&&N.key==="Model"?{...N,label:`${(i==null?void 0:i.name)||"Phone"} models`}:N);return{...b,customer:y}},[t,l,f]),Zt=async e=>{const n=Xe(t);n.groupsByCategory=n.groupsByCategory||{},n.groupsByCategory[l]=e,await o(n)},nt=async()=>{const e=Ye();if(e)return e;const n=Be(l);return await Zt(n),n};I(()=>{const e={};(fe.info||[]).forEach(n=>{!n||!n.schemaKey||(n.fieldType==="select"||n.fieldType==="number"||n.fieldType==="text"?e[n.schemaKey]="":n.fieldType==="checkbox"?e[n.schemaKey]=!1:X(n)?e[n.schemaKey]=[]:e[n.schemaKey]="")}),(fe.customer||[]).forEach(n=>{!n||!n.schemaKey||(X(n)?e[n.schemaKey]=[]:e[n.schemaKey]="")}),O(e)},[l,fe]);const[Ee,ie]=E(null),[de,_e]=E({scope:"info",id:null,label:"",key:"",mode:"single",fieldType:"select",optionsSource:"static",optionsText:""}),[Xt,We]=E(""),[Wr,ea]=E(""),[ta,kt]=E(""),[Re,De]=E({id:null,name:"",modelsText:""}),mr=e=>{try{return JSON.parse(JSON.stringify(e))}catch(n){return e}},ur=e=>String(e||"").toLowerCase().trim().replace(/[^a-z0-9]+/g,"_").replace(/^_+|_+$/g,""),Ue=async e=>{const n=Xe(t),b=mr(n),y=(typeof e=="function"?e(b):b)||b;await o(y)},pr=()=>{De({id:null,name:"",modelsText:""}),ie({type:"family"})},br=()=>{kt(""),ie({type:"category"})},fr=async()=>{const e=String(ta||"").trim();e&&(await Ue(n=>{const b=Array.isArray(n.categories)?[...n.categories]:[];return b.includes(e)||b.push(e),n.categories=b,n}),h(e),kt(""),ie(null))},yr=async e=>{const n=String(e||"").trim();n&&confirm(`Remove category "${n}"? Existing products will still keep their category text.`)&&await Ue(b=>(b.categories=(Array.isArray(b.categories)?b.categories:[]).filter(y=>y!==n),b))},gr=e=>{const n=Array.isArray(e==null?void 0:e.models)?e.models:[];De({id:(e==null?void 0:e.id)||null,name:(e==null?void 0:e.name)||"",modelsText:n.join(`
`)})},xr=async()=>{const e=String(Re.name||"").trim();if(!e)return;const n=String(Re.modelsText||"").split(`
`).map(M=>M.trim()).filter(Boolean),b=Array.from(new Set(n)),y=Re.id?String(Re.id):null;let N=y||ur(e)||`family_${Date.now()}`;await Ue(M=>{const G=Array.isArray(M.families)?[...M.families]:[];if(y)return M.families=G.map(T=>T&&T.id===y?{...T,name:e,models:b}:T),M;{const T=N;let te=2;for(;G.some(Y=>Y&&Y.id===N);)N=`${T}_${te++}`;G.push({id:N,name:e,models:b})}return M.families=G,M}),g(N),De({id:null,name:"",modelsText:""}),ie(null)},hr=async e=>{const n=String((e==null?void 0:e.id)||"").trim(),b=String((e==null?void 0:e.name)||"").trim();n&&confirm(`Remove family "${b||n}"? Existing products will still keep their family meta.`)&&await Ue(y=>(y.families=(Array.isArray(y.families)?y.families:[]).filter(N=>N&&N.id!==n),y))},aa=async e=>{await nt(),We(""),ea(""),_e({scope:e,id:null,label:"",key:"",mode:e==="customer"?"multi":"single",fieldType:"select",optionsSource:"static",optionsText:""}),ie({type:"group"})},ra=async(e,n)=>{await nt(),We(""),ea("");const b=e==="info"&&n.fieldType==="checkbox",y=b?`Yes
No`:(Array.isArray(n.options)?n.options:[]).join(`
`);_e({scope:e,id:n.id,label:n.label||"",key:n.key||"",mode:b?"single":V(n.mode)?"multi":"single",fieldType:"select",optionsSource:n.optionsSource||"static",optionsText:y}),ie({type:"group"})},vr=e=>Array.from(new Set(String(e||"").split(/[,;\n]/g).map(n=>n.trim()).filter(Boolean))),Dr=e=>{const n=Array.from(new Set((Array.isArray(e)?e:[]).map(b=>String(b).trim()).filter(Boolean)));_e(b=>({...b,optionsText:n.join(`
`)}))},Ur=()=>{},$r=()=>{},sa=async(e,n)=>{await nt();const b=String((n==null?void 0:n.id)||"").trim();b&&(await Ue(y=>{y.groupHiddenByCategoryFamily=y.groupHiddenByCategoryFamily&&typeof y.groupHiddenByCategoryFamily=="object"?y.groupHiddenByCategoryFamily:{},y.groupOverridesByCategoryFamily=y.groupOverridesByCategoryFamily&&typeof y.groupOverridesByCategoryFamily=="object"?y.groupOverridesByCategoryFamily:{},y.groupHiddenByCategoryFamily[l]=y.groupHiddenByCategoryFamily[l]||{},y.groupHiddenByCategoryFamily[l][f]=y.groupHiddenByCategoryFamily[l][f]||{info:[],customer:[]};const N=e==="customer"?"customer":"info",M=Array.isArray(y.groupHiddenByCategoryFamily[l][f][N])?y.groupHiddenByCategoryFamily[l][f][N]:[];M.includes(b)||M.push(b),y.groupHiddenByCategoryFamily[l][f][N]=M,y.groupOverridesByCategoryFamily[l]=y.groupOverridesByCategoryFamily[l]||{},y.groupOverridesByCategoryFamily[l][f]=y.groupOverridesByCategoryFamily[l][f]||{info:{},customer:{}};const G=y.groupOverridesByCategoryFamily[l][f][N];return G&&typeof G=="object"&&delete G[b],y}),O(y=>{const N={...y},M=n.schemaKey||n.id;return delete N[M],N}))},wr=async()=>{var ne,Ce;const e=await nt(),n=de.scope,b=String(de.label||"").trim();if(!b){We("Group name is required.");return}const y=de.mode==="multi"?"multi":"single",N=de.optionsSource==="familyModels"?"familyModels":"static",M=N==="familyModels"?[]:vr(de.optionsText);if(n==="info"&&N!=="familyModels"&&M.length===0){We("Add at least one option (comma or new line).");return}const G=!de.id,T=de.id||`og_${Date.now()}`,te=G?T:(ne=(e[n]||[]).find($=>String($.id)===String(T)))==null?void 0:ne.schemaKey,Y={id:T,label:b,schemaKey:te||T,fieldType:"select",options:M,optionsSource:N,mode:y};if(n==="customer"){const $=G?"":(Ce=(e.customer||[]).find(ee=>ee&&String(ee.id)===String(T)))==null?void 0:Ce.key;Y.key=String($||"").trim()||gt(b,T)}if(G){const ee=[...n==="customer"?e.customer||[]:e.info||[],Y];if(n==="customer"&&y==="multi"&&ee.filter(Me=>V(Me==null?void 0:Me.mode)).length>2){We("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}const ve=n==="customer"?{...e,customer:ee}:{...e,info:ee};await Zt(ve)}else{if(n==="customer"&&y==="multi"&&(Array.isArray(fe.customer)?fe.customer:[]).map(ce=>String(ce.id)===String(T)?{...ce,...Y}:ce).filter(ce=>V(ce==null?void 0:ce.mode)).length>2){We("Only 2 customer option groups can be MULTI. Change another group to SINGLE first.");return}await Ue($=>{$.groupOverridesByCategoryFamily=$.groupOverridesByCategoryFamily&&typeof $.groupOverridesByCategoryFamily=="object"?$.groupOverridesByCategoryFamily:{},$.groupHiddenByCategoryFamily=$.groupHiddenByCategoryFamily&&typeof $.groupHiddenByCategoryFamily=="object"?$.groupHiddenByCategoryFamily:{},$.groupOverridesByCategoryFamily[l]=$.groupOverridesByCategoryFamily[l]||{},$.groupOverridesByCategoryFamily[l][f]=$.groupOverridesByCategoryFamily[l][f]||{info:{},customer:{}};const ee=n==="customer"?"customer":"info";$.groupOverridesByCategoryFamily[l][f][ee]=$.groupOverridesByCategoryFamily[l][f][ee]||{},$.groupOverridesByCategoryFamily[l][f][ee][String(T)]=Y,$.groupHiddenByCategoryFamily[l]=$.groupHiddenByCategoryFamily[l]||{},$.groupHiddenByCategoryFamily[l][f]=$.groupHiddenByCategoryFamily[l][f]||{info:[],customer:[]};const ve=Array.isArray($.groupHiddenByCategoryFamily[l][f][ee])?$.groupHiddenByCategoryFamily[l][f][ee]:[];return $.groupHiddenByCategoryFamily[l][f][ee]=ve.filter(ce=>String(ce)!==String(T)),$})}ie(null)},Gr=({f:e})=>{var y,N;if(!e)return null;const n="mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500",b="w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand";if(e.type==="select")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:n},e.label),React.createElement("select",{value:(y=w[e.key])!=null?y:"",onChange:M=>K(e.key,M.target.value),className:b},(e.options||[]).map(M=>React.createElement("option",{key:M,value:M},M))));if(e.type==="text"||e.type==="number")return React.createElement("label",{className:"block text-sm text-slate-600 space-y-1"},React.createElement("span",{className:n},e.label),React.createElement("input",{type:e.type,value:(N=w[e.key])!=null?N:"",onChange:M=>K(e.key,e.type==="number"?M.target.value.replace(/[^0-9.]/g,""):M.target.value),placeholder:e.placeholder||"",className:b}));if(e.type==="checkbox")return React.createElement("label",{className:"inline-flex items-center gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:!!w[e.key],onChange:M=>K(e.key,M.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),React.createElement("span",null,e.label));if(e.type==="multiselect"){const M=e.options||[],G=Array.isArray(w[e.key])?w[e.key]:[];return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},e.label),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:()=>K(e.key,M),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>K(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},M.map(T=>{const te=G.includes(T),Y=et[T]!==void 0||/color/i.test(e.label);return React.createElement("button",{type:"button",key:T,onClick:()=>Z(e.key,T),className:q("inline-flex items-center gap-1 rounded-full border px-2.5 py-1 font-medium transition",te?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y?React.createElement(React.Fragment,null,React.createElement(Ae,{name:T}),T):T)})))}if(e.type==="phoneModels"){const M=m,G=Array.isArray(w[e.key])?w[e.key]:[];return React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between text-xs text-slate-500"},React.createElement("span",{className:"font-semibold text-slate-800"},`${(i==null?void 0:i.name)||"Phone"} models`),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("button",{type:"button",onClick:()=>K(e.key,M),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Select all"},"All"),React.createElement("button",{type:"button",onClick:()=>K(e.key,[]),className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium hover:bg-white/60",title:"Clear"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},M.map(T=>{const te=G.includes(T),Y=String(T).startsWith("iPhone ")?String(T).replace("iPhone ",""):T;return React.createElement("button",{type:"button",key:T,onClick:()=>{const ne=Array.isArray(w[e.key])?w[e.key]:[];K(e.key,te?ne.filter(Ce=>Ce!==T):[...ne,T])},className:q("rounded-full border px-2.5 py-1 font-medium transition",te?"border-transparent bg-brand text-white shadow-sm":"border-[var(--surface-border)] bg-white/80 text-slate-700 hover:text-slate-900 hover:bg-white")},Y)})))}return null},Qe=e=>e.schemaKey||e.id,na=e=>e?e.optionsSource==="familyModels"?m:Array.isArray(e.options)?e.options:[]:[],Ct=J(()=>{const e={};return(fe.customer||[]).forEach(n=>{if(!n)return;const b=n.key||gt(n.label,n.schemaKey||n.id),y=Qe(n),N=w[y];if(X(n)){const te=(Array.isArray(N)?N:N==null?[]:[N]).map(Y=>String(Y).trim()).filter(Boolean);te.length&&(e[b]=Array.from(new Set(te)));return}const M=Array.isArray(N)?N[0]:N,G=String(M||"").trim();G&&(e[b]=[G])}),e},[fe,w]),St=J(()=>ca(Ct).slice().sort((n,b)=>n.key.localeCompare(b.key)),[Ct]),Ve=J(()=>St.map(e=>e.key),[St]);I(()=>{_&&Q(e=>{const n={};Ve.forEach(y=>{n[y]=Object.prototype.hasOwnProperty.call(e,y)?e[y]:""});const b=Object.keys(e);return b.length===Ve.length&&b.every(y=>Object.prototype.hasOwnProperty.call(n,y)&&n[y]===e[y])?e:n})},[_,Ve]);const Er=()=>{const e=Number(se);if(!Number.isFinite(e)||e<0)return;const n=String(Math.floor(e));Q(b=>{const y={...b};return Ve.forEach(N=>{y[N]=n}),y})},Rr=()=>{Q(e=>{const n={...e};return Ve.forEach(b=>{n[b]=""}),n}),R("")},Nr=e=>{const n=Object.entries(e||{}).filter(([b,y])=>y!=null&&String(y).trim()!=="").sort(([b],[y])=>b.localeCompare(y));return n.length?n.map(([b,y])=>`${b}: ${y}`).join(" \u2022 "):"Base product"},kr=()=>{const e=st[l]||{must:[],also:[],optional:[],name:null,specs:null},n=e.name&&e.name(w)||`${l} item`,b=c.trim()||n,y=Ct,N={};_&&Object.entries(D||{}).forEach(([$,ee])=>{const ve=String(ee!=null?ee:"").trim();if(!ve)return;const ce=Number(ve);!Number.isFinite(ce)||ce<0||(N[$&&$.trim()||re]=Math.floor(ce))});const M=(e.specs&&e.specs(w)||[]).filter(Boolean),G=[];(fe.info||[]).forEach($=>{if(!$)return;const ee=Qe($);if($.fieldType==="checkbox"){w[ee]&&G.push($.label);return}if(X($)){(Array.isArray(w[ee])?w[ee].map(Me=>String(Me).trim()).filter(Boolean):[]).forEach(Me=>G.push(Me));return}const ve=String(w[ee]||"").trim();ve&&G.push(ve)});const T=String((i==null?void 0:i.name)||"").trim(),Y=[...T?[`${yt}${T}`]:[],...Array.from(new Set([...M,...G])).slice(0,6)],ne=Array.from(new Set((j||[]).filter(Boolean))),Ce={id:`owner-${Date.now()}`,name:b,sku:B.trim()||`SKU-${(Math.random()*1e6|0).toString(36)}`,category:l,price:Number(A)||0,description:U.trim(),image:ne[0]||void 0,images:ne.length?ne:void 0,specs:Y,variants:y,inventory:_?N:void 0};return oe(Ce)},Cr=()=>{var M;const e=[],n=st[l]||{must:[]},b=Number(A);(!Number.isFinite(b)||b<=0)&&e.push("Price must be greater than 0");const y=(fe.customer||[]).find(G=>G&&(G.key==="Model"||G.schemaKey==="models"));if(y){const G=Qe(y),T=w[G];X(y)?(Array.isArray(T)?T:[]).length===0&&e.push("Please select at least one model"):String(T||"").trim()||e.push("Please select a model")}const N=(n.must||[]).find(G=>G.key==="model");return N&&(String((M=w[N.key])!=null?M:"").trim()||e.push("Model is required")),_&&Object.entries(D||{}).find(([T,te])=>{const Y=String(te!=null?te:"").trim();if(!Y)return!1;const ne=Number(Y);return!Number.isFinite(ne)||ne<0})&&e.push("Stock quantities must be 0 or greater (or leave blank for unlimited)."),e},Sr=async()=>{const e=Cr();if(e.length){x(e),C(null);return}const n=kr();if(n){S(!0);try{const b=await a(n),y=!!(b&&b.persisted);x([]),y?C({type:"success",message:"Product added to catalogue."}):(C({type:"warning",message:"Product saved locally. Supabase sync pending."}),r==null||r("warning","Supabase connection unavailable. Product stored locally until sync succeeds.")),u(`${l} \u2014 `),P(""),k(""),W(""),v([]),O({}),z(!1),R(""),Q({})}catch(b){console.error("Failed to add product:",b),C({type:"error",message:"Could not save product. Check your connection and try again."}),r==null||r("error","Could not add product. Check your connection and try again.")}finally{S(!1)}}};return React.createElement("section",{"aria-labelledby":"owner-title",className:"mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-8"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 sm:p-8 shadow-soft-xl"},React.createElement("div",{className:"space-y-2"},React.createElement("h2",{id:"owner-title",className:"text-2xl font-semibold text-slate-900"},"Owner \u2014 Add products"),React.createElement("p",{className:"text-sm text-slate-600"},"Only essentials. Fields shift by category. Keep data clean; the catalogue updates instantly.")),H&&React.createElement("div",{className:q("rounded-2xl border px-4 py-3 text-sm shadow-sm",H.type==="error"?"border-rose-200 bg-rose-50/80 text-rose-700":H.type==="warning"?"border-amber-200 bg-amber-50/80 text-amber-700":"border-emerald-200 bg-emerald-50/80 text-emerald-700")},H.message),L.length>0&&React.createElement("div",{className:"rounded-2xl border border-amber-200 bg-amber-50/80 px-4 py-3 text-sm text-amber-700 shadow-sm"},React.createElement("p",{className:"font-semibold"},"Please fix the following:"),React.createElement("ul",{className:"mt-1 list-disc space-y-0.5 pl-4"},L.map((e,n)=>React.createElement("li",{key:n},e)))),React.createElement("div",{className:"space-y-4"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Essentials"),React.createElement("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family"),React.createElement("button",{type:"button",onClick:pr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:f,onChange:e=>{x([]),C(null),g(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},(d||[]).map(e=>React.createElement("option",{key:e.id,value:e.id},e.name)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("div",{className:"mb-1 flex items-center justify-between gap-2"},React.createElement("span",{className:"block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Category"),React.createElement("button",{type:"button",onClick:br,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage")),React.createElement("select",{value:l,onChange:e=>{x([]),C(null),h(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},s.map(e=>React.createElement("option",{key:e,value:e},e)))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:A,onChange:e=>{x([]),C(null),k(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Name"),React.createElement("input",{value:c,onChange:e=>{x([]),C(null),u(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"SKU"),React.createElement("input",{value:B,onChange:e=>{x([]),C(null),P(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"md:col-span-2 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Short description"),React.createElement("textarea",{rows:3,value:U,onChange:e=>{x([]),C(null),W(e.target.value)},className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:he}),j.length>0&&React.createElement("div",{className:"mt-2 flex flex-wrap gap-2"},j.map((e,n)=>React.createElement("div",{key:n,className:"relative"},React.createElement("img",{src:e,alt:`preview ${n+1}`,className:"h-20 w-20 overflow-hidden rounded-xl border border-[var(--surface-border)] object-cover"}),React.createElement("button",{type:"button",onClick:()=>{x([]),C(null),v(b=>b.filter((y,N)=>N!==n))},className:"absolute -right-1 -top-1 rounded-full border border-[var(--surface-border)] bg-white px-1 text-xs shadow","aria-label":`Remove photo ${n+1}`},"\xD7"))))))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Product information"),React.createElement("button",{type:"button",onClick:()=>aa("info"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(fe.info||[]).map(e=>{const n=Qe(e);return React.createElement(Ia,{key:e.id,label:e.label,mode:e.mode,fieldType:e.fieldType,options:na(e),value:w[n],onChange:b=>K(n,b),onEdit:()=>ra("info",e),onRemove:()=>sa("info",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Customer options"),React.createElement("button",{type:"button",onClick:()=>aa("customer"),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Add option group")),React.createElement("div",{className:"grid gap-3 md:grid-cols-2"},(fe.customer||[]).map(e=>{const n=Qe(e);return React.createElement(ja,{key:e.id,label:e.label,mode:e.mode,options:na(e),value:w[n],onChange:b=>K(n,b),onEdit:()=>ra("customer",e),onRemove:()=>sa("customer",e)})}))),React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-center justify-between gap-3"},React.createElement("h3",{className:"text-xs font-semibold uppercase tracking-[0.24em] text-slate-500"},"Stock limits (optional)"),React.createElement("label",{className:"inline-flex items-center gap-2 rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-xs font-semibold text-slate-700 shadow-sm backdrop-blur"},React.createElement("input",{type:"checkbox",checked:_,onChange:e=>z(e.target.checked),className:"h-4 w-4 rounded border-[var(--surface-border)] text-brand focus:ring-brand"}),"Limit stock")),React.createElement("p",{className:"text-sm text-slate-600"},"Optional. Leave blank to keep a variant unlimited."),_&&React.createElement("div",{className:"space-y-3 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between"},React.createElement("label",{className:"block flex-1 text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Default quantity"),React.createElement("input",{type:"number",min:0,step:"1",value:se,onChange:e=>R(e.target.value),placeholder:"e.g. 10",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{type:"button",onClick:Er,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Apply to all"),React.createElement("button",{type:"button",onClick:Rr,className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Clear all"))),React.createElement("div",{className:"max-h-72 space-y-2 overflow-y-auto pr-1"},St.map(({key:e,selection:n})=>{var b;return React.createElement("label",{key:e,className:"flex items-center justify-between gap-3 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner"},React.createElement("span",{className:"flex-1 text-xs font-semibold text-slate-700"},Nr(n)),React.createElement("input",{type:"number",min:0,step:"1",inputMode:"numeric",value:(b=D[e])!=null?b:"",onChange:y=>Q(N=>({...N,[e]:y.target.value})),placeholder:"Unlimited",className:"w-32 rounded-2xl border border-[var(--surface-border)] bg-white/80 px-3 py-2 text-right text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"}))})))),React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-end"},React.createElement("button",{type:"button",onClick:Sr,disabled:p,className:q("inline-flex items-center justify-center rounded-full px-6 py-2 text-sm font-semibold text-white shadow-sm focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",p?"bg-brand/50 cursor-not-allowed opacity-70":"bg-brand hover:bg-brand-muted")},p?"Saving...":"Add Product"),React.createElement("button",{type:"button",onClick:()=>{var e;return(e=window.__setOwnerManage)==null?void 0:e.call(window,!0)},className:"inline-flex items-center justify-center rounded-full border border-[var(--surface-border)] bg-white/70 px-6 py-2 text-sm font-semibold text-slate-800 shadow-sm transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Manage catalogue")),React.createElement(vt,{open:(Ee==null?void 0:Ee.type)==="group",title:de.id?"Edit option group":"Add option group",onClose:()=>ie(null),actions:React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:()=>ie(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Cancel"),React.createElement("button",{type:"button",onClick:wr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Save"))},Xt&&React.createElement("div",{className:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},Xt),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Group name"),React.createElement("input",{value:de.label,onChange:e=>_e(n=>({...n,label:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Selection"),React.createElement("select",{value:de.mode,onChange:e=>_e(n=>({...n,mode:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"single"},"Single"),React.createElement("option",{value:"multi"},"Multi"))),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options source"),React.createElement("select",{value:de.optionsSource,onChange:e=>_e(n=>({...n,optionsSource:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},React.createElement("option",{value:"static"},"Custom list"),de.scope==="customer"&&React.createElement("option",{value:"familyModels"},"Use family models")))),de.optionsSource!=="familyModels"&&React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Options (comma or new line)"),React.createElement("textarea",{rows:6,value:de.optionsText,onChange:e=>_e(n=>({...n,optionsText:e.target.value})),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",placeholder:"Option 1, Option 2, Option 3\\nOption 4"}))),React.createElement(vt,{open:(Ee==null?void 0:Ee.type)==="category",title:"Manage categories",onClose:()=>ie(null),actions:React.createElement("button",{type:"button",onClick:()=>ie(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"flex flex-wrap items-end gap-2"},React.createElement("label",{className:"flex-1 block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"New category"),React.createElement("input",{value:ta,onChange:e=>kt(e.target.value),placeholder:"e.g. Camera parts",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("button",{type:"button",onClick:fr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},"Add")),React.createElement("div",{className:"space-y-2"},(s||[]).map(e=>React.createElement("div",{key:e,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{h(e),ie(null)},className:q("flex-1 text-left font-medium",e===l?"text-slate-900":"text-slate-700")},e),React.createElement("button",{type:"button",onClick:()=>yr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove category ${e}`},"\xD7")))))),React.createElement(vt,{open:(Ee==null?void 0:Ee.type)==="family",title:"Manage families",onClose:()=>ie(null),actions:React.createElement("button",{type:"button",onClick:()=>ie(null),className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm font-semibold text-slate-700"},"Close")},React.createElement("div",{className:"space-y-3"},React.createElement("div",{className:"space-y-2"},React.createElement("p",{className:"text-sm text-slate-600"},"Families control which model list appears in the phone model picker."),React.createElement("div",{className:"space-y-2"},(d||[]).map(e=>React.createElement("div",{key:e.id,className:"flex items-center justify-between gap-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-2 text-sm text-slate-700"},React.createElement("button",{type:"button",onClick:()=>{g(e.id),ie(null)},className:q("flex-1 text-left font-medium",e.id===f?"text-slate-900":"text-slate-700")},e.name),React.createElement("button",{type:"button",onClick:()=>gr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"Edit"),React.createElement("button",{type:"button",onClick:()=>hr(e),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white","aria-label":`Remove family ${e.name}`},"\xD7"))))),React.createElement("div",{className:"rounded-2xl border border-[var(--surface-border)] bg-white/70 p-3 shadow-sm"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("h4",{className:"text-sm font-semibold text-slate-900"},Re.id?"Edit family":"Add family"),Re.id&&React.createElement("button",{type:"button",onClick:()=>De({id:null,name:"",modelsText:""}),className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-2.5 py-1 text-xs font-semibold text-slate-600 hover:bg-white"},"New")),React.createElement("div",{className:"mt-3 space-y-3"},React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Family name"),React.createElement("input",{value:Re.name,onChange:e=>De(n=>({...n,name:e.target.value})),placeholder:"e.g. Samsung S",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm text-slate-600"},React.createElement("span",{className:"mb-1 block text-xs font-semibold uppercase tracking-[0.18em] text-slate-500"},"Models (one per line)"),React.createElement("textarea",{rows:6,value:Re.modelsText,onChange:e=>De(n=>({...n,modelsText:e.target.value})),placeholder:"iPhone 11\\niPhone 12\\n...",className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"flex justify-end"},React.createElement("button",{type:"button",onClick:xr,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white"},Re.id?"Save changes":"Add family"))))))))}function Jt({label:a,options:r,value:t,onChange:o}){const s=()=>o(r),d=()=>o([]),l=h=>o(t.includes(h)?t.filter(f=>f!==h):[...t,h]);return React.createElement("div",{className:"space-y-2 rounded-2xl border border-[var(--surface-border)] bg-white/70 p-4 text-sm text-slate-600 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex items-center justify-between"},React.createElement("span",{className:"text-sm font-semibold text-slate-800"},a),React.createElement("div",{className:"flex items-center gap-2 text-xs"},React.createElement("button",{type:"button",onClick:s,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"All"),React.createElement("button",{type:"button",onClick:d,className:"rounded-full border border-[var(--surface-border)] px-2 py-0.5 font-medium text-slate-600 hover:bg-white/60"},"Clear"))),React.createElement("div",{className:"flex flex-wrap gap-1.5 text-xs"},r.map(h=>{const f=t.includes(h),g=/color/i.test(a)||et[h]!==void 0;return React.createElement("button",{type:"button",key:h,onClick:()=>l(h),className:q("rounded-full border px-2 py-1 text-xs",f?"border-transparent bg-brand text-white":"border-[var(--surface-border)] bg-white text-slate-700")},g?React.createElement(React.Fragment,null,React.createElement(Ae,{name:h})," ",h):h)})))}function ir({open:a,onClose:r,product:t,onSave:o,onHide:s,onDelete:d}){var w,O,_,z,se;const l=ae(null);at(!!a,l,r);const[h,f]=E((t==null?void 0:t.name)||""),[g,i]=E((t==null?void 0:t.sku)||""),[m,c]=E(String((w=t==null?void 0:t.price)!=null?w:0)),[u,B]=E((t==null?void 0:t.description)||""),[P,A]=E(()=>[...Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[]]),[k,U]=E(0),[W,j]=E(()=>{const R={...(t==null?void 0:t.variants)||{}};return R.Color&&!Array.isArray(R.Color)&&(R.Color=[R.Color]),R.Model&&!Array.isArray(R.Model)&&(R.Model=[R.Model]),R});I(()=>{var D;if(!a)return;f((t==null?void 0:t.name)||""),i((t==null?void 0:t.sku)||""),c(String((D=t==null?void 0:t.price)!=null?D:0)),B((t==null?void 0:t.description)||"");const R=Array.isArray(t==null?void 0:t.images)&&t.images.length?t.images:t!=null&&t.image?[t.image]:[];A([...R]),U(0),j({...(t==null?void 0:t.variants)||{}})},[a,t]);const v=R=>{const D=Array.from(R.target.files||[]);if(!D.length)return;const Q=D.map(V=>new Promise(X=>{const le=new FileReader;le.onload=()=>X(String(le.result||"")),le.readAsDataURL(V)}));Promise.all(Q).then(V=>A(X=>[...X,...V]))},L=()=>U(R=>(R-1+P.length)%P.length),x=()=>U(R=>(R+1)%P.length),H=()=>{const R=Object.fromEntries(Object.entries(W||{}).map(([le,Oe])=>{const xe=Array.isArray(Oe)?Oe.map(Fe=>String(Fe).trim()).filter(Boolean):[];return[le,Array.from(new Set(xe))]}).filter(([,le])=>Array.isArray(le)&&le.length)),D=h.trim()||t.name,Q=g.trim()||t.sku,V=Number(m),X=oe({...t||{},name:D,sku:Q,price:Number.isFinite(V)&&V>0?V:Number(t.price)||0,description:u,images:P.length?P:void 0,image:P[0]||void 0,variants:R});o(X,t==null?void 0:t.id),r()},C=!!((_=(O=t==null?void 0:t.id)==null?void 0:O.startsWith)!=null&&_.call(O,"owner-")),p=Array.from(new Set([...W.Model||[]])),S=Array.from(new Set([...W.Color||[]]));return!a||!t?null:React.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-0 sm:p-6",role:"dialog","aria-modal":"true"},React.createElement("div",{ref:l,className:"w-full sm:max-w-3xl rounded-3xl border border-[var(--surface-border)] bg-[rgba(255,255,255,0.96)] backdrop-blur-xl shadow-soft-xl outline-none max-h-[90vh] overflow-y-auto"},React.createElement("div",{className:"flex items-center justify-between border-b border-[var(--surface-border)] bg-white/70 px-5 py-4"},React.createElement("h3",{className:"text-lg font-semibold text-slate-900"},"Edit product"),React.createElement("div",{className:"flex items-center gap-2"},!C&&React.createElement("button",{onClick:()=>{s(t.id),r()},className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3.5 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Hide base"),C&&React.createElement("button",{onClick:()=>{d(t.id),r()},className:"rounded-full border border-rose-300 bg-rose-50/80 px-3.5 py-1.5 text-sm font-semibold text-rose-700 transition hover:bg-rose-100 focus:outline-none focus-visible:outline-2 focus-visible:outline-rose-400"},"Delete"),React.createElement("button",{onClick:r,className:"rounded-full px-3.5 py-1.5 text-sm font-semibold text-slate-500 transition hover:bg-white/70 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Close"))),React.createElement("div",{className:"grid gap-4 p-4 sm:grid-cols-2"},React.createElement("div",{className:"flex flex-col gap-2"},React.createElement("div",{className:"relative aspect-square w-full overflow-hidden rounded-xl bg-slate-100"},React.createElement("img",{src:qe(P[k]||"",t.name),onError:R=>{R.currentTarget.src=Pe(t.name)},alt:`${t.name} \u2013 photo ${k+1} of ${P.length}`,className:"h-full w-full object-cover"}),P.length>1&&React.createElement(React.Fragment,null,React.createElement("button",{type:"button",onClick:L,className:"absolute left-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Previous photo"},"\u2039"),React.createElement("button",{type:"button",onClick:x,className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full bg-white/90 p-2 shadow focus:outline-none focus-visible:outline-2 focus-visible:outline-brand","aria-label":"Next photo"},"\u203A"))),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"text-xs text-slate-700 inline-flex items-center gap-2"},React.createElement("span",{className:"rounded-full border border-[var(--surface-border)] bg-white px-2 py-1"},"Add photos"),React.createElement("input",{type:"file",accept:"image/*",multiple:!0,onChange:v,className:"sr-only"}))),P.length>0&&React.createElement("div",{className:"flex gap-2 overflow-x-auto"},P.map((R,D)=>React.createElement("div",{key:D,className:q("relative h-14 w-20 flex-shrink-0 overflow-hidden rounded-md border",D===k?"border-brand":"border-[var(--surface-border)]")},React.createElement("button",{type:"button",onClick:()=>U(D),className:"absolute inset-0"},React.createElement("img",{src:qe(R,t.name),alt:"",className:"h-full w-full object-cover"})),React.createElement("button",{type:"button",onClick:()=>A(Q=>Q.filter((V,X)=>X!==D)),className:"absolute -right-1 -top-1 rounded-full bg-white border p-0.5 shadow","aria-label":`Remove photo ${D+1}`},"\xD7"))))),React.createElement("div",{className:"flex min-w-0 flex-col gap-3"},React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Name"),React.createElement("input",{value:h,onChange:R=>f(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"SKU"),React.createElement("input",{value:g,onChange:R=>i(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Price"),React.createElement("input",{type:"number",min:0,step:"0.01",value:m,onChange:R=>c(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("label",{className:"block text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},"Description"),React.createElement("textarea",{rows:3,value:u,onChange:R=>B(R.target.value),className:"w-full rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3.5 py-2.5 text-sm text-slate-800 shadow-inner backdrop-blur focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"})),React.createElement("div",{className:"grid gap-3"},!!((z=t==null?void 0:t.variants)!=null&&z.Model)&&React.createElement(Jt,{label:"Models",options:[...Le,...bt,...ft],value:p,onChange:R=>j(D=>({...D,Model:R}))}),!!((se=t==null?void 0:t.variants)!=null&&se.Color)&&React.createElement(Jt,{label:"Colors",options:ze,value:S,onChange:R=>j(D=>({...D,Color:R}))}),Object.entries((t==null?void 0:t.variants)||{}).filter(([R])=>R!=="Model"&&R!=="Color").map(([R,D])=>React.createElement("div",{key:R,className:"text-sm"},React.createElement("span",{className:"mb-1 block text-slate-700"},R),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(W[R]||D).map(Q=>React.createElement("span",{key:Q,className:"inline-flex items-center gap-1 rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-1 text-xs font-medium text-slate-600"},Q,React.createElement("button",{type:"button",onClick:()=>j(V=>({...V,[R]:(V[R]||D).filter(X=>X!==Q)})),"aria-label":`Remove ${Q}`},"\xD7")))),React.createElement("div",{className:"mt-1 flex gap-2"},React.createElement("input",{type:"text",placeholder:`Add ${R} option`,className:"w-44 rounded-2xl border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-medium text-slate-700 shadow-inner focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onKeyDown:Q=>{if(Q.key==="Enter"){const V=Q.currentTarget.value.trim();V&&j(X=>({...X,[R]:Array.from(new Set([...X[R]||D,V]))})),Q.currentTarget.value=""}}}),React.createElement("button",{type:"button",className:"rounded-full border border-[var(--surface-border)] bg-white/70 px-3 py-1.5 text-sm font-semibold text-slate-700 transition hover:bg-white focus:outline-none focus-visible:outline-2 focus-visible:outline-brand",onClick:Q=>{const V=Q.currentTarget.previousSibling;if(V&&V.value){const X=V.value.trim();j(le=>({...le,[R]:Array.from(new Set([...le[R]||D,X]))})),V.value=""}}},"Add"))))),React.createElement("div",{className:"mt-2 flex justify-end gap-3"},React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-4 py-2 text-sm text-slate-900 hover:bg-white/70"},"Cancel"),React.createElement("button",{onClick:H,className:"rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white transition hover:bg-brand-muted"},"Save changes"))))))}function cr({products:a,onClose:r,onEdit:t,onHide:o,onDelete:s,onSave:d}){const[l,h]=E(""),[f,g]=E(null),i=J(()=>{let m=a;if(l){const c=l.toLowerCase();m=m.filter(u=>u.name.toLowerCase().includes(c)||u.sku.toLowerCase().includes(c)||(u.description||"").toLowerCase().includes(c))}return m},[a,l]);return React.createElement("section",{"aria-labelledby":"mgr-title",className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-6"},React.createElement("div",{className:"space-y-6 rounded-3xl border border-[var(--surface-border)] bg-white/95 p-6 shadow-soft-xl sm:p-8"},React.createElement("div",{className:"sticky top-[calc(var(--header-offset,64px)+12px)] z-10 rounded-2xl border border-[var(--surface-border)] bg-white/90 px-4 py-3 shadow-sm backdrop-blur"},React.createElement("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},React.createElement("h2",{id:"mgr-title",className:"text-base sm:text-lg font-semibold text-slate-900"},"Owner \u2014 Manage catalogue"),React.createElement("div",{className:"flex items-center gap-2"},React.createElement("label",{className:"relative flex-1 sm:w-auto"},React.createElement("span",{className:"sr-only"},"Search"),React.createElement("input",{value:l,onChange:m=>h(m.target.value),placeholder:"Search\u2026",type:"search",className:"w-full rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-medium text-slate-600 shadow-inner placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-brand focus:border-transparent"}),React.createElement(wt,{className:"pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-slate-400"})),React.createElement("button",{onClick:r,className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 shadow-sm transition hover:bg-white/90 focus:outline-none focus-visible:outline-2 focus-visible:outline-brand"},"Back")))),React.createElement("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3"},(i||[]).map(m=>React.createElement("article",{key:m.id,className:"group flex flex-col overflow-hidden rounded-3xl border border-[var(--surface-border)] bg-white transition hover:-translate-y-0.5 hover:shadow-soft-xl"},React.createElement("div",{className:"aspect-square w-full bg-slate-100"},React.createElement("img",{src:qe(Array.isArray(m.images)&&m.images[0]||m.image||"",m.name),onError:c=>{c.currentTarget.src=Pe(m.name)},alt:m.name,className:"h-full w-full object-cover"})),React.createElement("div",{className:"flex flex-1 flex-col gap-3 p-4"},React.createElement("header",null,React.createElement("h3",{className:"text-base font-semibold text-slate-900"},m.name),React.createElement("p",{className:"mt-0.5 text-xs text-slate-500"},"SKU: ",m.sku)),React.createElement("div",{className:"flex flex-wrap gap-1.5"},(m.specs||[]).slice(0,4).map(c=>React.createElement("span",{key:c,className:"inline-flex items-center rounded-full border border-[var(--surface-border)] bg-white/80 px-2.5 py-0.5 text-xs font-medium text-slate-600"},c))),React.createElement("div",{className:"mt-auto flex items-center justify-between"},React.createElement("span",{className:"font-semibold text-slate-900"},ge(m.price)),m.minOrder&&React.createElement("span",{className:"text-xs text-slate-500"},"MOQ ",m.minOrder)),React.createElement("div",{className:"flex gap-2"},React.createElement("button",{onClick:()=>g(m),className:"flex-1 rounded-full bg-brand px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:bg-brand-muted"},"Edit"),m.id.startsWith("owner-")?React.createElement("button",{onClick:()=>s(m.id),className:"rounded-full border border-red-300 bg-white px-3 py-2 text-sm text-red-700 hover:bg-red-50"},"Delete"):React.createElement("button",{onClick:()=>o(m.id),className:"rounded-full border border-[var(--surface-border)] bg-white px-3.5 py-2 text-sm font-semibold text-slate-700 transition hover:bg-white/90"},"Hide"))))))),React.createElement(ir,{open:!!f,onClose:()=>g(null),product:f,onSave:d,onHide:o,onDelete:s}))}function dr(){const a=React.useRef(0),[r,t]=E(""),[o,s]=E("All"),[d,l]=E(null),[h,f]=E(!1),[g,i]=E("dashboard"),[m,c]=E(it&&Ie),u=Se?!0:Ie?m:!1,B=La(),P=ke?c:()=>{};I(()=>{u||i("dashboard")},[u]);const[A,k]=E(null),U=ae(null),W=(F,K)=>{K&&(k({type:F,message:K}),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>k(null),4e3))};I(()=>()=>{U.current&&clearTimeout(U.current)},[]);const{ownerProducts:j,setOwnerProducts:v,addProduct:L,deleteProduct:x,loading:H,connectionStatus:C}=Fa(),{catalogConfig:p,saveCatalogConfig:S}=Ta(j,v),{orders:w,loadingOrders:O,ordersError:_,ordersMeta:z,refreshOrders:se,updateOrderStatus:R}=Wa();Ma(!!(d||h),a);const Q=J(()=>{const F=new Map(Oa.map(Z=>[Z.id,Z])),K=[];return j.forEach(Z=>{if(!(Z&&Z.id===Ze)){if(Z.sourceId&&F.has(Z.sourceId)){if(Z.hidden){F.delete(Z.sourceId);return}F.delete(Z.sourceId)}Z.hidden||(Z.sourceId?F.set(Z.id,Z):K.push(Z))}}),[...K,...Array.from(F.values())]},[j]),V=J(()=>{let F=Q;return o!=="All"&&(F=F.filter(K=>K.category===o)),r&&(F=F.filter(K=>K.name.toLowerCase().includes(r.toLowerCase())||K.sku.toLowerCase().includes(r.toLowerCase())||(K.description||"").toLowerCase().includes(r.toLowerCase()))),F},[Q,o,r]);I(()=>(window.__setOwnerManage=F=>{i(F?"manage":"dashboard")},()=>{window.__setOwnerManage=void 0}),[]);const X=F=>v(K=>{const Z=K.findIndex(he=>he.id===F.id);if(Z>=0){const he=[...K];return he[Z]=F,he}return[...K,F]}),le=async(F,K)=>{var Be,Ye;const Z=(Ye=(Be=F.id)==null?void 0:Be.startsWith)==null?void 0:Ye.call(Be,"owner-"),he=oe(Z?F:{...F,id:`owner-${Date.now()}`,sourceId:K}),ue=await ut(he);X(ue||he),ue?W("success","Product updated."):W("warning","Product updated locally. Supabase sync pending.")},Oe=async F=>{const K=oe({id:`owner-hide-${Date.now()}`,sourceId:F,hidden:!0,name:"",sku:"",category:"All",price:0,description:"",specs:[]}),Z=await ut(K);X(Z||K),Z?W("success","Base product hidden."):W("warning","Base product hidden locally. Supabase sync pending.")},xe=async F=>{const K=await x(F);return K?W("success","Product deleted."):W("error","Could not delete product. Check your connection and try again."),K},Fe=J(()=>React.createElement(Ya,{allProducts:Q,ownerProducts:j,orders:w,loadingOrders:O,ordersMeta:z,ordersError:_,onNavigate:i,refreshOrders:se}),[Q,j,w,O,z,_,se]),Rt=J(()=>[{id:"dashboard",label:"Dashboard",description:"Key metrics & recents",icon:Ka,element:Fe},{id:"add",label:"Add product",description:"Create new catalogue items",icon:Ha,element:React.createElement(lr,{addProduct:L,onNotify:W,onNavigate:i,catalogConfig:p,saveCatalogConfig:S})},{id:"manage",label:"Manage catalogue",description:"Edit overrides & hide base items",icon:za,element:React.createElement(cr,{products:Q,onClose:()=>i("add"),onEdit:F=>l({__edit:!0,product:F}),onHide:F=>Oe(F),onDelete:F=>xe(F),onSave:le})},{id:"orders",label:"Orders",description:"Track open, confirmed & shipped",icon:qa,element:React.createElement(Qa,{orders:w,loading:O,error:_,meta:z,onRefresh:se,onStatusChange:R,onNotify:W})}],[Fe,Q,j,w,O,_,z,se,R,xe,Oe,le,i,W,L,p,S]),Nt=B.items.reduce((F,K)=>F+(Number(K.qty)||0),0);return H?React.createElement("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center"},React.createElement("div",{className:"text-center"},React.createElement("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),React.createElement("p",{className:"text-slate-600"},"Loading products..."))):React.createElement("div",{className:"min-h-screen bg-slate-50"},React.createElement(Ja),A&&React.createElement("div",{className:q("fixed bottom-4 right-4 z-40 max-w-sm rounded-lg border px-4 py-3 text-sm shadow-lg backdrop-blur",A.type==="error"?"border-red-200 bg-red-50/90 text-red-700":A.type==="warning"?"border-amber-200 bg-amber-50/90 text-amber-800":"border-emerald-200 bg-emerald-50/90 text-emerald-700")},React.createElement("div",{className:"flex items-start gap-3"},React.createElement("span",{className:"flex-1 leading-snug"},A.message),React.createElement("button",{type:"button",onClick:()=>k(null),className:"text-xs font-medium uppercase tracking-wide text-slate-500 hover:text-slate-700"},"Dismiss"))),React.createElement(Za,{onOpenCart:()=>{a.current=window.scrollY||0,f(!0)},search:r,setSearch:t,ownerMode:u,setOwnerMode:P,cartQty:Nt,connectionStatus:C,allowOwnerToggle:ke}),u?React.createElement(Va,{views:Rt,section:g,onSectionChange:i}):React.createElement(React.Fragment,null,React.createElement(Xa),React.createElement(er,{active:o,setActive:s}),React.createElement(tr,{products:V,onOpen:F=>{a.current=window.scrollY||0,l(F&&F.__edit&&F.product?F.product:F)}})),React.createElement(rr,{product:d,onClose:()=>{l(null)},onAdd:B.add}),React.createElement(nr,{open:h,onClose:()=>f(!1),cart:B}))}ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(dr))},ia=E=>{const I=document.createElement("div");I.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",I.innerHTML=`
          <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
            <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
            <p style="margin:0 0 16px;font-size:14px;color:#4B5563;">Sign in to manage the catalogue.</p>
            <form style="display:flex;flex-direction:column;gap:12px;">
              <input name="email" type="email" autocomplete="email" placeholder="Email" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <input name="password" type="password" autocomplete="current-password" placeholder="Password" style="width:100%;border:1px solid #D1D5DB;border-radius:8px;padding:10px 12px;font-size:14px;" required />
              <div data-status style="min-height:18px;font-size:13px;color:#DC2626;"></div>
              <button type="submit" style="border:none;border-radius:8px;background:#4F46E5;color:white;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign in</button>
              <button type="button" data-signout style="display:none;border:1px solid #D1D5DB;border-radius:8px;background:white;color:#111827;padding:10px 12px;font-size:14px;font-weight:600;cursor:pointer;">Sign out</button>
            </form>
            <p style="margin:16px 0 0;font-size:12px;color:#6B7280;line-height:1.4;">
              This page requires Supabase Auth + owner-only RLS. If you haven't yet, run <code>supabase-owner-rls.sql</code> in Supabase, then add your Auth user UUID to <code>public.owner_users</code>.
            </p>
          </div>
        `,document.body.appendChild(I);const ae=I.querySelector("form"),J=I.querySelector("input[name=email]"),$e=I.querySelector("input[name=password]"),ot=I.querySelector("[data-status]"),Ge=I.querySelector("[data-signout]");J.focus();const pe=me=>{ot.textContent=me||""},lt=me=>{const we=ae.querySelector("button[type=submit]");we.disabled=me,we.style.opacity=me?"0.7":"1",we.textContent=me?"Signing in...":"Sign in"};Ge.addEventListener("click",async()=>{try{await E.auth.signOut()}catch(me){}Ge.style.display="none",pe("Signed out.")}),ae.addEventListener("submit",async me=>{var we,Ne,Se,Ie;me.preventDefault(),pe(""),lt(!0);try{const ke=String(J.value||"").trim(),it=String($e.value||""),{data:Ke,error:Je}=await E.auth.signInWithPassword({email:ke,password:it});if(Je)throw Je;const re=await Pt(E);if(re===!0){I.remove(),Ot();return}const ct=((we=Ke==null?void 0:Ke.user)==null?void 0:we.id)||((Ie=(Se=(Ne=await E.auth.getUser())==null?void 0:Ne.data)==null?void 0:Se.user)==null?void 0:Ie.id);Ge.style.display="block",pe(re===!1?`Signed in, but not an owner. User ID: ${ct||"(unknown)"}`:"Signed in, but owner check failed. Ensure public.is_owner() exists and you are listed in public.owner_users.")}catch(ke){pe((ke==null?void 0:ke.message)||"Sign-in failed.")}finally{lt(!1),$e.value=""}})};(async()=>{const E=la();if(!E){const I=document.createElement("div");I.style.cssText="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(15,23,42,0.9);z-index:9999;padding:24px;",I.innerHTML=`
            <div style="width:100%;max-width:420px;padding:32px;border-radius:16px;background:white;box-shadow:0 20px 45px rgba(15,23,42,0.35);font-family:system-ui,-apple-system,Segoe UI,sans-serif;">
              <h1 style="margin:0 0 12px;font-size:22px;font-weight:600;color:#111827;">Owner Access</h1>
              <p style="margin:0;font-size:14px;color:#4B5563;">Supabase is not configured. Ensure <code>supabase-config.js</code> is present and loads before this page script.</p>
            </div>
          `,document.body.appendChild(I);return}try{const{data:I}=await E.auth.getSession();if(I==null?void 0:I.session){const J=await Pt(E);if(J===!0){Ot();return}if(J===!1)try{await E.auth.signOut()}catch($e){}}}catch(I){}ia(E)})()})();})();
